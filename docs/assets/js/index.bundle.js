(()=>{"use strict";const e=document.getElementById("loginForm"),t=document.getElementById("emailInput"),o=document.getElementById("passwordInput"),n=document.getElementById("globalLoadingPopup"),a=document.getElementById("loginFailModal"),l=document.getElementById("closeFailModal"),i=document.getElementById("serverStatus"),s=document.getElementById("deviceStatus"),d=document.getElementById("deviceModeSelect"),c="localhost"===location.hostname||"127.0.0.1"===location.hostname||location.hostname.includes("app.github.dev")?"http://127.0.0.1:5050":"https://port-0-innomax-mghorm7bef413a34.sel3.cloudtype.app";function m(){n.classList.add("hidden")}function r(e){const t=document.getElementById("loginFailMessage");t&&(t.textContent=e),a.classList.remove("hidden")}function g(e){"mobile"===e?(s.textContent="모바일 모드",s.className="mobile",d.value="mobile"):(s.textContent="PC 모드",s.className="pc",d.value="pc"),localStorage.setItem("deviceMode",e)}l.addEventListener("click",()=>{a.classList.add("hidden")}),d.addEventListener("change",e=>{g(e.target.value)}),document.addEventListener("DOMContentLoaded",()=>{g(localStorage.getItem("deviceMode")||"pc"),async function(){try{if(!(await fetch(`${c}/api/health`,{method:"GET"})).ok)throw new Error("서버 응답 오류");i.textContent="서버 연결 정상",i.className="online"}catch{i.textContent="서버 연결 실패",i.className="offline"}}()}),e?.addEventListener("submit",async e=>{e.preventDefault();const a=t.value.trim(),l=o.value.trim(),i=localStorage.getItem("deviceMode")||"pc";if(a&&l)try{n.classList.remove("hidden");const e=800,[t]=await Promise.all([fetch(`${c}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:a,password:l})}),new Promise(t=>setTimeout(t,e))]);if(m(),!t.ok)return void r("아이디 또는 비밀번호가 일치하지 않습니다.");const o=await t.json();localStorage.setItem("user",JSON.stringify({id:o.id,name:o.name,loginTime:Date.now()})),localStorage.setItem("loginUserId",o.id),localStorage.setItem("loginUserName",o.name);const s="mobile"===i?"mobileindex.html":"workspace.html";console.log("[LOGIN SUCCESS]",s),window.location.href=s}catch(e){console.error(e),m(),r("서버 연결 오류가 발생했습니다. 잠시 후 다시 시도해주세요.")}else r("아이디와 비밀번호를 입력하세요.")}),window.addEventListener("load",()=>{localStorage.removeItem("user"),sessionStorage.clear()})})();
//# sourceMappingURL=index.bundle.js.map