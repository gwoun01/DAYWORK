{"version":3,"file":"workspace.bundle.js","mappings":";;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,gBAAgB,GAAG,uBAAuB,GAAG,kBAAkB;AAC7E;AACA;AACA,cAAc,gBAAgB,GAAG,uBAAuB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,EAAE;AAChB;AACA,cAAc,cAAc,GAAG,cAAc,GAAG,cAAc;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,4BAA4B;AAC5B,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,EAAE,IAAI,EAAE,IAAI,EAAE;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,gBAAgB,GAAG,uBAAuB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,mCAAmC,SAAS,qCAAqC,KAAK,SAAS,MAAM;AACrG;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,SAAS;AAC5C;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,UAAU;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,SAAS,eAAe,wBAAwB;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,SAAS,gCAAgC,wBAAwB;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,SAAS,gCAAgC,wBAAwB;AACpG;AACA,qBAAqB;AACrB,qDAAqD;AACrD;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,mCAAmC,SAAS,0CAA0C,0BAA0B,KAAK,wBAAwB;AAC7I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,cAAc;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,qBAAqB;AACnD;AACA,8BAA8B,oCAAoC;AAClE;AACA;AACA,iEAAiE,EAAE;AACnE;AACA;AACA,qDAAqD,gBAAgB;AACrE,qDAAqD,MAAM;AAC3D,qDAAqD,UAAU;AAC/D,mDAAmD,KAAK;AACxD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,EAAE,IAAI,EAAE;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,EAAE,MAAM,EAAE;AAC9C;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA,oBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA;AACA,oBAAoB,cAAc;AAClC,uBAAuB,EAAE,GAAG,SAAS,GAAG,QAAQ;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,0CAA0C;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,cAAc;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,QAAQ,EAAE,wBAAwB,gBAAgB,OAAO;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,SAAS;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,YAAY;AAC7C;AACA;AACA;AACA;AACA,mCAAmC,iBAAiB;AACpD;AACA;AACA,0BAA0B,KAAK,oCAAoC,QAAQ;AAC3E;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,EAAE,IAAI,EAAE;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,8CAA8C;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,+BAA+B;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,kDAAkD;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,GAAG,IAAI,EAAE;AAC1D;AACA;AACA;AACA,mDAAmD,QAAQ;AAC3D,iEAAiE,wBAAwB;AACzF,mDAAmD,yBAAyB;AAC5E,mDAAmD,kBAAkB;AACrE,uCAAuC,KAAK;AAC5C;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,SAAS,mCAAmC,wBAAwB;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,QAAQ;AAC3D,iEAAiE,mBAAmB;AACpF,mDAAmD,SAAS;AAC5D,mDAAmD,OAAO;AAC1D,mDAAmD,OAAO;AAC1D,mDAAmD,YAAY;AAC/D;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,SAAS,4BAA4B,kBAAkB;AAC5E,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;;;;;;;;;;;;;;AC31BA;AACkD;AAClD;AACA;AACA;AACA,+CAA+C,GAAG;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,gBAAgB,GAAG,0CAA0C,GAAG,qCAAqC;AACnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,EAAE,GAAG,EAAE;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B;AACA,uBAAuB,aAAa,IAAI,aAAa,IAAI,MAAM;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,IAAI,MAAM,EAAE;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,EAAE;AACpB,cAAc,EAAE,KAAK,EAAE;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD,gDAAgD;AAChD,mDAAmD;AACnD,kDAAkD;AAClD;AACA;AACA;AACA,sBAAsB,aAAa,SAAS,WAAW;AACvD;AACA;AACA,sBAAsB,aAAa,SAAS,aAAa;AACzD;AACA;AACA;AACA,kBAAkB,WAAW,IAAI,SAAS,KAAK,yBAAyB;AACxE;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,wBAAwB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,cAAc,QAAQ,YAAY;AAChF;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,gCAAgC,IAAI,6BAA6B;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE,OAAO;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAS,qBAAqB,gCAAgC;AACzG;AACA,+BAA+B,oCAAoC;AACnE;AACA,2CAA2C,mBAAmB;AAC9D,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,OAAO;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAS,qBAAqB,gCAAgC;AACzG;AACA,+BAA+B,oCAAoC;AACnE;AACA,2CAA2C,mBAAmB;AAC9D,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,OAAO;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,oCAAoC,IAAI,iCAAiC;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE;AACtE,sEAAsE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,aAAa;AAChD,mCAAmC,aAAa;AAChD,oDAAoD,WAAW;AAC/D;AACA;AACA;AACA,8DAA8D;AAC9D,0BAA0B,+DAAU;AACpC;AACA;AACA,0BAA0B,+DAAU;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,kCAAkC;AACpD,mBAAmB,iCAAiC;AACpD,kBAAkB,qCAAqC;AACvD,kBAAkB,qBAAqB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,MAAM,SAAS,QAAQ,SAAS,SAAS,SAAS,SAAS;AACzF;AACA;AACA;AACA;AACA;AACA,mDAAmD,gBAAgB;AACnE;AACA;;;;;;;;;;;;;;;AC7eA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,UAAU;AAC3E;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAS,eAAe,wBAAwB;AAC3F;AACA,gDAAgD,WAAW;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,EAAE,GAAG,EAAE;AACvD;AACA;AACA;AACA,oCAAoC,QAAQ;AAC5C,oCAAoC,OAAO;AAC3C,oCAAoC,KAAK;AACzC;AACA,oCAAoC,cAAc;AAClD,oCAAoC,qBAAqB;AACzD,gDAAgD,SAAS;AACzD;AACA,8GAA8G,KAAK;AACnH;AACA;AACA,0GAA0G,KAAK;AAC/G;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,SAAS,aAAa,GAAG,KAAK,wBAAwB;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,SAAS,aAAa,GAAG;AACxE;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,SAAS;AACxD;AACA,mCAAmC,oCAAoC;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB,iEAAiE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,SAAS,aAAa,GAAG;AACxE;AACA,mCAAmC,oCAAoC;AACvE;AACA,qBAAqB;AACrB,iEAAiE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;;;;;;;;;;;;;;;ACxiBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,gBAAgB,GAAG,uBAAuB,GAAG,kBAAkB;AAC7E;AACA;AACA,cAAc,gBAAgB,GAAG,uBAAuB;AACxD;AACA;AACA;AACA,cAAc,EAAE;AAChB;AACA,cAAc,cAAc,GAAG,cAAc,GAAG,cAAc;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,4BAA4B;AAC5B,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,KAAK,IAAI,MAAM,MAAM,KAAK;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,gBAAgB,GAAG,uBAAuB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,EAAE,IAAI,EAAE,IAAI,EAAE;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,QAAQ;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,aAAa,GAAG,0BAA0B;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,aAAa,GAAG,0BAA0B;AACnE;AACA;AACA;AACA;AACA,+BAA+B,+BAA+B;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4BAA4B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA;AACA,sBAAsB,iBAAiB;AACvC,sBAAsB,EAAE,GAAG,QAAQ,GAAG,UAAU;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,0CAA0C;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,cAAc;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,OAAO;AAC7C;AACA;AACA;AACA;AACA,uCAAuC,gBAAgB;AACvD;AACA;AACA,8BAA8B,GAAG,mCAAmC,OAAO;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,OAAO;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA4E,KAAK;AACjF,4EAA4E,UAAU;AACtF,0FAA0F,OAAO;AACjG;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,EAAE,IAAI,EAAE;AACtB;AACA,+BAA+B,kBAAkB,GAAG,yBAAyB;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,cAAc;AACvC;AACA;AACA;AACA;AACA,qDAAqD,gBAAgB;AACrE,qDAAqD,MAAM;AAC3D,qDAAqD,UAAU;AAC/D,mEAAmE,SAAS;AAC5E;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD;AACpD,gCAAgC,EAAE,MAAM,EAAE;AAC1C;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,qCAAqC;AACrC,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD;AACxD,2DAA2D;AAC3D,2DAA2D;AAC3D,oCAAoC,EAAE,MAAM,EAAE;AAC9C;AACA;AACA,uBAAuB,EAAE,GAAG,MAAM,GAAG,MAAM;AAC3C;AACA;AACA,iCAAiC,kBAAkB;AACnD;AACA;AACA;AACA,oBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA;AACA,oBAAoB,cAAc;AAClC;AACA;AACA,uBAAuB,EAAE,GAAG,GAAG,GAAG,GAAG;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,0CAA0C;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,WAAW;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS,mCAAmC,wBAAwB;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS,0CAA0C,MAAM;AAChG;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA,2BAA2B,oCAAoC;AAC/D;AACA,uCAAuC,aAAa;AACpD,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS,uCAAuC,GAAG;AAC1F;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,uCAAuC,SAAS,qCAAqC,KAAK,SAAS,MAAM;AACzG;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA,2BAA2B,oCAAoC;AAC/D;AACA,uCAAuC,QAAQ;AAC/C,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE,UAAU,uBAAuB;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,EAAE,GAAG,YAAY;AAC9C;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,QAAQ;AACvC;AACA;AACA,sCAAsC,YAAY;AAClD;AACA,wCAAwC,OAAO;AAC/C;AACA;AACA;AACA,sCAAsC,cAAc;AACpD;AACA,wCAAwC,OAAO;AAC/C;AACA;AACA;AACA,sCAAsC,YAAY;AAClD;AACA,wCAAwC,OAAO;AAC/C;AACA;AACA;AACA;AACA,mCAAmC,SAAS;AAC5C;AACA;AACA;AACA,+FAA+F,YAAY;AAC3G;AACA,gBAAgB;AAChB;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iGAAiG,cAAc;AAC/G;AACA,gBAAgB;AAChB;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+FAA+F,YAAY;AAC3G;AACA,gBAAgB;AAChB;AACA,+EAA+E,aAAa;AAC5F;AACA,mDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E,mBAAmB;AAChG,8CAA8C,IAAI;AAClD;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,QAAQ,EAAE,SAAS,EAAE,QAAQ;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,UAAU;AAC5C;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA,0BAA0B,iBAAiB;AAC3C,0BAA0B,EAAE,GAAG,YAAY,GAAG,UAAU;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,6BAA6B;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,YAAY;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,EAAE,IAAI,EAAE;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,+BAA+B;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,kDAAkD;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,oBAAoB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,KAAK,IAAI,mBAAmB;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,QAAQ;AACzE,iDAAiD,OAAO;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS,eAAe,wBAAwB;AACvF;AACA;AACA;AACA;AACA,qCAAqC,WAAW;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iDAAiD,wBAAwB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS,eAAe,wBAAwB;AACvF;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,sDAAsD,KAAK,eAAe,mBAAmB,IAAI,mBAAmB;AACpH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS,mCAAmC,wBAAwB;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,GAAG,IAAI,EAAE;AAClE;AACA;AACA;AACA,yDAAyD,QAAQ;AACjE,yDAAyD,yBAAyB;AAClF,yDAAyD,0BAA0B;AACnF,yDAAyD,kBAAkB;;AAE3E;AACA,gBAAgB;AAChB;AACA;AACA,mCAAmC,yBAAyB;AAC5D,oCAAoC,kBAAkB;AACtD,mCAAmC,qBAAqB;AACxD;AACA;AACA;AACA;;AAEA;AACA,+CAA+C,MAAM;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA,2BAA2B,oCAAoC;AAC/D;AACA,uCAAuC,0DAA0D;AACjG,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,SAAS;AAC3B,0BAA0B,eAAe;AACzC,gBAAgB,aAAa,GAAG,YAAY;AAC5C,iBAAiB,YAAY,GAAG,WAAW;AAC3C,yBAAyB,mBAAmB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS,gCAAgC,wBAAwB;AACxG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,gDAAgD,EAAE,IAAI,EAAE,IAAI,EAAE;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,EAAE,IAAI,EAAE;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA,2BAA2B,oCAAoC;AAC/D;AACA,aAAa;AACb,yDAAyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS,mCAAmC,wBAAwB;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,UAAU;AAC3E;AACA;AACA;AACA,qBAAqB,6BAA6B;AAClD;AACA;AACA;AACA;AACA,qBAAqB,kCAAkC;AACvD;AACA;AACA;AACA;AACA;AACA,qBAAqB,sBAAsB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAS,iCAAiC,GAAG;AACxF;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,SAAS;AACxD;AACA,mCAAmC,oCAAoC;AACvE;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,+CAA+C,SAAS,iCAAiC,OAAO;AAChG;AACA,mCAAmC,oCAAoC;AACvE;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS,iCAAiC,GAAG;AACpF;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,8BAA8B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,6BAA6B,8CAA8C;AAC3E;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACrzDA;AAC8C;AAC9C;AACA;AACA;AACA;AACA;AACA,iDAAiD,GAAG;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,KAAK,GAAG,cAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,KAAK,GAAG,GAAG;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,SAAS,kDAAkD,uBAAuB;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,mCAAmC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,wBAAwB,8CAA8C;AACtE;AACA;AACA;AACA,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,oDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA,2BAA2B,oCAAoC;AAC/D;AACA,aAAa;AACb;AACA;AACA;AACA,4DAA4D,WAAW;AACvE,sBAAsB,uDAAS;AAC/B;AACA;AACA,sDAAsD,WAAW;AACjE;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,4BAA4B;AAC5E,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,uDAAS;AAC/B;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,6BAA6B,iCAAiC;AAC9D;AACA;AACA,mDAAmD,oCAAoC;AACvF;AACA;AACA;AACA;AACA;AACA,kBAAkB,uDAAS;AAC3B;AACA;AACA,iDAAiD,mBAAmB;AACpE;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;;;;;;;;;;;;;;;;AC5eA;AAC8C;AAC9C;AACA;AACA;AACA,iDAAiD,GAAG;AACpD;AACA;AACA;AACA,0DAA0D,KAAK;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,KAAK,GAAG,cAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,KAAK,GAAG,GAAG;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,gBAAgB,sBAAsB;AACtC;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA,qCAAqC,SAAS,qDAAqD,uBAAuB;AAC1H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,yCAAyC;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mCAAmC;AACxD;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA,2BAA2B,oCAAoC;AAC/D,uCAAuC,kCAAkC;AACzE,aAAa;AACb;AACA;AACA,4DAA4D,YAAY,EAAE,KAAK;AAC/E,sBAAsB,uDAAS;AAC/B;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,uDAAS;AAC/B;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,4BAA4B;AACjF,kBAAkB,uDAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;;;;;;;;;;;;;AC7VA;AACA;AACA;AACA;AACA,+CAA+C,GAAG;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,EAAE,IAAI,EAAE,IAAI,EAAE;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,GAAG,GAAG,GAAG,GAAG,GAAG;AAC7B;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,cAAc,KAAK,GAAG,mBAAmB;AACzC;AACA;AACA,cAAc,gBAAgB,GAAG,0CAA0C,GAAG,qCAAqC;AACnH;AACA;AACA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,EAAE,SAAS,EAAE,KAAK,EAAE;AAC5C;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,uBAAuB;AACxF;AACA;AACA,6BAA6B,8CAA8C,kBAAkB;AAC7F;AACA;AACA;AACA;AACA,oEAAoE,sBAAsB,kBAAkB;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,gBAAgB;AACzD;AACA;AACA;AACA,8BAA8B,gBAAgB;AAC9C,iDAAiD,oBAAoB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,aAAa,SAAS,WAAW;AAC/D;AACA;AACA,8BAA8B,aAAa,SAAS,aAAa;AACjE;AACA;AACA;AACA;AACA;AACA,0BAA0B,WAAW,IAAI,SAAS,KAAK,SAAS;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,+CAA+C;AACnF;AACA,oCAAoC,2CAA2C;AAC/E;AACA,oCAAoC,4CAA4C;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;;AAEA;AACA,uCAAuC,WAAW;AAClD,uCAAuC,WAAW;AAClD,wDAAwD,SAAS;AACjE;;AAEA;AACA,YAAY;AACZ;;AAEA;AACA,YAAY;AACZ;;AAEA;AACA,YAAY;AACZ;;AAEA;AACA,YAAY;AACZ;;AAEA;AACA,YAAY;AACZ;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,mCAAmC,SAAS,uCAAuC,GAAG;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA,2BAA2B,oCAAoC;AAC/D;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,0DAA0D;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACpXA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,YAAY,oFAAoF;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,gBAAgB,wBAAwB;AACxC;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA,wCAAwC,mCAAmC;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,aAAa;AACb;AACA;AACA;AACA;AACO;AACP,0CAA0C,qBAAqB;AAC/D;AACA;;;;;;;;;;;;;;;AC1KO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iBAAiB,gFAAgF;AACjG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;;;;;;;UCrGA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA,E;;;;;WCPA,wF;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D,E;;;;;;;;;;;;;;;;;;ACNA;AACqE;AACV;AACJ;AACQ;AACa;AACI;AACN;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,sEAAsE,GAAG;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA,2BAA2B,SAAS;AACpC;AACA;AACA,aAAa,iBAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,IAAI,kFAAuB;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,oEAAmB;AACzC;AACA;AACA;AACA;AACA,sBAAsB,wEAAqB;AAC3C;AACA;AACA;AACA;AACA,sBAAsB,4EAAuB;AAC7C;AACA;AACA;AACA;AACA,sBAAsB,yFAA6B;AACnD,sBAAsB,6FAA+B;AACrD;AACA;AACA;AACA;AACA,sBAAsB,uFAA4B;AAClD;AACA;AACA;AACA;AACA,4EAA4E;AAC5E;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA,CAAC","sources":["webpack://innomax/./TypeScript/workspace/01_dashboard-trip-status.ts","webpack://innomax/./TypeScript/workspace/02_trip-approval.ts","webpack://innomax/./TypeScript/workspace/04_user-manage.ts","webpack://innomax/./TypeScript/workspace/05_business-master.ts","webpack://innomax/./TypeScript/workspace/08_domestic-trip-register.ts","webpack://innomax/./TypeScript/workspace/09_domestic-trip-settlement.ts","webpack://innomax/./TypeScript/workspace/10_domestic-trip-history.ts","webpack://innomax/./TypeScript/workspace/utils/DistanceCalc.ts","webpack://innomax/./TypeScript/workspace/utils/ModalUtil.ts","webpack://innomax/webpack/bootstrap","webpack://innomax/webpack/runtime/define property getters","webpack://innomax/webpack/runtime/hasOwnProperty shorthand","webpack://innomax/webpack/runtime/make namespace object","webpack://innomax/./TypeScript/workspace/00_workspace.ts"],"sourcesContent":["// TypeScript/workspace/01_dashboard-trip-status.ts\n// ----------------------\n// 유틸\n// ----------------------\nfunction pad2(n) {\n    return String(n).padStart(2, \"0\");\n}\nfunction ymd(d) {\n    return `${d.getFullYear()}-${pad2(d.getMonth() + 1)}-${pad2(d.getDate())}`;\n}\nfunction ym(d) {\n    return `${d.getFullYear()}-${pad2(d.getMonth() + 1)}`;\n}\nfunction todayYmd() {\n    return ymd(new Date());\n}\nfunction parseLocdateToYmd(loc) {\n    // 20260101 -> 2026-01-01\n    const s = String(loc ?? \"\");\n    if (!/^\\d{8}$/.test(s))\n        return \"\";\n    return `${s.slice(0, 4)}-${s.slice(4, 6)}-${s.slice(6, 8)}`;\n}\nfunction getDowKr(dateStr) {\n    const d = new Date(dateStr + \"T00:00:00\");\n    const map = [\"일\", \"월\", \"화\", \"수\", \"목\", \"금\", \"토\"];\n    return map[d.getDay()] ?? \"\";\n}\nfunction isWeekend(dateStr) {\n    const d = new Date(dateStr + \"T00:00:00\");\n    const day = d.getDay();\n    return day === 0 || day === 6;\n}\nfunction getAllDaysOfMonth(base) {\n    const y = base.getFullYear();\n    const m = base.getMonth();\n    const last = new Date(y, m + 1, 0).getDate();\n    const days = [];\n    for (let i = 1; i <= last; i++)\n        days.push(new Date(y, m, i));\n    return days;\n}\nfunction escapeHtml(s) {\n    return String(s ?? \"\")\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\");\n}\nfunction ymdText(v) {\n    if (!v)\n        return \"\";\n    const s = String(v);\n    return s.length >= 10 ? s.slice(0, 10) : s;\n}\nfunction vacTypeLabel(t) {\n    if (t === \"annual\")\n        return \"연차\";\n    if (t === \"half\")\n        return \"반차\";\n    return \"기타\";\n}\nfunction isYmdStr(s) {\n    return typeof s === \"string\" && /^\\d{4}-\\d{2}-\\d{2}$/.test(s);\n}\n// ✅ 숫자 표시 유틸\nfunction fmtNumber(v, fallback = \"0\") {\n    const n = Number(v);\n    if (!Number.isFinite(n))\n        return fallback;\n    return n.toLocaleString();\n}\nfunction setText(id, text) {\n    const el = document.getElementById(id);\n    if (el)\n        el.textContent = text;\n}\n// ✅ duty 로테이션 계산용\nfunction addMonthsToYm(ymStr, delta) {\n    const [y, m] = ymStr.split(\"-\").map(Number);\n    const d = new Date(y, m - 1, 1);\n    d.setMonth(d.getMonth() + delta);\n    return `${d.getFullYear()}-${pad2(d.getMonth() + 1)}`;\n}\nfunction compareYm(a, b) {\n    return a.localeCompare(b);\n}\nfunction mod(n, m) {\n    return ((n % m) + m) % m;\n}\n// ----------------------\n// ✅ DOM이 늦게 생기는 문제 해결(기존 유지)\n// ----------------------\nasync function waitForElement(id, timeoutMs = 8000) {\n    const start = Date.now();\n    return new Promise((resolve) => {\n        const tick = () => {\n            const el = document.getElementById(id);\n            if (el)\n                return resolve(el);\n            if (Date.now() - start > timeoutMs)\n                return resolve(null);\n            requestAnimationFrame(tick);\n        };\n        tick();\n    });\n}\n// ----------------------\n// ✅ API: 휴일(주말+공휴일)\n// ----------------------\nasync function fetchHolidayItemsForMonth(API_BASE, base) {\n    const year = String(base.getFullYear());\n    const month = pad2(base.getMonth() + 1);\n    // 1) 주말\n    const days = getAllDaysOfMonth(base);\n    const weekend = days\n        .map((d) => ymd(d))\n        .filter((ds) => isWeekend(ds))\n        .map((ds) => ({\n        date: ds,\n        dow: getDowKr(ds),\n        type: \"주말\",\n    }));\n    // 2) 공휴일 API\n    let apiHolidays = [];\n    try {\n        const res = await fetch(`${API_BASE}/api/business-master/holidays?year=${year}&month=${month}`, {\n            credentials: \"include\",\n        });\n        const json = await res.json().catch(() => null);\n        if (res.ok && json?.ok === true) {\n            const list = Array.isArray(json.holidays) ? json.holidays : [];\n            apiHolidays = list\n                .filter((h) => h && h.date)\n                .map((h) => {\n                const ds = parseLocdateToYmd(String(h.date));\n                if (!ds)\n                    return null;\n                return {\n                    date: ds,\n                    dow: getDowKr(ds),\n                    type: \"공휴일\",\n                    holidayName: String(h.name ?? \"\").trim() || undefined,\n                };\n            })\n                .filter(Boolean);\n        }\n    }\n    catch (e) {\n        console.warn(\"[대시보드] 공휴일 API 실패(주말만 표시):\", e);\n    }\n    // 3) 합치기(중복 제거): 공휴일 우선\n    const map = new Map();\n    weekend.forEach((w) => map.set(w.date, w));\n    apiHolidays.forEach((h) => map.set(h.date, h));\n    return Array.from(map.values()).sort((a, b) => a.date.localeCompare(b.date));\n}\n// ----------------------\n// ✅ API: 휴가\n// ----------------------\nasync function fetchVacations(API_BASE) {\n    try {\n        const res = await fetch(`${API_BASE}/api/business-master/vacations`, {\n            credentials: \"include\",\n        });\n        const json = await res.json().catch(() => null);\n        if (!res.ok || json?.ok !== true)\n            return [];\n        return Array.isArray(json.items) ? json.items : [];\n    }\n    catch {\n        return [];\n    }\n}\n// ✅ \"월 기준 날짜별 휴가자 배열\" map\nfunction buildVacationMapForMonth(items, base) {\n    const y = base.getFullYear();\n    const m = base.getMonth();\n    const monthStart = new Date(y, m, 1);\n    const monthEnd = new Date(y, m + 1, 0);\n    const map = {};\n    for (const v of items) {\n        if (!v?.user_name)\n            continue;\n        // ✅ start/end 정규화 (ISO -> YYYY-MM-DD)\n        const sStr = ymdText(v.start_date);\n        const eStr = ymdText(v.end_date);\n        if (!isYmdStr(sStr) || !isYmdStr(eStr))\n            continue;\n        const s = new Date(sStr + \"T00:00:00\");\n        const e = new Date(eStr + \"T00:00:00\");\n        if (Number.isNaN(s.getTime()) || Number.isNaN(e.getTime()))\n            continue;\n        const start = s < monthStart ? monthStart : s;\n        const end = e > monthEnd ? monthEnd : e;\n        if (start > end)\n            continue;\n        for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {\n            const key = ymd(d);\n            map[key] = map[key] ?? [];\n            if (!map[key].includes(v.user_name))\n                map[key].push(v.user_name);\n        }\n    }\n    return map;\n}\n// ----------------------\n// ✅ API: 사용자(당직 후보)\n// ----------------------\nasync function fetchDutyMembers(API_BASE) {\n    try {\n        const res = await fetch(`${API_BASE}/api/users`, { credentials: \"include\" });\n        if (!res.ok)\n            return [];\n        const rows = await res.json().catch(() => []);\n        const list = Array.isArray(rows) ? rows : [];\n        return list\n            .map((u) => ({\n            no: Number(u.no ?? u.No ?? 0),\n            name: String(u.name ?? u.Name ?? \"\").trim(),\n        }))\n            .filter((u) => u.no > 0 && u.name)\n            .sort((a, b) => a.no - b.no);\n    }\n    catch {\n        return [];\n    }\n}\nasync function fetchBusinessMasterConfig(API_BASE) {\n    try {\n        const res = await fetch(`${API_BASE}/api/business-master/config`, { credentials: \"include\" });\n        if (!res.ok)\n            return null;\n        const data = await res.json().catch(() => null);\n        if (!data)\n            return null;\n        return {\n            notice: typeof data.notice === \"string\" ? data.notice : undefined,\n            note: typeof data.note === \"string\" ? data.note : undefined,\n            km_per_liter: (data.km_per_liter ?? null),\n            fuel_price_gasoline: (data.fuel_price_gasoline ?? null),\n            fuel_price_diesel: (data.fuel_price_diesel ?? null),\n            fuel_price_lpg: (data.fuel_price_lpg ?? null),\n            exchange_rate_usd: (data.exchange_rate_usd ?? null),\n            exchange_rate_jpy: (data.exchange_rate_jpy ?? null),\n            exchange_rate_cny: (data.exchange_rate_cny ?? null),\n        };\n    }\n    catch {\n        return null;\n    }\n}\nasync function fetchDutyConfig(API_BASE) {\n    try {\n        const res = await fetch(`${API_BASE}/api/business-master/config`, { credentials: \"include\" });\n        if (!res.ok)\n            return { startIndex: 0, lastYm: \"\", lastAssigns: [] };\n        const data = await res.json().catch(() => ({}));\n        const raw = String(data?.duty_members_text ?? \"\");\n        if (!raw)\n            return { startIndex: 0, lastYm: \"\", lastAssigns: [] };\n        try {\n            const parsed = JSON.parse(raw);\n            const startIndex = Number(parsed?.startIndex ?? 0);\n            const lastYm = String(parsed?.lastYm ?? \"\");\n            const lastAssigns = Array.isArray(parsed?.lastAssigns)\n                ? parsed.lastAssigns\n                    .map((a) => ({\n                    date: String(a?.date ?? \"\"),\n                    name: String(a?.name ?? \"\"),\n                }))\n                    .filter((a) => isYmdStr(a.date) && !!a.name)\n                : [];\n            return { startIndex, lastYm, lastAssigns };\n        }\n        catch {\n            return { startIndex: 0, lastYm: \"\", lastAssigns: [] };\n        }\n    }\n    catch {\n        return { startIndex: 0, lastYm: \"\", lastAssigns: [] };\n    }\n}\n// ✅ 회사 일정(캘린더용) 불러오기\nasync function fetchDashboardSchedules(API_BASE, ymStr) {\n    try {\n        const res = await fetch(`${API_BASE}/api/business-master/calendar-events?ym=${encodeURIComponent(ymStr)}`, { credentials: \"include\" });\n        const json = await res.json().catch(() => null);\n        if (!res.ok || json?.ok !== true)\n            return [];\n        return Array.isArray(json.items) ? json.items : [];\n    }\n    catch {\n        return [];\n    }\n}\n// ----------------------\n// ✅ 대시보드: 공지/유류/환율 렌더 (추가)\n// ----------------------\nasync function refreshDashboardTopNoticeFuelFx(API_BASE) {\n    // DOM이 없을 수도 있으니(패널 전환 시) 기다렸다가 세팅\n    await waitForElement(\"fuelUnitGasoline\", 8000);\n    await waitForElement(\"fxUsdKrw\", 8000);\n    const cfg = await fetchBusinessMasterConfig(API_BASE);\n    if (!cfg)\n        return;\n    // 1) 공지(상단 공지판)\n    //const noticeCard = document.querySelector(\"#panel-dashboard .bg-white .font-bold.text-gray-800\") as HTMLElement | null;\n    const noticeCard = Array.from(document.querySelectorAll(\"#panel-dashboard .bg-white\"))\n        .find((el) => (el.textContent || \"\").includes(\"공지사항 알림판\")) ?? null;\n    if (noticeCard) {\n        let out = noticeCard.querySelector(\"#dashNoticeText\");\n        if (!out) {\n            out = document.createElement(\"div\");\n            out.id = \"dashNoticeText\";\n            out.className = \"mt-3 text-[12px] text-gray-700 leading-relaxed whitespace-pre-wrap break-words\";\n            // 카드 안의 첫 설명문 다음에 꽂아줌\n            noticeCard.appendChild(out);\n        }\n        out.textContent = (cfg.notice ?? cfg.note ?? \"\").trim() || \"-\";\n    }\n    // 2) 유류\n    setText(\"fuelUnitGasoline\", fmtNumber(cfg.fuel_price_gasoline, \"0\"));\n    setText(\"fuelUnitDiesel\", fmtNumber(cfg.fuel_price_diesel, \"0\"));\n    setText(\"fuelUnitGas\", fmtNumber(cfg.fuel_price_lpg, \"0\"));\n    // 전기 유류대는 아직 config에 없으니 0 유지\n    // (원하면 나중에 config에 fuel_price_electric 같은 필드 추가해서 연동하면 됨)\n    // 여기서는 기존 표시값 유지(없으면 0)\n    const elElec = document.getElementById(\"fuelUnitElectric\");\n    if (elElec && !elElec.textContent)\n        elElec.textContent = \"0\";\n    // 기준일 표시는 “설정 저장일”이 따로 없어서 오늘로 표시(원하면 config updatedAt 저장해서 정확히 가능)\n    setText(\"fuelPriceBaseDate\", todayYmd());\n    // 3) 환율\n    setText(\"fxUsdKrw\", fmtNumber(cfg.exchange_rate_usd, \"0\"));\n    setText(\"fxJpyKrw\", fmtNumber(cfg.exchange_rate_jpy, \"0\"));\n    setText(\"fxCnyKrw\", fmtNumber(cfg.exchange_rate_cny, \"0\"));\n    setText(\"fxBaseDate\", todayYmd());\n}\n// ----------------------\n// ✅ 대시보드: 표(#dutyHolidayBody) 렌더 (휴일 + 당직 + 휴가)\n// ----------------------\nfunction renderDashboardHolidayDuty(holidays, assignsMap, vacMap) {\n    const tbody = document.getElementById(\"dutyHolidayBody\");\n    if (!tbody)\n        return;\n    if (!holidays.length) {\n        tbody.innerHTML = `\n      <tr>\n        <td class=\"px-2 py-2 text-center text-gray-400\" colspan=\"4\">표시할 휴일이 없습니다.</td>\n      </tr>\n    `;\n        return;\n    }\n    tbody.innerHTML = holidays\n        .map((h) => {\n        const typeLabel = h.type === \"공휴일\"\n            ? h.holidayName\n                ? `공휴일(${h.holidayName})`\n                : \"공휴일\"\n            : \"주말\";\n        const dutyName = assignsMap[h.date] || \"\";\n        const vacNames = vacMap[h.date] ?? [];\n        const lines = [];\n        if (dutyName)\n            lines.push(`당직: ${escapeHtml(dutyName)}`);\n        if (vacNames.length)\n            lines.push(`휴가: ${vacNames.map(escapeHtml).join(\", \")}`);\n        const cell = lines.length === 0\n            ? `<span class=\"text-gray-400\">-</span>`\n            : lines.map((t) => `<div class=\"whitespace-nowrap\">${t}</div>`).join(\"\");\n        return `\n        <tr>\n          <td class=\"border px-2 py-1 text-center\">${h.date.slice(5)}</td>\n          <td class=\"border px-2 py-1 text-center\">${h.dow}</td>\n          <td class=\"border px-2 py-1 text-center\">${typeLabel}</td>\n          <td class=\"border px-2 py-1 text-left\">${cell}</td>\n        </tr>\n      `;\n    })\n        .join(\"\");\n}\n// ----------------------\n// ✅ 대시보드: 달력 그리드(#dutyCalGrid) 렌더 (휴일/당직/휴가)\n// ----------------------\nfunction ensureDutyCalLabel() {\n    let label = document.getElementById(\"dutyCalLabel\");\n    if (!label) {\n        label = document.createElement(\"div\");\n        label.id = \"dutyCalLabel\";\n        label.className = \"hidden\";\n        document.body.appendChild(label);\n    }\n    const txt = (label.textContent || \"\").trim();\n    if (!/^\\d{4}-\\d{2}$/.test(txt))\n        label.textContent = ym(new Date());\n}\nfunction renderDashboardCalendarGrid(viewingYm, holidays, assignsMap, vacMap) {\n    const grid = document.getElementById(\"dutyCalGrid\");\n    if (!grid)\n        return;\n    ensureDutyCalLabel();\n    const label = document.getElementById(\"dutyCalLabel\");\n    if (label)\n        label.textContent = viewingYm;\n    const m = viewingYm.match(/^(\\d{4})-(\\d{2})$/);\n    if (!m)\n        return;\n    const y = Number(m[1]);\n    const mo = Number(m[2]); // 1~12\n    const first = new Date(y, mo - 1, 1);\n    const lastDay = new Date(y, mo, 0).getDate();\n    const startDow = first.getDay(); // 0=일\n    const holidayMap = new Map();\n    for (const h of holidays)\n        holidayMap.set(h.date, h);\n    grid.innerHTML = \"\";\n    // 앞 빈칸\n    for (let i = 0; i < startDow; i++) {\n        const empty = document.createElement(\"div\");\n        empty.className = \"min-h-[90px] border-b border-r bg-gray-50/50\";\n        grid.appendChild(empty);\n    }\n    // 날짜 셀\n    for (let d = 1; d <= lastDay; d++) {\n        const key = `${y}-${pad2(mo)}-${pad2(d)}`;\n        const cell = document.createElement(\"div\");\n        cell.className = \"min-h-[90px] border-b border-r p-1 overflow-hidden bg-white\";\n        cell.dataset.date = key;\n        const h = holidayMap.get(key);\n        const dow = new Date(key + \"T00:00:00\").getDay();\n        const isRed = (h && h.type === \"공휴일\") || dow === 0;\n        const dayEl = document.createElement(\"div\");\n        dayEl.className = `text-[11px] font-bold mb-1 ${isRed ? \"text-rose-600\" : \"text-gray-900\"}`;\n        dayEl.textContent = String(d);\n        cell.appendChild(dayEl);\n        // 휴일 배지(주말/공휴일)\n        if (h) {\n            const badge = document.createElement(\"div\");\n            const isHoliday = h.type === \"공휴일\";\n            badge.className =\n                \"px-1.5 py-0.5 rounded text-[10px] font-semibold mb-1 \" +\n                    (isHoliday ? \"bg-rose-50 text-rose-700\" : \"bg-gray-100 text-gray-700\");\n            badge.textContent = isHoliday ? (h.holidayName ? `공휴일(${h.holidayName})` : \"공휴일\") : \"주말\";\n            cell.appendChild(badge);\n        }\n        // 휴가 1줄(+더보기)\n        const vacs = vacMap[key] ?? [];\n        if (vacs.length) {\n            const vLine = document.createElement(\"div\");\n            vLine.className =\n                \"px-1.5 py-0.5 rounded text-[10px] font-semibold mb-1 bg-amber-50 text-amber-800 whitespace-normal break-keep\";\n            vLine.textContent = `휴가 ${vacs[0]}${vacs.length > 1 ? ` 외 ${vacs.length - 1}` : \"\"}`;\n            cell.appendChild(vLine);\n        }\n        // 당직 1줄\n        const dutyName = assignsMap[key] || \"\";\n        if (dutyName) {\n            const dLine = document.createElement(\"div\");\n            dLine.className =\n                \"px-1.5 py-0.5 rounded text-[10px] font-semibold bg-indigo-50 text-indigo-700 whitespace-normal break-keep\";\n            dLine.textContent = `당직 ${dutyName}`;\n            cell.appendChild(dLine);\n        }\n        grid.appendChild(cell);\n    }\n    // 뒤 빈칸\n    const totalCells = startDow + lastDay;\n    const remain = (7 - (totalCells % 7)) % 7;\n    for (let i = 0; i < remain; i++) {\n        const empty = document.createElement(\"div\");\n        empty.className = \"min-h-[90px] border-b border-r bg-gray-50/30\";\n        grid.appendChild(empty);\n    }\n}\n// ✅ 대시보드 캘린더 셀에 \"일정\"만 추가 표시\nfunction appendSchedulesToDashboardCalendar(viewingYm, schedules) {\n    const grid = document.getElementById(\"dutyCalGrid\");\n    if (!grid)\n        return;\n    const monthItems = schedules.filter((s) => s.date.startsWith(viewingYm));\n    const map = new Map();\n    for (const it of monthItems) {\n        if (!map.has(it.date))\n            map.set(it.date, []);\n        map.get(it.date).push(it);\n    }\n    const cells = grid.querySelectorAll(\"div[data-date]\");\n    cells.forEach((cell) => {\n        const date = cell.dataset.date;\n        const items = map.get(date);\n        if (!items?.length)\n            return;\n        // 🔒 중복 표시 방지\n        cell.querySelectorAll(\".dash-schedule\").forEach((n) => n.remove());\n        const first = items[0];\n        const line = document.createElement(\"div\");\n        line.className =\n            \"dash-schedule px-1.5 py-0.5 mt-1 rounded bg-slate-50 text-slate-800 text-[10px] font-semibold\";\n        line.textContent = `일정 ${first.title}`;\n        cell.appendChild(line);\n        if (items.length > 1) {\n            const more = document.createElement(\"div\");\n            more.className = \"dash-schedule text-[10px] text-slate-600 underline cursor-pointer\";\n            more.textContent = `+${items.length - 1}건`;\n            more.onclick = (e) => {\n                e.stopPropagation();\n                alert(`[${date}]\\n\\n일정:\\n` + items.map((x) => `- ${x.title}`).join(\"\\n\"));\n            };\n            cell.appendChild(more);\n        }\n    });\n}\n// ----------------------\n// ✅ 핵심: \"당직생성 버튼\" 없이도 현재월 당직을 자동으로 계산해서 대시보드에 그리기\n// ----------------------\nasync function computeDutyAssignsForYm(API_BASE, viewingYm, members, cfg) {\n    if (!members.length)\n        return [];\n    const len = members.length;\n    const safeStartIndex = mod(Number(cfg.startIndex || 0), len);\n    // lastYm가 없으면: 그냥 0부터 현재월 휴일 수만큼 배정(처음 사용)\n    if (!/^\\d{4}-\\d{2}$/.test(cfg.lastYm)) {\n        const [yy, mm] = viewingYm.split(\"-\").map(Number);\n        const base = new Date(yy, mm - 1, 1);\n        const holidays = await fetchHolidayItemsForMonth(API_BASE, base);\n        const assigns = [];\n        let idx = 0;\n        for (const h of holidays) {\n            assigns.push({ date: h.date, name: members[idx]?.name ?? \"\" });\n            idx = (idx + 1) % len;\n        }\n        return assigns.filter((a) => a.date && a.name);\n    }\n    // viewingYm == lastYm이고 lastAssigns가 있으면 그걸 그대로 사용(정확)\n    if (compareYm(viewingYm, cfg.lastYm) === 0 && cfg.lastAssigns.length) {\n        return cfg.lastAssigns;\n    }\n    // helper: 어떤 월의 휴일 수\n    async function getHolidayCount(ymStr) {\n        const [yy, mm] = ymStr.split(\"-\").map(Number);\n        const monthBase = new Date(yy, mm - 1, 1);\n        const items = await fetchHolidayItemsForMonth(API_BASE, monthBase);\n        return items.length;\n    }\n    let startIdx = 0;\n    if (compareYm(viewingYm, cfg.lastYm) > 0) {\n        // 미래 월: lastYm 다음달부터 누적해서 idx 이동\n        let idx = safeStartIndex;\n        for (let cur = addMonthsToYm(cfg.lastYm, 1); compareYm(cur, viewingYm) < 0; cur = addMonthsToYm(cur, 1)) {\n            const cnt = await getHolidayCount(cur);\n            idx = mod(idx + cnt, len);\n        }\n        startIdx = idx;\n    }\n    else {\n        // 과거 월: 뒤로 돌리기\n        let idxAfter = safeStartIndex;\n        for (let cur = cfg.lastYm; compareYm(cur, addMonthsToYm(viewingYm, 1)) >= 0; cur = addMonthsToYm(cur, -1)) {\n            const cnt = await getHolidayCount(cur);\n            idxAfter = mod(idxAfter - cnt, len);\n            if (compareYm(cur, addMonthsToYm(viewingYm, 1)) === 0)\n                break;\n        }\n        const viewingCnt = await getHolidayCount(viewingYm);\n        startIdx = mod(idxAfter - viewingCnt, len);\n    }\n    const [yy, mm] = viewingYm.split(\"-\").map(Number);\n    const base = new Date(yy, mm - 1, 1);\n    const holidays = await fetchHolidayItemsForMonth(API_BASE, base);\n    const assigns = [];\n    let idx = startIdx;\n    for (const h of holidays) {\n        const name = members[idx]?.name;\n        if (name)\n            assigns.push({ date: h.date, name });\n        idx = (idx + 1) % len;\n    }\n    return assigns;\n}\n// ----------------------\n// ✅ 대시보드 캘린더(표+그리드) 전체 리프레시\n// ----------------------\nasync function refreshDashboardDutyVacationCalendar(API_BASE) {\n    const tbody = await waitForElement(\"dutyHolidayBody\", 8000);\n    const grid = await waitForElement(\"dutyCalGrid\", 8000);\n    if (!tbody && !grid)\n        return;\n    const viewingYm = ym(new Date());\n    const [yy, mm] = viewingYm.split(\"-\").map(Number);\n    const base = new Date(yy, mm - 1, 1);\n    // 1) 휴일\n    const holidays = await fetchHolidayItemsForMonth(API_BASE, base);\n    // 2) 휴가\n    const vacations = await fetchVacations(API_BASE);\n    const vacMap = buildVacationMapForMonth(vacations, base);\n    // 3) 당직 후보 + config 기반 로테이션 계산\n    const members = await fetchDutyMembers(API_BASE);\n    const cfg = await fetchDutyConfig(API_BASE);\n    const assigns = await computeDutyAssignsForYm(API_BASE, viewingYm, members, cfg);\n    const assignsMap = {};\n    for (const a of assigns)\n        assignsMap[a.date] = a.name;\n    // 4) 표 렌더\n    renderDashboardHolidayDuty(holidays, assignsMap, vacMap);\n    // 5) 그리드 렌더\n    renderDashboardCalendarGrid(viewingYm, holidays, assignsMap, vacMap);\n    // 6) 회사 일정 표시\n    const schedules = await fetchDashboardSchedules(API_BASE, viewingYm);\n    appendSchedulesToDashboardCalendar(viewingYm, schedules);\n}\n/* ============================================================\n * ✅ 휴가자 현황(대시보드)\n * ============================================================ */\nfunction renderDashboardVacation(items, baseDateYmd) {\n    const kpiEl = document.getElementById(\"kpiVacationToday\");\n    const tbody = document.getElementById(\"vacationStatusTableBody\");\n    if (!tbody)\n        return;\n    const searchInput = document.getElementById(\"vacationSearchInput\");\n    const filterSelect = document.getElementById(\"vacationFilterType\");\n    let todayItems = items.filter((v) => {\n        const s = ymdText(v.start_date);\n        const e = ymdText(v.end_date);\n        if (!isYmdStr(s) || !isYmdStr(e))\n            return false;\n        return s <= baseDateYmd && baseDateYmd <= e; // YYYY-MM-DD 문자열 비교는 안전\n    });\n    const filter = filterSelect?.value ?? \"all\";\n    if (filter !== \"all\") {\n        todayItems = todayItems.filter((v) => v.vac_type === filter);\n    }\n    const kw = (searchInput?.value ?? \"\").trim().toLowerCase();\n    if (kw) {\n        todayItems = todayItems.filter((v) => {\n            const name = (v.user_name ?? \"\").toLowerCase();\n            const note = (v.note ?? \"\").toLowerCase();\n            return name.includes(kw) || note.includes(kw);\n        });\n    }\n    if (kpiEl)\n        kpiEl.textContent = String(todayItems.length);\n    if (todayItems.length === 0) {\n        tbody.innerHTML = `\n      <tr>\n        <td class=\"px-2 py-2 text-center text-gray-400\" colspan=\"5\">오늘 휴가자가 없습니다.</td>\n      </tr>\n    `;\n        return;\n    }\n    tbody.innerHTML = todayItems\n        .map((v, idx) => {\n        // ✅ ISO든 뭐든 무조건 YYYY-MM-DD로 잘라서 표시\n        const s = ymdText(v.start_date);\n        const e = ymdText(v.end_date);\n        const range = s && e ? (s === e ? s : `${s} ~ ${e}`) : \"-\";\n        const note = v.note ? escapeHtml(v.note) : \"\";\n        return `\n      <tr class=\"text-xs text-gray-700\">\n        <td class=\"border px-2 py-2 text-center\">${idx + 1}</td>\n        <td class=\"border px-2 py-2 text-center font-semibold\">${escapeHtml(v.user_name)}</td>\n        <td class=\"border px-2 py-2 text-center\">${vacTypeLabel(v.vac_type)}</td>\n        <td class=\"border px-2 py-2 text-center\">${escapeHtml(range)}</td>\n        <td class=\"border px-2 py-2\">${note}</td>\n      </tr>\n    `;\n    })\n        .join(\"\");\n}\nasync function loadDashboardVacation(API_BASE, dateYmd) {\n    const tbody = document.getElementById(\"vacationStatusTableBody\");\n    if (!tbody)\n        return;\n    const dateLabel = document.getElementById(\"vacationStatusDateLabel\");\n    if (dateLabel)\n        dateLabel.textContent = \"오늘\";\n    tbody.innerHTML = `\n    <tr>\n      <td class=\"px-2 py-2 text-center text-gray-400\" colspan=\"5\">휴가자 현황 불러오는 중...</td>\n    </tr>\n  `;\n    try {\n        const res = await fetch(`${API_BASE}/api/business-master/vacations`, { credentials: \"include\" });\n        const json = await res.json().catch(() => null);\n        if (!res.ok || json?.ok !== true) {\n            tbody.innerHTML = `\n        <tr>\n          <td class=\"px-2 py-2 text-center text-red-500\" colspan=\"5\">휴가자 현황 조회 실패</td>\n        </tr>\n      `;\n            const kpiEl = document.getElementById(\"kpiVacationToday\");\n            if (kpiEl)\n                kpiEl.textContent = \"0\";\n            return;\n        }\n        const items = Array.isArray(json.items) ? json.items : [];\n        renderDashboardVacation(items, dateYmd);\n    }\n    catch (e) {\n        console.error(\"[대시보드 휴가] 로딩 실패:\", e);\n        tbody.innerHTML = `\n      <tr>\n        <td class=\"px-2 py-2 text-center text-red-500\" colspan=\"5\">휴가자 현황 로딩 중 오류</td>\n      </tr>\n    `;\n        const kpiEl = document.getElementById(\"kpiVacationToday\");\n        if (kpiEl)\n            kpiEl.textContent = \"0\";\n    }\n}\n/**\n * 📌 대시보드 - 출장자 현황 + 오늘 출장 인원\n */\nexport function initDashboardTripStatus(API_BASE) {\n    const kpiTripEl = document.getElementById(\"kpiTripToday\");\n    const tbody = document.getElementById(\"tripStatusTbody\");\n    const dateLabel = document.getElementById(\"tripStatusDateLabel\");\n    const searchInput = document.getElementById(\"tripSearchInput\");\n    const filterSelect = document.getElementById(\"tripFilterType\");\n    const reloadBtn = document.getElementById(\"btnTripReload\");\n    if (!kpiTripEl || !tbody) {\n        console.warn(\"[대시보드] 출장자 현황용 요소를 찾지 못했습니다.\");\n        return;\n    }\n    const tbodyEl = tbody;\n    let lastItems = [];\n    let currentDate;\n    function renderTable() {\n        const keyword = (searchInput?.value ?? \"\").trim().toLowerCase();\n        const filter = filterSelect?.value ?? \"all\";\n        let items = lastItems.slice();\n        if (filter === \"overseas\" || filter === \"inhouse\") {\n            items = [];\n        }\n        if (keyword) {\n            items = items.filter((it) => {\n                const name = it.req_name?.toLowerCase() ?? \"\";\n                const dest = it.destination?.toLowerCase() ?? \"\";\n                const place = it.depart_place?.toLowerCase() ?? \"\";\n                return name.includes(keyword) || dest.includes(keyword) || place.includes(keyword);\n            });\n        }\n        if (items.length === 0) {\n            tbodyEl.innerHTML = `\n        <tr>\n          <td colspan=\"6\" class=\"border px-2 py-3 text-center text-xs text-gray-400\">\n            등록된 출장 데이터가 없습니다.\n          </td>\n        </tr>\n      `;\n            return;\n        }\n        tbodyEl.innerHTML = \"\";\n        items.forEach((it, idx) => {\n            const tr = document.createElement(\"tr\");\n            tr.className = \"border-t text-xs text-gray-700\";\n            const customer = it.destination || \"-\";\n            const depart = it.depart_time || \"-\";\n            const arrive = it.arrive_time || \"-\";\n            const statusLabel = it.status === \"SETTLED\"\n                ? `<span class=\"px-2 py-[2px] rounded-full bg-emerald-50 text-emerald-700 text-[10px] font-bold whitespace-nowrap\">출장종료</span>`\n                : `<span class=\"px-2 py-[2px] rounded-full bg-indigo-50 text-indigo-700 text-[10px] font-bold whitespace-nowrap\">출장중</span>`;\n            tr.innerHTML = `\n        <td class=\"border px-2 py-2 text-center\">${idx + 1}</td>\n        <td class=\"border px-2 py-2 text-center font-semibold\">${it.req_name || \"-\"}</td>\n        <td class=\"border px-2 py-2 text-center\">${customer}</td>\n        <td class=\"border px-2 py-2 text-center\">${depart}</td>\n        <td class=\"border px-2 py-2 text-center\">${arrive}</td>\n        <td class=\"border px-2 py-2 text-center\">${statusLabel}</td>\n      `;\n            tbodyEl.appendChild(tr);\n        });\n    }\n    async function loadTripStatus(date) {\n        currentDate = date;\n        if (dateLabel) {\n            dateLabel.textContent = date ?? \"오늘\";\n        }\n        tbodyEl.innerHTML = `\n      <tr>\n        <td colspan=\"6\" class=\"border px-2 py-3 text-center text-xs text-gray-400\">\n          데이터 로딩 중...\n        </td>\n      </tr>\n    `;\n        try {\n            const params = new URLSearchParams();\n            if (date)\n                params.set(\"date\", date);\n            const url = params.toString().length > 0\n                ? `${API_BASE}/api/business-trip/status?${params.toString()}`\n                : `${API_BASE}/api/business-trip/status`;\n            const res = await fetch(url);\n            if (!res.ok) {\n                console.error(\"[대시보드] /status 응답 오류:\", res.status);\n                tbodyEl.innerHTML = `\n          <tr>\n            <td colspan=\"6\" class=\"border px-2 py-3 text-center text-xs text-red-500\">\n              서버 오류: HTTP ${res.status}\n            </td>\n          </tr>\n        `;\n                return;\n            }\n            const json = await res.json().catch(() => null);\n            const rows = json?.data ?? [];\n            lastItems = rows;\n            kpiTripEl.textContent = String(rows.length);\n            renderTable();\n        }\n        catch (err) {\n            console.error(\"[대시보드] 출장자 현황 로딩 실패:\", err);\n            tbodyEl.innerHTML = `\n        <tr>\n          <td colspan=\"6\" class=\"border px-2 py-3 text-center text-xs text-red-500\">\n            데이터 로딩 중 오류가 발생했습니다.\n          </td>\n        </tr>\n      `;\n        }\n    }\n    // -----------------------------\n    // 이벤트 바인딩 (출장)\n    // -----------------------------\n    searchInput?.addEventListener(\"input\", () => renderTable());\n    filterSelect?.addEventListener(\"change\", () => renderTable());\n    reloadBtn?.addEventListener(\"click\", () => loadTripStatus(currentDate));\n    window.addEventListener(\"trip-status-refresh\", () => {\n        loadTripStatus(currentDate);\n    });\n    // ✅ 최초 로딩 (출장)\n    loadTripStatus();\n    // ✅ ✅ ✅ 대시보드 캘린더(휴일/당직/휴가)\n    refreshDashboardDutyVacationCalendar(API_BASE);\n    // ✅ ✅ ✅ 공지/유류/환율: 최초 1회 로딩\n    refreshDashboardTopNoticeFuelFx(API_BASE);\n    // -----------------------------\n    // 이벤트 바인딩 (휴가)\n    // -----------------------------\n    const vacationSearchInput = document.getElementById(\"vacationSearchInput\");\n    const vacationFilterType = document.getElementById(\"vacationFilterType\");\n    const btnVacationReload = document.getElementById(\"btnVacationReload\");\n    const reloadVacation = () => loadDashboardVacation(API_BASE, todayYmd());\n    vacationSearchInput?.addEventListener(\"input\", reloadVacation);\n    vacationFilterType?.addEventListener(\"change\", reloadVacation);\n    btnVacationReload?.addEventListener(\"click\", reloadVacation);\n    window.addEventListener(\"vacation-status-refresh\", () => {\n        reloadVacation();\n        refreshDashboardDutyVacationCalendar(API_BASE);\n    });\n    // ✅ 설정/당직쪽에서 \"저장됨\" 이벤트 보내면 대시보드도 즉시 새로고침\n    window.addEventListener(\"duty-config-changed\", () => {\n        refreshDashboardDutyVacationCalendar(API_BASE);\n    });\n    // ✅ ✅ ✅ 출장업무관리에서 config 저장했을 때: 공지/유류/환율 즉시 갱신\n    window.addEventListener(\"business-config-changed\", () => {\n        refreshDashboardTopNoticeFuelFx(API_BASE);\n    });\n    // ✅ 휴가자 현황 최초 1회 로딩\n    loadDashboardVacation(API_BASE, todayYmd());\n}\n","// src/TypeScript/workspace/02_trip-approval.ts\nimport { placeLabel } from \"./utils/DistanceCalc\";\nfunction getEl(id) {\n    const el = document.getElementById(id);\n    if (!el)\n        throw new Error(`element not found: #${id}`);\n    return el;\n}\n/** ISO 날짜 또는 문자열 → YYYY-MM-DD */\nfunction formatDateLabel(value) {\n    if (!value)\n        return \"\";\n    if (value.length >= 10)\n        return value.slice(0, 10);\n    const d = new Date(value);\n    if (isNaN(d.getTime()))\n        return value;\n    return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, \"0\")}-${String(d.getDate()).padStart(2, \"0\")}`;\n}\n/** 요일(월화수목금토일) */\nfunction dowKorFromYMD(ymd) {\n    const d = new Date(ymd);\n    if (Number.isNaN(d.getTime()))\n        return \"\";\n    const map = [\"일\", \"월\", \"화\", \"수\", \"목\", \"금\", \"토\"];\n    return map[d.getDay()] ?? \"\";\n}\nfunction formatDateWithDow(ymd) {\n    const a = formatDateLabel(ymd);\n    const w = dowKorFromYMD(a);\n    return w ? `${a}(${w})` : a;\n}\n/** 특정 날짜가 속한 주(월~일) 구하기 */\nfunction getWeekRange(dateStr) {\n    const d = new Date(dateStr);\n    if (isNaN(d.getTime())) {\n        const x = formatDateLabel(dateStr);\n        return { start: x, end: x };\n    }\n    const day = (d.getDay() + 6) % 7; // 월=0\n    const monday = new Date(d);\n    monday.setDate(d.getDate() - day);\n    const sunday = new Date(monday);\n    sunday.setDate(monday.getDate() + 6);\n    return {\n        start: monday.toISOString().slice(0, 10),\n        end: sunday.toISOString().slice(0, 10),\n    };\n}\n/** TripRow[] 를 직원+주간 단위로 묶기 */\nfunction buildWeeklyGroups(rows) {\n    const map = new Map();\n    for (const row of rows) {\n        const { start, end } = getWeekRange(row.trip_date);\n        const company_part = row.company_part ?? \"-\";\n        const key = `${row.req_name}__${company_part}__${start}`;\n        let group = map.get(key);\n        if (!group) {\n            group = {\n                key,\n                weekStart: start,\n                weekEnd: end,\n                req_name: row.req_name,\n                company_part,\n                rows: [],\n            };\n            map.set(key, group);\n        }\n        group.rows.push(row);\n    }\n    return Array.from(map.values()).sort((a, b) => {\n        if (a.weekStart !== b.weekStart)\n            return a.weekStart.localeCompare(b.weekStart);\n        if (a.company_part !== b.company_part)\n            return a.company_part.localeCompare(b.company_part);\n        return a.req_name.localeCompare(b.req_name);\n    });\n}\nconst API_BASE = location.hostname === \"gwoun01.github.io\"\n    ? \"https://outwork.sel3.cloudtype.app\"\n    : \"http://127.0.0.1:5050\";\nlet currentGroup = null;\n/** ✅ 차량값이 뭐로 오든 표준화 */\nfunction normalizeVehicle(v) {\n    const s = String(v ?? \"\").trim();\n    if (!s)\n        return \"\";\n    if (s === \"corp\" || s === \"corporate\")\n        return \"corp\";\n    if (s === \"personal\")\n        return \"personal\";\n    if (s === \"other\" || s === \"other_personal\")\n        return \"other\";\n    if (s === \"public\")\n        return \"public\";\n    return \"other\";\n}\n/** ✅ 차량 표시 라벨 */\nfunction vehicleLabel(v) {\n    const code = normalizeVehicle(v);\n    if (code === \"corp\")\n        return \"법인\";\n    if (code === \"personal\")\n        return \"개인\";\n    if (code === \"public\")\n        return \"대중교통\";\n    if (code === \"other\")\n        return \"기타\";\n    return \"-\";\n}\n/* =========================\n   ✅ 시간/근무/잔업/일비 유틸\n   ========================= */\nfunction parseHHMMToMinutes(hhmm) {\n    const s = String(hhmm ?? \"\").trim();\n    const m = /^(\\d{1,2}):(\\d{2})$/.exec(s);\n    if (!m)\n        return null;\n    const hh = Number(m[1]);\n    const mm = Number(m[2]);\n    if (!Number.isFinite(hh) || !Number.isFinite(mm))\n        return null;\n    if (hh < 0 || hh > 23 || mm < 0 || mm > 59)\n        return null;\n    return hh * 60 + mm;\n}\nfunction formatDuration(mins) {\n    const h = Math.floor(mins / 60);\n    const m = mins % 60;\n    if (m === 0)\n        return `${h}시간`;\n    return `${h}시간 ${m}분`;\n}\n/** 업무시간(분) 계산: start~end (자정 넘어가면 +24h 처리) */\nfunction calcWorkMinutes(startHHMM, endHHMM) {\n    const s = parseHHMMToMinutes(startHHMM);\n    const e = parseHHMMToMinutes(endHHMM);\n    if (s == null || e == null)\n        return null;\n    let diff = e - s;\n    if (diff < 0)\n        diff += 24 * 60;\n    return diff;\n}\n/** ✅ 직원 화면(10_domestic-trip-history.ts)과 동일 규칙 3줄 생성 */\nfunction buildWork3LinesForAdmin(reg, set) {\n    const departStart = reg?.depart_time || \"-\"; // 출발시간\n    const arriveTime = reg?.arrive_time || \"-\"; // 도착시간(출장지 도착)\n    const returnStart = set?.work_end_time || \"-\"; // 복귀 출발 (=업무 종료)\n    const returnArrive = set?.return_time || \"-\"; // 복귀 도착\n    const workStart = reg?.work_start_time || arriveTime || \"-\";\n    const workEnd = set?.work_end_time || \"-\";\n    const departLine = (departStart !== \"-\" && arriveTime !== \"-\")\n        ? `출발 (출발시간 ${departStart} ~ 도착시간 ${arriveTime})`\n        : \"출발 (-)\";\n    const returnLine = (returnStart !== \"-\" && returnArrive !== \"-\")\n        ? `복귀 (출발시간 ${returnStart} ~ 도착시간 ${returnArrive})`\n        : \"복귀 (-)\";\n    const workMins = (workStart !== \"-\" && workEnd !== \"-\") ? calcWorkMinutes(workStart, workEnd) : null;\n    const workLine = (workMins != null)\n        ? `업무시간 ${workStart} ~ ${workEnd} (총 ${formatDuration(workMins)})`\n        : \"업무시간 -\";\n    return { departLine, returnLine, workLine, workEnd, workMins };\n}\n/** ✅ 그룹 상태(주간 리스트에 표시) */\nfunction groupStatusLabel(g) {\n    // 하나라도 rejected면 반려 우선\n    const anyRejected = g.rows.some((r) => r.approve_status === \"rejected\");\n    if (anyRejected)\n        return { text: \"반려\", cls: \"text-rose-600 font-bold\" };\n    // 전부 approved면 승인\n    const allApproved = g.rows.length > 0 && g.rows.every((r) => r.approve_status === \"approved\");\n    if (allApproved)\n        return { text: \"승인\", cls: \"text-emerald-700 font-bold\" };\n    // 그 외는 대기(제출됨)\n    return { text: \"대기\", cls: \"text-indigo-600 font-bold\" };\n}\nexport function initTripApprovalPanel(_panelId) {\n    const fromInput = getEl(\"appr_from\");\n    const toInput = getEl(\"appr_to\");\n    const statusSelect = getEl(\"appr_status\");\n    const searchBtn = getEl(\"appr_search\");\n    const resultMsg = getEl(\"appr_result_msg\");\n    const tbody = getEl(\"approve_result_tbody\");\n    // ✅ 기본 조회 기간: \"이번 주(월~일)\" 자동 세팅\n    const today = new Date();\n    const monday = new Date(today);\n    monday.setDate(today.getDate() - ((today.getDay() + 6) % 7));\n    const sunday = new Date(monday);\n    sunday.setDate(monday.getDate() + 6);\n    fromInput.value = monday.toISOString().slice(0, 10);\n    toInput.value = sunday.toISOString().slice(0, 10);\n    // ✅ 관리자 자동갱신 함수\n    function triggerAdminRefresh() {\n        const btn = document.getElementById(\"appr_search\");\n        if (btn)\n            btn.click();\n    }\n    // ✅ 제출 이벤트가 오면 관리자 화면 자동 갱신(새로고침 X)\n    window.addEventListener(\"trip:submitted\", () => triggerAdminRefresh());\n    try {\n        const bc = new BroadcastChannel(\"trip-events\");\n        bc.onmessage = (ev) => {\n            if (ev?.data?.type === \"trip:submitted\")\n                triggerAdminRefresh();\n        };\n    }\n    catch { }\n    window.addEventListener(\"storage\", (e) => {\n        if (e.key === \"trip:submitted\")\n            triggerAdminRefresh();\n    });\n    // 🔍 조회 버튼\n    searchBtn.addEventListener(\"click\", async () => {\n        const from = fromInput.value;\n        const to = toInput.value;\n        const status = statusSelect.value;\n        if (!from || !to) {\n            alert(\"시작일과 종료일을 모두 선택해주세요.\");\n            return;\n        }\n        resultMsg.textContent = \"조회 중입니다...\";\n        tbody.innerHTML = `\n      <tr>\n        <td colspan=\"6\" class=\"border px-2 py-3 text-center text-gray-400\">\n          조회 중...\n        </td>\n      </tr>`;\n        try {\n            const url = new URL(\"/api/business-trip/settlements-range-admin\", API_BASE);\n            url.searchParams.set(\"from\", from);\n            url.searchParams.set(\"to\", to);\n            url.searchParams.set(\"status\", status);\n            const res = await fetch(url.toString(), { credentials: \"include\" });\n            const json = await res.json();\n            if (!json.ok) {\n                resultMsg.textContent = json.message ?? \"조회 실패\";\n                tbody.innerHTML = `\n          <tr>\n            <td colspan=\"6\" class=\"border px-2 py-3 text-center text-gray-400\">\n              조회 실패: ${json.message ?? \"알 수 없는 오류\"}\n            </td>\n          </tr>`;\n                return;\n            }\n            let rows = json.data ?? [];\n            // ✅ 혹시 백엔드 필터를 아직 안 넣었다면, 프론트에서도 방어 (제출된 것만)\n            rows = rows.filter((r) => !!r.submitted_at);\n            if (rows.length === 0) {\n                resultMsg.textContent = \"해당 기간에 제출된 정산 내역이 없습니다.\";\n                tbody.innerHTML = `\n          <tr>\n            <td colspan=\"6\" class=\"border px-2 py-3 text-center text-gray-400\">\n              제출된 정산 내역이 없습니다.\n            </td>\n          </tr>`;\n                return;\n            }\n            const groups = buildWeeklyGroups(rows);\n            // ✅ 카운트(제출된 주간 / 총 건수)\n            resultMsg.textContent = `제출된 주간 ${groups.length}개 / 총 ${rows.length}건`;\n            tbody.innerHTML = \"\";\n            groups.forEach((g) => {\n                const tr = document.createElement(\"tr\");\n                // 기간(주간) + 요일 표시\n                const tdPeriod = document.createElement(\"td\");\n                tdPeriod.className = \"border px-2 py-1 text-center whitespace-nowrap\";\n                tdPeriod.textContent = `${formatDateWithDow(g.weekStart)} ~ ${formatDateWithDow(g.weekEnd)}`;\n                tr.appendChild(tdPeriod);\n                const tdTeam = document.createElement(\"td\");\n                tdTeam.className = \"border px-2 py-1 text-center\";\n                tdTeam.textContent = g.company_part;\n                tr.appendChild(tdTeam);\n                const tdName = document.createElement(\"td\");\n                tdName.className = \"border px-2 py-1 text-center\";\n                tdName.textContent = g.req_name;\n                tr.appendChild(tdName);\n                const tdCount = document.createElement(\"td\");\n                tdCount.className = \"border px-2 py-1 text-center\";\n                tdCount.textContent = String(g.rows.length);\n                tr.appendChild(tdCount);\n                // ✅ 상태 표시 컬럼(대기/승인/반려)\n                const st = groupStatusLabel(g);\n                const tdStatus = document.createElement(\"td\");\n                tdStatus.className = `border px-2 py-1 text-center ${st.cls}`;\n                tdStatus.textContent = st.text;\n                tr.appendChild(tdStatus);\n                const tdDetail = document.createElement(\"td\");\n                tdDetail.className = \"border px-2 py-1 text-center\";\n                const btn = document.createElement(\"button\");\n                btn.type = \"button\";\n                btn.textContent = \"주간 상세\";\n                btn.className = \"px-2 py-1 rounded-lg bg-indigo-500 text-white text-[11px] hover:bg-indigo-600\";\n                btn.addEventListener(\"click\", () => openWeeklyDetailModal(g));\n                tdDetail.appendChild(btn);\n                tr.appendChild(tdDetail);\n                tbody.appendChild(tr);\n            });\n        }\n        catch (err) {\n            console.error(err);\n            resultMsg.textContent = \"서버 오류가 발생했습니다.\";\n            tbody.innerHTML = `\n        <tr>\n          <td colspan=\"6\" class=\"border px-2 py-3 text-center text-gray-400\">\n            서버 오류가 발생했습니다.\n          </td>\n        </tr>`;\n        }\n    });\n    // 모달 관련 이벤트\n    const modal = getEl(\"appr_modal\");\n    const modalCloseBtn = getEl(\"appr_modal_close\");\n    const btnApprove = getEl(\"appr_btn_approve\");\n    const btnReject = getEl(\"appr_btn_reject\");\n    modalCloseBtn.addEventListener(\"click\", () => {\n        modal.classList.add(\"hidden\");\n        modal.classList.remove(\"flex\");\n    });\n    // ✅ 주간 승인\n    btnApprove.addEventListener(\"click\", async () => {\n        if (!currentGroup)\n            return;\n        const comment = getEl(\"appr_comment\").value.trim();\n        if (!confirm(\"이 주간의 모든 출장 건을 승인하시겠습니까?\"))\n            return;\n        try {\n            const approver = window.CURRENT_USER_NAME ?? null;\n            let failed = 0;\n            for (const row of currentGroup.rows) {\n                if (row.approve_status === \"approved\")\n                    continue;\n                const res = await fetch(`${API_BASE}/api/business-trip/${encodeURIComponent(row.trip_id)}/approve`, {\n                    method: \"POST\",\n                    headers: { \"Content-Type\": \"application/json\" },\n                    credentials: \"include\",\n                    body: JSON.stringify({ approver, comment }),\n                });\n                const json = await res.json();\n                if (!json.ok) {\n                    failed++;\n                    console.error(\"승인 실패\", row.trip_id, json);\n                }\n            }\n            if (failed > 0)\n                alert(`일부(${failed}건)는 승인에 실패했습니다. 콘솔을 확인해주세요.`);\n            else\n                alert(\"해당 주간 출장 건이 모두 승인되었습니다.\");\n            modal.classList.add(\"hidden\");\n            modal.classList.remove(\"flex\");\n            document.getElementById(\"appr_search\")?.click();\n        }\n        catch (e) {\n            console.error(e);\n            alert(\"서버 오류로 승인에 실패했습니다.\");\n        }\n    });\n    // ✅ 주간 반려\n    btnReject.addEventListener(\"click\", async () => {\n        if (!currentGroup)\n            return;\n        const comment = getEl(\"appr_comment\").value.trim();\n        if (!comment) {\n            if (!confirm(\"반려 사유가 없습니다. 그래도 반려하시겠습니까?\"))\n                return;\n        }\n        try {\n            const approver = window.CURRENT_USER_NAME ?? null;\n            let failed = 0;\n            for (const row of currentGroup.rows) {\n                if (row.approve_status === \"rejected\")\n                    continue;\n                const res = await fetch(`${API_BASE}/api/business-trip/${encodeURIComponent(row.trip_id)}/reject`, {\n                    method: \"POST\",\n                    headers: { \"Content-Type\": \"application/json\" },\n                    credentials: \"include\",\n                    body: JSON.stringify({ approver, comment }),\n                });\n                const json = await res.json();\n                if (!json.ok) {\n                    failed++;\n                    console.error(\"반려 실패\", row.trip_id, json);\n                }\n            }\n            if (failed > 0)\n                alert(`일부(${failed}건)는 반려에 실패했습니다. 콘솔을 확인해주세요.`);\n            else\n                alert(\"해당 주간 출장 건이 모두 반려되었습니다.\");\n            modal.classList.add(\"hidden\");\n            modal.classList.remove(\"flex\");\n            document.getElementById(\"appr_search\")?.click();\n        }\n        catch (e) {\n            console.error(e);\n            alert(\"서버 오류로 반려에 실패했습니다.\");\n        }\n    });\n}\n/** 🔍 주간 상세 모달 */\nfunction openWeeklyDetailModal(group) {\n    currentGroup = group;\n    const modal = getEl(\"appr_modal\");\n    modal.classList.remove(\"hidden\");\n    modal.classList.add(\"flex\");\n    getEl(\"appr_d_name\").textContent = group.req_name;\n    getEl(\"appr_d_date\").textContent =\n        `${formatDateWithDow(group.weekStart)} ~ ${formatDateWithDow(group.weekEnd)}`;\n    const tbody = getEl(\"appr_detail_tbody\");\n    tbody.innerHTML = \"\";\n    const sorted = [...group.rows].sort((a, b) => a.trip_date.localeCompare(b.trip_date));\n    function td(text, cls = \"border px-2 py-1 text-center\") {\n        const el = document.createElement(\"td\");\n        el.className = cls;\n        el.textContent = text || \"\";\n        return el;\n    }\n    function tdHTML(html, cls = \"border px-2 py-2 text-left whitespace-normal leading-snug\") {\n        const el = document.createElement(\"td\");\n        el.className = cls;\n        el.innerHTML = html || \"\";\n        return el;\n    }\n    const mealText = (m) => {\n        if (!m || !m.checked)\n            return \"-\";\n        if (m.owner === \"corp\")\n            return \"법인\";\n        if (m.owner === \"personal\")\n            return \"개인\";\n        return \"사용\";\n    };\n    const overtimeDates = [];\n    let totalDailyAllowance = 0;\n    for (const row of sorted) {\n        const reg = (row.detail_json?.register || row.start_data || {});\n        const set = (row.detail_json?.settlement || row.end_data || {});\n        const w = buildWork3LinesForAdmin(reg, set);\n        // ✅ 일비: 업무 8시간(480분) 이상이면 3,000원\n        if (w.workMins != null && w.workMins >= 480)\n            totalDailyAllowance += 3000;\n        // ✅ 잔업 알림: 업무 종료시간이 20:30 초과\n        const endMin = parseHHMMToMinutes(w.workEnd);\n        if (endMin != null && endMin > (20 * 60 + 30))\n            overtimeDates.push(formatDateLabel(row.trip_date));\n        const workTimeHtml = `\n      <div class=\"text-gray-700\">${w.departLine}</div>\n      <div class=\"text-gray-700\">${w.returnLine}</div>\n      <div class=\"font-bold text-indigo-600 mt-1\">${w.workLine}</div>\n    `;\n        const meals = set.meals || {};\n        const tr = document.createElement(\"tr\");\n        tr.appendChild(td(formatDateWithDow(row.trip_date))); // ✅ 일자+요일\n        tr.appendChild(td(placeLabel(reg.depart_place ?? \"\")));\n        tr.appendChild(td(reg.destination ?? \"\"));\n        tr.appendChild(tdHTML(workTimeHtml));\n        tr.appendChild(td(placeLabel(set.return_place ?? \"\")));\n        tr.appendChild(td(vehicleLabel(set.vehicle)));\n        tr.appendChild(td(mealText(meals.breakfast)));\n        tr.appendChild(td(mealText(meals.lunch)));\n        tr.appendChild(td(mealText(meals.dinner)));\n        tr.appendChild(td(reg.purpose ?? \"\", \"border px-2 py-1 text-left whitespace-pre-wrap\"));\n        tbody.appendChild(tr);\n    }\n    // 💰 금액 요약\n    let totalMealsAmount = 0;\n    let totalFuelAmount = 0;\n    for (const row of group.rows) {\n        const set = (row.detail_json?.settlement || row.end_data || {});\n        const c = set.calc || {};\n        totalMealsAmount += c.meals_personal_amount ?? 0;\n        totalFuelAmount += c.fuel_amount ?? 0;\n    }\n    const amountBox = getEl(\"appr_amount_box\");\n    const sum = totalMealsAmount + totalFuelAmount + totalDailyAllowance;\n    amountBox.textContent =\n        `식대(개인) ${totalMealsAmount.toLocaleString()}원 / ` +\n            `유류비 ${totalFuelAmount.toLocaleString()}원 / ` +\n            `일비 ${totalDailyAllowance.toLocaleString()}원 / ` +\n            `합계 ${sum.toLocaleString()}원`;\n    // 승인/반려 상태 요약\n    const total = group.rows.length;\n    const pending = group.rows.filter((r) => !r.approve_status || r.approve_status === \"pending\").length;\n    const approved = group.rows.filter((r) => r.approve_status === \"approved\").length;\n    const rejected = group.rows.filter((r) => r.approve_status === \"rejected\").length;\n    const footer = getEl(\"appr_footer_info\");\n    footer.textContent = `총 ${total}건 / 대기 ${pending}건 / 승인 ${approved}건 / 반려 ${rejected}건`;\n    // 의견 초기화\n    getEl(\"appr_comment\").value = group.rows[0]?.approve_comment ?? \"\";\n    // ✅ 잔업비 알림\n    if (overtimeDates.length > 0) {\n        const uniq = Array.from(new Set(overtimeDates));\n        alert(`※잔업비 확인하세요\\n(업무 종료시간 20:30 초과)\\n- ${uniq.join(\", \")}`);\n    }\n}\n","// 04_user-manage.ts\nconst PERM_KEYS = [\"출장승인\", \"출장내역관리\", \"출장등록\", \"출장내역\", \"사용자관리\"];\n/** 문자열 → number | null 공통 함수 */\nfunction parseNumberOrNull(value) {\n    if (!value)\n        return null;\n    const n = Number(String(value).replace(/,/g, \"\"));\n    return Number.isFinite(n) ? n : null;\n}\n/** 서버에서 온 row(any 형태)를 InnomaxUser 로 변환 */\nfunction mapRawUser(row) {\n    // distance_detail_json 파싱\n    let distanceArr = [];\n    const rawDistance = row.distance_detail_json ?? null;\n    if (rawDistance) {\n        let parsed = rawDistance;\n        // text로 왔을 수도 있으니 파싱\n        if (typeof parsed === \"string\") {\n            try {\n                parsed = JSON.parse(parsed);\n            }\n            catch {\n                parsed = [];\n            }\n        }\n        if (Array.isArray(parsed)) {\n            distanceArr = parsed.map((r) => ({\n                region: String(r.region ?? \"\"),\n                client_name: String(r.client_name ?? \"\"),\n                travel_time_text: String(r.travel_time_text ?? \"\"),\n                // 예전 구조도 최대한 따라와서 km 필드로 변환\n                home_distance_km: r.home_distance_km != null\n                    ? Number(r.home_distance_km)\n                    : r.distance_km != null\n                        ? Number(r.distance_km)\n                        : r.home_distance_min != null\n                            ? Number(r.home_distance_min)\n                            : null,\n            }));\n        }\n    }\n    // permissions: jsonb / text / null 어떤 형태로 와도 처리\n    let perms = null;\n    let rawPerms = row.permissions ?? null;\n    if (rawPerms) {\n        if (typeof rawPerms === \"string\") {\n            try {\n                rawPerms = JSON.parse(rawPerms);\n            }\n            catch {\n                rawPerms = null;\n            }\n        }\n        if (rawPerms && typeof rawPerms === \"object\" && !Array.isArray(rawPerms)) {\n            perms = rawPerms;\n        }\n    }\n    return {\n        no: Number(row.no ?? row.No ?? 0),\n        id: String(row.id ?? row.ID ?? \"\"),\n        name: String(row.name ?? row.Name ?? \"\"),\n        email: row.email ?? null,\n        company_part: row.company_part ?? null,\n        address: row.address ?? null,\n        fuel_type: row.fuel_type ?? null,\n        permissions: perms,\n        distance_detail: distanceArr,\n    };\n}\n/** 폼의 permission select 값들 → 객체로 모으기 */\nfunction collectPermissionsFromForm() {\n    const perms = {};\n    PERM_KEYS.forEach((key) => {\n        const el = document.getElementById(key);\n        if (el)\n            perms[key] = el.value;\n    });\n    return perms;\n}\n/** 폼 select 들을 주어진 permission 값으로 채우기 */\nfunction fillPermissionSelects(perms) {\n    PERM_KEYS.forEach((key) => {\n        const el = document.getElementById(key);\n        if (!el)\n            return;\n        const v = perms?.[key];\n        el.value = v ? String(v) : \"None\";\n    });\n}\n/** 👁 버튼용 비밀번호 표시/숨기기 */\nfunction togglePassword() {\n    const input = document.getElementById(\"modalPassword\");\n    if (!input)\n        return;\n    input.type = input.type === \"password\" ? \"text\" : \"password\";\n}\n// HTML에서 onclick=\"togglePassword()\" 쓸 수 있게 전역에 올리기\nwindow.togglePassword = togglePassword;\n/**\n * ✅ DOM이 늦게 붙는(탭 전환) 구조에서 자주 null이 떠서,\n *   특정 id가 생길 때까지 몇 번 재시도하는 유틸\n */\nasync function waitForEl(id, tries = 30, delayMs = 100) {\n    for (let i = 0; i < tries; i++) {\n        const el = document.getElementById(id);\n        if (el)\n            return el;\n        await new Promise((r) => setTimeout(r, delayMs));\n    }\n    return null;\n}\nexport function initUserManagePanel(API_BASE) {\n    console.log(\"[사용자관리] initUserManagePanel 시작\");\n    // ✅ 탭 전환 구조에서 DOM이 아직 없을 수 있어서 기다렸다가 잡는다\n    (async () => {\n        const tbodyEl = await waitForEl(\"userTableBody\", 40, 100);\n        const userModal = document.getElementById(\"userModal\");\n        const userForm = document.getElementById(\"userForm\");\n        const modalTitle = document.getElementById(\"modalTitle\");\n        const modalMode = document.getElementById(\"modalMode\"); // add / edit\n        const modalNo = document.getElementById(\"modalNo\");\n        const inputName = document.getElementById(\"modalName\");\n        const inputID = document.getElementById(\"modalID\");\n        const inputPassword = document.getElementById(\"modalPassword\");\n        const inputEmail = document.getElementById(\"modalEmail\");\n        const inputCompany = document.getElementById(\"modalCompanyPart\");\n        const inputAddress = document.getElementById(\"modalAddress\");\n        // ✅ 유종(사용자 1개) input\n        const inputFuelType = document.getElementById(\"modalFuelType\");\n        const btnAdd = document.getElementById(\"userAddBtn\");\n        const btnModalClose = document.getElementById(\"userModalCancelBtn\");\n        // 🔹 거리표 관련 DOM\n        const distanceTbodyEl = document.getElementById(\"userDistanceTbody\");\n        const btnDistanceAddRow = document.getElementById(\"btnUserDistanceAddRow\");\n        // ✅ 여기서도 필수 DOM 검증\n        if (!tbodyEl) {\n            console.error(\"[사용자관리] ❌ userTableBody 를 못 찾았습니다. (HTML tbody id 확인!)\");\n            return;\n        }\n        if (!userModal || !userForm) {\n            console.warn(\"[사용자관리] userModal 또는 userForm 을 못 찾았습니다. (모달 HTML 확인)\");\n            return;\n        }\n        const tbody = tbodyEl;\n        const distanceTbody = distanceTbodyEl;\n        // 이미 초기화된 경우 또 하지 않기 (사이드바 이동 시 중복 방지)\n        if (tbody._bound) {\n            console.debug(\"[사용자관리] 이미 초기화됨. (이벤트만 refresh 로 처리)\");\n            // ✅ 그래도 refresh 이벤트는 살아있어야 하니 아래에서 이벤트만 등록\n        }\n        else {\n            tbody._bound = true;\n        }\n        // 🔹 현재 모달에서 편집 중인 거리 배열\n        let distanceRows = [];\n        let masterClients = [];\n        // ================== 거래처 마스터 로딩 ==================\n        async function loadMasterClients() {\n            try {\n                const res = await fetch(`${API_BASE}/api/business-master/client-list`, {\n                    credentials: \"include\",\n                });\n                if (!res.ok) {\n                    console.error(\"[사용자관리] 거래처 마스터 조회 실패 status =\", res.status);\n                    return;\n                }\n                const rows = (await res.json());\n                masterClients = rows\n                    .map((r) => ({\n                    region: String(r.region ?? \"\"),\n                    client_name: String(r.client_name ?? \"\").trim(),\n                    travel_time_text: String(r.travel_time_text ?? \"\"),\n                }))\n                    .filter((c) => c.client_name)\n                    .sort((a, b) => a.client_name.localeCompare(b.client_name, \"ko\"));\n                console.log(\"[사용자관리] 거래처 마스터 로딩 완료, 개수 =\", masterClients.length);\n            }\n            catch (err) {\n                console.error(\"[사용자관리] 거래처 마스터 로딩 중 오류:\", err);\n            }\n        }\n        // ============= 거리표 렌더링/수집 함수들 =============\n        /** 거리표 렌더링 */\n        function renderDistanceTable() {\n            if (!distanceTbody)\n                return;\n            distanceTbody.innerHTML = \"\";\n            if (!distanceRows.length) {\n                distanceTbody.innerHTML = `\n          <tr>\n            <td colspan=\"5\" class=\"border px-2 py-1 text-center text-[11px] text-gray-400\">\n              등록된 거리 정보가 없습니다. [+ 거리 행 추가] 버튼으로 추가하세요.\n            </td>\n          </tr>\n        `;\n                return;\n            }\n            distanceRows.forEach((row, index) => {\n                const tr = document.createElement(\"tr\");\n                tr.dataset.index = String(index);\n                tr.innerHTML = `\n          <td class=\"border px-1 py-1 text-center text-[11px]\">${index + 1}</td>\n          <td class=\"border px-1 py-1\">\n            <input type=\"text\"\n              class=\"w-full border rounded px-1 py-[2px] text-[11px] region-input\"\n              value=\"${row.region ?? \"\"}\"\n            />\n          </td>\n          <td class=\"border px-1 py-1\">\n            <input type=\"text\"\n              class=\"w-full border rounded px-1 py-[2px] text-[11px] client-input\"\n              value=\"${row.client_name ?? \"\"}\"\n            />\n          </td>\n          <td class=\"border px-1 py-1\">\n            <input type=\"text\"\n              class=\"w-full border rounded px-1 py-[2px] text-[11px] travel-time-input\"\n              placeholder=\"예: 1시간8분\"\n              value=\"${row.travel_time_text ?? \"\"}\"\n            />\n          </td>\n          <td class=\"border px-1 py-1\">\n            <input type=\"number\" step=\"0.1\"\n              class=\"w-full border rounded px-1 py-[2px] text-right text-[11px] home-km-input\"\n              placeholder=\"자택→출장지 km\"\n              value=\"${row.home_distance_km ?? \"\"}\"\n            />\n          </td>\n        `;\n                distanceTbody.appendChild(tr);\n            });\n        }\n        /** 테이블 DOM → distanceRows 배열로 반영 */\n        function syncDistanceRowsFromTable() {\n            if (!distanceTbody)\n                return;\n            const trs = distanceTbody.querySelectorAll(\"tr\");\n            const newRows = [];\n            trs.forEach((tr) => {\n                const regionInput = tr.querySelector(\".region-input\");\n                const clientInput = tr.querySelector(\".client-input\");\n                const travelTimeInput = tr.querySelector(\".travel-time-input\");\n                const homeKmInput = tr.querySelector(\".home-km-input\");\n                // 안내문 행은 input이 없으니 스킵\n                if (!clientInput)\n                    return;\n                const clientName = clientInput.value.trim();\n                const homeKm = parseNumberOrNull(homeKmInput?.value ?? \"\");\n                // 거래처 + 자택거리 둘 다 없으면 완전 빈줄로 보고 스킵\n                if (!clientName && homeKm == null)\n                    return;\n                newRows.push({\n                    region: regionInput?.value.trim() ?? \"\",\n                    client_name: clientName,\n                    travel_time_text: travelTimeInput?.value.trim() ?? \"\",\n                    home_distance_km: homeKm,\n                });\n            });\n            distanceRows = newRows;\n        }\n        /** 빈 행 하나 추가 */\n        function addDistanceEmptyRow() {\n            distanceRows.push({\n                region: \"\",\n                client_name: \"\",\n                travel_time_text: \"\",\n                home_distance_km: null,\n            });\n            renderDistanceTable();\n        }\n        /** 모달 열기 */\n        function openModal(mode, user) {\n            if (!userModal || !modalMode || !modalTitle)\n                return;\n            modalMode.value = mode;\n            if (mode === \"add\") {\n                modalTitle.textContent = \"사용자 추가\";\n                if (modalNo)\n                    modalNo.value = \"\";\n                if (inputID)\n                    inputID.value = \"\";\n                if (inputName)\n                    inputName.value = \"\";\n                if (inputPassword)\n                    inputPassword.value = \"\";\n                if (inputEmail)\n                    inputEmail.value = \"\";\n                if (inputCompany)\n                    inputCompany.value = \"이노맥스\";\n                if (inputAddress)\n                    inputAddress.value = \"\";\n                if (inputFuelType)\n                    inputFuelType.value = \"\";\n                fillPermissionSelects(null);\n                distanceRows =\n                    masterClients.length > 0\n                        ? masterClients.map((c) => ({\n                            region: c.region,\n                            client_name: c.client_name,\n                            travel_time_text: c.travel_time_text,\n                            home_distance_km: null,\n                        }))\n                        : [];\n            }\n            else {\n                modalTitle.textContent = \"사용자 수정\";\n                if (user && modalNo)\n                    modalNo.value = String(user.no);\n                if (inputID)\n                    inputID.value = user?.id ?? \"\";\n                if (inputName)\n                    inputName.value = user?.name ?? \"\";\n                if (inputPassword)\n                    inputPassword.value = \"\";\n                if (inputEmail)\n                    inputEmail.value = user?.email ?? \"\";\n                if (inputCompany)\n                    inputCompany.value = user?.company_part ?? \"이노맥스\";\n                if (inputAddress)\n                    inputAddress.value = user?.address ?? \"\";\n                if (inputFuelType)\n                    inputFuelType.value = user?.fuel_type ?? \"\";\n                fillPermissionSelects(user?.permissions ?? {});\n                distanceRows =\n                    user?.distance_detail && user.distance_detail.length\n                        ? user.distance_detail\n                        : masterClients.map((c) => ({\n                            region: c.region,\n                            client_name: c.client_name,\n                            travel_time_text: c.travel_time_text,\n                            home_distance_km: null,\n                        }));\n            }\n            renderDistanceTable();\n            userModal.classList.remove(\"hidden\");\n        }\n        /** 모달 닫기 */\n        function closeModal() {\n            if (!userModal)\n                return;\n            userModal.classList.add(\"hidden\");\n        }\n        // 모달 \"취소\" 버튼\n        btnModalClose?.addEventListener(\"click\", closeModal);\n        // 상단 \"사용자 추가\" 버튼\n        console.log(\"[사용자관리] userAddBtn =\", btnAdd);\n        btnAdd?.addEventListener(\"click\", () => {\n            console.log(\"[사용자관리] 추가 버튼 클릭\");\n            openModal(\"add\");\n        });\n        /** 사용자 목록 다시 로딩 */\n        async function loadUsers() {\n            tbody.innerHTML = `\n        <tr>\n          <td colspan=\"8\" class=\"px-3 py-2 text-center text-xs text-gray-400\">\n            사용자 목록 로딩 중...\n          </td>\n        </tr>\n      `;\n            try {\n                const res = await fetch(`${API_BASE}/api/users`, { credentials: \"include\" });\n                if (!res.ok)\n                    throw new Error(`status = ${res.status}`);\n                const rows = await res.json();\n                console.log(\"[사용자관리] 서버 응답 =\", rows);\n                const users = Array.isArray(rows) ? rows.map(mapRawUser) : [];\n                if (!users.length) {\n                    tbody.innerHTML = `\n            <tr>\n              <td colspan=\"8\" class=\"px-3 py-2 text-center text-xs text-gray-400\">\n                등록된 사용자가 없습니다.\n              </td>\n            </tr>\n          `;\n                    return;\n                }\n                tbody.innerHTML = \"\";\n                users.forEach((u, idx) => {\n                    const tr = document.createElement(\"tr\");\n                    tr.className = \"divide-y divide-gray-200 text-xs\";\n                    let permText = \"권한없음\";\n                    if (u.permissions) {\n                        permText = Object.entries(u.permissions)\n                            .map(([k, v]) => `${k}:${v}`)\n                            .join(\", \");\n                    }\n                    tr.innerHTML = `\n            <td class=\"px-3 py-2\">${idx + 1}</td>\n            <td class=\"px-3 py-2\">${u.name}</td>\n            <td class=\"px-3 py-2\">${u.id}</td>\n            <td class=\"px-3 py-2\">****</td>\n            <td class=\"px-3 py-2\">${u.email ?? \"\"}</td>\n            <td class=\"px-3 py-2\">${u.company_part ?? \"\"}</td>\n            <td class=\"px-3 py-2 text-center\">${permText}</td>\n            <td class=\"px-3 py-2 text-center space-x-1\">\n              <button class=\"px-2 py-1 rounded bg-indigo-500 text-white text-[11px] btn-edit-user\" data-no=\"${u.no}\">\n                수정\n              </button>\n              <button class=\"px-2 py-1 rounded bg-red-500 text-white text-[11px] btn-del-user\" data-no=\"${u.no}\">\n                삭제\n              </button>\n            </td>\n          `;\n                    tbody.appendChild(tr);\n                });\n            }\n            catch (err) {\n                console.error(\"[사용자관리] 목록 로딩 실패:\", err);\n                tbody.innerHTML = `\n          <tr>\n            <td colspan=\"8\" class=\"px-3 py-2 text-center text-xs text-red-500\">\n              목록 로딩 중 오류가 발생했습니다.\n            </td>\n          </tr>\n        `;\n            }\n        }\n        /** 테이블에서 수정/삭제 버튼 클릭 처리 (이벤트 위임) */\n        tbody.addEventListener(\"click\", async (e) => {\n            const target = e.target;\n            if (!target)\n                return;\n            // 수정 버튼\n            if (target.classList.contains(\"btn-edit-user\")) {\n                const no = target.dataset.no;\n                if (!no)\n                    return;\n                try {\n                    const res = await fetch(`${API_BASE}/api/users/${no}`, { credentials: \"include\" });\n                    if (!res.ok) {\n                        alert(\"사용자 정보를 불러올 수 없습니다.\");\n                        return;\n                    }\n                    const raw = await res.json();\n                    openModal(\"edit\", mapRawUser(raw));\n                }\n                catch (err) {\n                    console.error(\"[사용자관리] 단일 조회 실패:\", err);\n                }\n            }\n            // 삭제 버튼\n            if (target.classList.contains(\"btn-del-user\")) {\n                const no = target.dataset.no;\n                if (!no)\n                    return;\n                if (!confirm(\"정말 이 사용자를 삭제하시겠습니까?\"))\n                    return;\n                try {\n                    const res = await fetch(`${API_BASE}/api/users/${no}`, {\n                        method: \"DELETE\",\n                        credentials: \"include\",\n                    });\n                    if (!res.ok) {\n                        alert(\"삭제 실패\");\n                        return;\n                    }\n                    await loadUsers();\n                }\n                catch (err) {\n                    console.error(\"[사용자관리] 삭제 실패:\", err);\n                    alert(\"삭제 중 오류가 발생했습니다.\");\n                }\n            }\n        });\n        /** 모달 안의 form submit → 추가 또는 수정 */\n        userForm.addEventListener(\"submit\", async (e) => {\n            e.preventDefault();\n            const mode = modalMode?.value === \"edit\" ? \"edit\" : \"add\";\n            const no = modalNo?.value;\n            const id = inputID?.value.trim() ?? \"\";\n            const name = inputName?.value.trim() ?? \"\";\n            const password = inputPassword?.value.trim() ?? \"\";\n            const email = inputEmail?.value.trim() || null;\n            const company_part = inputCompany?.value.trim() || null;\n            const address = inputAddress?.value.trim() || null;\n            const fuel_type = inputFuelType?.value.trim() || null;\n            const permissions = collectPermissionsFromForm();\n            syncDistanceRowsFromTable();\n            if (!id || !name || (mode === \"add\" && !password)) {\n                alert(\"ID, 이름, 비밀번호(추가 시)는 필수입니다.\");\n                return;\n            }\n            try {\n                if (mode === \"add\") {\n                    const res = await fetch(`${API_BASE}/api/users`, {\n                        method: \"POST\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({\n                            Name: name,\n                            ID: id,\n                            password,\n                            email,\n                            company_part,\n                            permissions,\n                            address,\n                            fuel_type,\n                            distance_detail: distanceRows,\n                        }),\n                    });\n                    const json = await res.json().catch(() => ({}));\n                    if (!res.ok || json.ok === false) {\n                        alert(json.error || \"사용자 추가 실패\");\n                        return;\n                    }\n                }\n                else {\n                    if (!no) {\n                        alert(\"수정 대상 사용자를 찾을 수 없습니다.\");\n                        return;\n                    }\n                    const payload = {\n                        Name: name,\n                        ID: id,\n                        email,\n                        company_part,\n                        permissions,\n                        address,\n                        fuel_type,\n                        distance_detail: distanceRows,\n                    };\n                    if (password)\n                        payload.password = password;\n                    const res = await fetch(`${API_BASE}/api/users/${no}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify(payload),\n                    });\n                    const json = await res.json().catch(() => ({}));\n                    if (!res.ok || json.ok === false) {\n                        alert(json.error || \"사용자 수정 실패\");\n                        return;\n                    }\n                }\n                closeModal();\n                await loadUsers();\n            }\n            catch (err) {\n                console.error(\"[사용자관리] 저장 실패:\", err);\n                alert(\"저장 중 오류가 발생했습니다.\");\n            }\n        });\n        // [+ 거리 행 추가] 버튼\n        btnDistanceAddRow?.addEventListener(\"click\", addDistanceEmptyRow);\n        // ✅ 다른 곳에서 “사용자관리 다시 새로고침” 이벤트 보내면, 여기서 즉시 재로딩\n        window.addEventListener(\"user-manage-refresh\", () => {\n            console.log(\"[사용자관리] refresh 이벤트 수신 → loadUsers()\");\n            loadUsers();\n        });\n        // 초기 데이터 로딩\n        await loadMasterClients();\n        await loadUsers();\n    })();\n}\n","// 05_business-master.ts\n// ======================\n// 유틸\n// ======================\nfunction parseNumberOrNull(value) {\n    if (!value)\n        return null;\n    const n = Number(String(value).replace(/,/g, \"\"));\n    return Number.isFinite(n) ? n : null;\n}\nfunction mapRawDistance(row) {\n    return {\n        id: row.id != null ? Number(row.id) : null,\n        region: String(row.region ?? \"\"),\n        client_name: String(row.client_name ?? \"\"),\n        distance_km: row.distance_km != null ? Number(row.distance_km) : null,\n    };\n}\nfunction pad2(n) {\n    return String(n).padStart(2, \"0\");\n}\nfunction ymd(d) {\n    return `${d.getFullYear()}-${pad2(d.getMonth() + 1)}-${pad2(d.getDate())}`;\n}\nfunction ym(d) {\n    return `${d.getFullYear()}-${pad2(d.getMonth() + 1)}`;\n}\nfunction parseLocdateToYmd(loc) {\n    const s = String(loc ?? \"\");\n    if (!/^\\d{8}$/.test(s))\n        return \"\";\n    return `${s.slice(0, 4)}-${s.slice(4, 6)}-${s.slice(6, 8)}`;\n}\nfunction getDowKr(dateStr) {\n    const d = new Date(dateStr + \"T00:00:00\");\n    const day = d.getDay();\n    const map = [\"일\", \"월\", \"화\", \"수\", \"목\", \"금\", \"토\"];\n    return map[day] ?? \"\";\n}\nfunction isWeekend(dateStr) {\n    const d = new Date(dateStr + \"T00:00:00\");\n    const day = d.getDay();\n    return day === 0 || day === 6;\n}\nfunction getAllDaysOfMonth(base) {\n    const y = base.getFullYear();\n    const m = base.getMonth();\n    const last = new Date(y, m + 1, 0).getDate();\n    const days = [];\n    for (let i = 1; i <= last; i++)\n        days.push(new Date(y, m, i));\n    return days;\n}\nfunction escapeHtml(s) {\n    return String(s ?? \"\")\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\");\n}\n// ✅ 날짜 표시용: \"2026-01-07T00:00:00.000Z\" → \"2026-01-07\"\nfunction ymdText(v) {\n    if (!v)\n        return \"\";\n    const s = String(v);\n    return s.length >= 10 ? s.slice(0, 10) : s;\n}\nfunction vacTypeLabel(t) {\n    if (t === \"annual\")\n        return \"연차\";\n    if (t === \"half\")\n        return \"반차\";\n    return \"기타\";\n}\nfunction openVacNoteModal(name, range, note) {\n    alert(`[비고]\\n${name}\\n${range}\\n\\n${note}`);\n}\n// ✅ 월 계산 유틸(로테이션 프리뷰에 필요)\nfunction addMonthsToYm(ymStr, delta) {\n    const [y, m] = ymStr.split(\"-\").map(Number);\n    const d = new Date(y, m - 1, 1);\n    d.setMonth(d.getMonth() + delta);\n    return `${d.getFullYear()}-${pad2(d.getMonth() + 1)}`;\n}\nfunction compareYm(a, b) {\n    return a.localeCompare(b);\n}\nfunction mod(n, m) {\n    return ((n % m) + m) % m;\n}\n// ✅✅✅ YYYY-MM-DD 체크(일정/필터에 사용)\nfunction isYmd(s) {\n    return typeof s === \"string\" && /^\\d{4}-\\d{2}-\\d{2}$/.test(s);\n}\nfunction datesBetweenInclusive(start, end) {\n    const out = [];\n    // ✅ ISO(\"2026-01-07T00:00:00.000Z\")든 뭐든 앞 10글자만 사용\n    const s0 = ymdText(start);\n    const e0 = ymdText(end);\n    // ✅ 유효성 체크\n    if (!isYmd(s0) || !isYmd(e0))\n        return out;\n    if (s0 > e0)\n        return out;\n    const s = new Date(s0 + \"T00:00:00\");\n    const e = new Date(e0 + \"T00:00:00\");\n    // 혹시라도 Date가 깨지면 방어\n    if (Number.isNaN(s.getTime()) || Number.isNaN(e.getTime()))\n        return out;\n    for (let d = new Date(s); d <= e; d.setDate(d.getDate() + 1)) {\n        out.push(ymd(d));\n    }\n    return out;\n}\nfunction buildVacationEvents(items) {\n    const map = new Map();\n    for (const it of items) {\n        // ✅ ISO든 뭐든 앞 10글자 정규화\n        const s = ymdText(it?.start_date);\n        const e = ymdText(it?.end_date);\n        if (!isYmd(s) || !isYmd(e))\n            continue;\n        const label = `${it.user_name}(${vacTypeLabel(it.vac_type)})`;\n        const days = datesBetweenInclusive(s, e);\n        for (const ds of days) {\n            if (!map.has(ds))\n                map.set(ds, []);\n            map.get(ds).push({\n                date: ds,\n                kind: \"VACATION\",\n                text: label,\n            });\n        }\n    }\n    return map;\n}\nfunction buildDutyEvents(assigns) {\n    const map = new Map();\n    for (const a of assigns) {\n        if (!a?.date || !a?.name)\n            continue;\n        if (!map.has(a.date))\n            map.set(a.date, []);\n        map.get(a.date).push({\n            date: a.date,\n            kind: \"DUTY\",\n            text: a.name,\n        });\n    }\n    return map;\n}\n// ✅✅✅ 일정(캘린더 이벤트) 펼치기\nfunction buildScheduleEvents(items) {\n    const map = new Map();\n    for (const it of items) {\n        if (!it?.date || !isYmd(it.date))\n            continue;\n        const title = String(it.title ?? \"\").trim();\n        if (!title)\n            continue;\n        if (!map.has(it.date))\n            map.set(it.date, []);\n        map.get(it.date).push({\n            date: it.date,\n            kind: \"SCHEDULE\",\n            text: title,\n            id: Number(it.id), // ✅ 삭제용 id\n        });\n    }\n    return map;\n}\nfunction buildVacationMapForDash(items) {\n    const map = new Map();\n    for (const it of items) {\n        const s = ymdText(it?.start_date);\n        const e = ymdText(it?.end_date);\n        if (!isYmd(s) || !isYmd(e))\n            continue;\n        const label = `${it.user_name}(${vacTypeLabel(it.vac_type)})`;\n        const days = datesBetweenInclusive(s, e);\n        for (const ds of days) {\n            if (!map.has(ds))\n                map.set(ds, []);\n            map.get(ds).push({ kind: \"VACATION\", text: label });\n        }\n    }\n    return map;\n}\nfunction buildDutyMapForDash(assigns) {\n    const map = new Map();\n    for (const a of assigns) {\n        if (!a?.date || !a?.name)\n            continue;\n        if (!map.has(a.date))\n            map.set(a.date, []);\n        map.get(a.date).push({ kind: \"DUTY\", text: a.name });\n    }\n    return map;\n}\nfunction renderDashboardCalGrid(viewingYm, holidays, dutyAssigns, vacations) {\n    const grid = document.getElementById(\"dutyCalGrid\");\n    const label = document.getElementById(\"dutyCalLabel\");\n    if (!grid || !label)\n        return;\n    label.textContent = viewingYm;\n    const [y, m] = viewingYm.split(\"-\").map(Number);\n    if (!y || !m)\n        return;\n    const first = new Date(y, m - 1, 1);\n    const lastDate = new Date(y, m, 0).getDate();\n    const startDow = first.getDay(); // 0=일\n    const holidayMap = new Map();\n    for (const h of holidays)\n        holidayMap.set(h.date, h);\n    const vacMap = buildVacationMapForDash(vacations);\n    const dutyMap = buildDutyMapForDash(dutyAssigns);\n    grid.innerHTML = \"\";\n    // 앞 빈칸\n    for (let i = 0; i < startDow; i++) {\n        const empty = document.createElement(\"div\");\n        empty.className = \"min-h-[90px] border-b border-r bg-gray-50/50\";\n        grid.appendChild(empty);\n    }\n    // 날짜 셀\n    for (let day = 1; day <= lastDate; day++) {\n        const ds = `${y}-${pad2(m)}-${pad2(day)}`;\n        const cell = document.createElement(\"div\");\n        cell.className = \"min-h-[90px] border-b border-r p-1 overflow-hidden bg-white\";\n        cell.dataset.date = ds;\n        const h = holidayMap.get(ds);\n        const dow = new Date(ds + \"T00:00:00\").getDay();\n        const isRed = (h && h.type === \"공휴일\") || dow === 0;\n        const dayEl = document.createElement(\"div\");\n        dayEl.className = `text-[11px] font-bold mb-1 ${isRed ? \"text-rose-600\" : \"text-gray-900\"}`;\n        dayEl.textContent = String(day);\n        cell.appendChild(dayEl);\n        // ✅ 휴일 뱃지(주말/공휴일)\n        if (h) {\n            const badge = document.createElement(\"div\");\n            const isHoliday = h.type === \"공휴일\";\n            badge.className =\n                \"px-1.5 py-0.5 rounded text-[10px] font-semibold mb-1 \" +\n                    (isHoliday ? \"bg-rose-50 text-rose-700\" : \"bg-gray-100 text-gray-700\");\n            badge.textContent = isHoliday\n                ? h.holidayName\n                    ? `공휴일(${h.holidayName})`\n                    : \"공휴일\"\n                : \"주말\";\n            cell.appendChild(badge);\n        }\n        // ✅ 휴가(최대 1줄 + 더보기)\n        const vacs = vacMap.get(ds) ?? [];\n        if (vacs.length) {\n            const v = vacs[0];\n            const vLine = document.createElement(\"div\");\n            vLine.className =\n                \"px-1.5 py-0.5 rounded text-[10px] font-semibold mb-1 bg-amber-50 text-amber-800 whitespace-normal break-keep\";\n            vLine.textContent = `휴가 ${v.text}`;\n            cell.appendChild(vLine);\n            if (vacs.length > 1) {\n                const more = document.createElement(\"div\");\n                more.className = \"text-[10px] text-amber-700 underline cursor-pointer select-none\";\n                more.textContent = `+${vacs.length - 1}명 더보기`;\n                more.onclick = (e) => {\n                    e.stopPropagation();\n                    alert(`[${ds}]\\n\\n휴가:\\n` + vacs.map((x) => `- ${x.text}`).join(\"\\n\"));\n                };\n                cell.appendChild(more);\n            }\n        }\n        // ✅ 당직(최대 1줄)\n        const duties = dutyMap.get(ds) ?? [];\n        if (duties.length) {\n            const d = duties[0];\n            const dLine = document.createElement(\"div\");\n            dLine.className =\n                \"px-1.5 py-0.5 rounded text-[10px] font-semibold bg-indigo-50 text-indigo-700 whitespace-normal break-keep\";\n            dLine.textContent = `당직 ${d.text}`;\n            cell.appendChild(dLine);\n        }\n        grid.appendChild(cell);\n    }\n    // 뒤 빈칸\n    const totalCells = startDow + lastDate;\n    const remain = (7 - (totalCells % 7)) % 7;\n    for (let i = 0; i < remain; i++) {\n        const empty = document.createElement(\"div\");\n        empty.className = \"min-h-[90px] border-b border-r bg-gray-50/30\";\n        grid.appendChild(empty);\n    }\n}\n// ======================\n// ✅ 당직 \"표\" 렌더 (월일 / 소속 / 근무자만)\n// ======================\nfunction renderDutyTable(assigns) {\n    const box = document.getElementById(\"dutyTableBox\");\n    if (!box)\n        return;\n    if (!assigns.length) {\n        box.innerHTML = `\n      <div class=\"text-xs text-gray-400 text-center py-6\">\n        생성된 당직 일정이 없습니다.\n      </div>\n    `;\n        return;\n    }\n    const TEAM_NAME = \"S/W팀\";\n    const rows = assigns\n        .map((a) => {\n        const mmdd = a.date.slice(5);\n        return `\n        <tr class=\"border-b last:border-b-0\">\n          <td class=\"px-3 py-2 text-center text-[12px] whitespace-nowrap\">${mmdd}</td>\n          <td class=\"px-3 py-2 text-center text-[12px] whitespace-nowrap\">${TEAM_NAME}</td>\n          <td class=\"px-3 py-2 text-center text-[12px] font-semibold whitespace-nowrap\">${a.name}</td>\n        </tr>\n      `;\n    })\n        .join(\"\");\n    box.innerHTML = `\n    <div class=\"border rounded-xl overflow-hidden bg-white\">\n      <div class=\"px-3 py-2 border-b text-sm font-bold text-gray-800\">당직근무 일정</div>\n      <div class=\"overflow-auto\">\n        <table class=\"w-full border-collapse text-[12px]\">\n          <thead class=\"bg-gray-50 text-gray-600\">\n            <tr>\n              <th class=\"border-b px-3 py-2 text-center whitespace-nowrap w-24\">월일</th>\n              <th class=\"border-b px-3 py-2 text-center whitespace-nowrap w-28\">소속</th>\n              <th class=\"border-b px-3 py-2 text-center whitespace-nowrap\">근무자</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${rows}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  `;\n}\n// ======================\n// ✅ (중요) dutyCalLabel 없으면 자동 생성 + 현재월 세팅\n// ======================\nfunction ensureDutyCalLabel() {\n    let label = document.getElementById(\"dutyCalLabel\");\n    // ✅ label이 HTML에 없으면 자동으로 만들어서 숨겨 둠\n    if (!label) {\n        label = document.createElement(\"div\");\n        label.id = \"dutyCalLabel\";\n        label.className = \"hidden\";\n        document.body.appendChild(label);\n    }\n    const txt = (label.textContent || \"\").trim();\n    if (!/^\\d{4}-\\d{2}$/.test(txt)) {\n        const now = new Date();\n        label.textContent = `${now.getFullYear()}-${pad2(now.getMonth() + 1)}`;\n    }\n}\n// ======================\n// ✅ 대시보드 \"휴일/당직 캘린더\" 표 채우기\n// ✅ (수정) 표를 채운 뒤 → 달력도 자동 갱신\n// ======================\nfunction renderDashboardHolidayDuty(holidays, assignsMap) {\n    const tbody = document.getElementById(\"dutyHolidayBody\");\n    if (!tbody)\n        return;\n    // ✅ label 없으면 만들고 현재월 세팅\n    ensureDutyCalLabel();\n    if (!holidays.length) {\n        tbody.innerHTML = `\n      <tr>\n        <td class=\"px-2 py-2 text-center text-gray-400\" colspan=\"4\">표시할 휴일이 없습니다.</td>\n      </tr>\n    `;\n        // ✅ 표 비어도 달력은 비운 상태로 렌더\n        renderDashboardDutyCalendarFromTable();\n        return;\n    }\n    tbody.innerHTML = holidays\n        .map((h) => {\n        const dutyName = assignsMap[h.date] ?? \"-\";\n        const typeLabel = h.type === \"공휴일\"\n            ? h.holidayName\n                ? `공휴일(${h.holidayName})`\n                : \"공휴일\"\n            : \"주말\";\n        return `\n        <tr>\n          <td class=\"border px-2 py-1 text-center\">${h.date.slice(5)}</td>\n          <td class=\"border px-2 py-1 text-center\">${h.dow}</td>\n          <td class=\"border px-2 py-1 text-center\">${typeLabel}</td>\n          <td class=\"border px-2 py-1 text-center font-semibold\">${dutyName}</td>\n        </tr>\n      `;\n    })\n        .join(\"\");\n    // ✅✅✅ 핵심: 표 채운 직후 달력도 갱신\n    renderDashboardDutyCalendarFromTable();\n}\n// ======================\n// ✅ 대시보드 \"휴일/당직 캘린더\" 달력 렌더 (표(dutyHolidayBody) → grid(dutyCalGrid))\n// ✅ (수정) dutyCalLabel이 없어도 ensureDutyCalLabel로 자동 처리\n// ======================\nfunction renderDashboardDutyCalendarFromTable() {\n    const grid = document.getElementById(\"dutyCalGrid\");\n    const tbody = document.getElementById(\"dutyHolidayBody\");\n    if (!grid || !tbody)\n        return;\n    ensureDutyCalLabel();\n    const label = document.getElementById(\"dutyCalLabel\");\n    if (!label)\n        return;\n    const ymTxt = (label.textContent || \"\").trim(); // \"YYYY-MM\"\n    const m = ymTxt.match(/^(\\d{4})-(\\d{2})$/);\n    if (!m)\n        return;\n    const y = Number(m[1]);\n    const mo = Number(m[2]); // 1~12\n    const first = new Date(y, mo - 1, 1);\n    const lastDay = new Date(y, mo, 0).getDate();\n    const startDow = first.getDay(); // 0=일\n    // 표에서 이벤트 읽기: key=\"YYYY-MM-DD\" -> { typeTxt, dutyTxt }\n    const eventMap = new Map();\n    const rows = Array.from(tbody.querySelectorAll(\"tr\"));\n    for (const tr of rows) {\n        const tds = Array.from(tr.querySelectorAll(\"td\"));\n        if (tds.length < 4)\n            continue;\n        const mmdd = (tds[0].textContent || \"\").trim(); // \"01-03\"\n        const typeTxt = (tds[2].textContent || \"\").trim(); // \"주말\" / \"공휴일(...)\"\n        const dutyTxt = (tds[3].textContent || \"\").trim(); // \"홍길동\" or \"-\"\n        const md = mmdd.match(/^(\\d{2})-(\\d{2})$/);\n        if (!md)\n            continue;\n        const key = `${y}-${md[1]}-${md[2]}`;\n        if (!eventMap.has(key))\n            eventMap.set(key, []);\n        eventMap.get(key).push({ typeTxt, dutyTxt });\n    }\n    grid.innerHTML = \"\";\n    // 앞 빈칸\n    for (let i = 0; i < startDow; i++) {\n        const empty = document.createElement(\"div\");\n        empty.className = \"min-h-[90px] border-b border-r bg-gray-50/50\";\n        grid.appendChild(empty);\n    }\n    // 날짜\n    for (let d = 1; d <= lastDay; d++) {\n        const dd = String(d).padStart(2, \"0\");\n        const mm = String(mo).padStart(2, \"0\");\n        const key = `${y}-${mm}-${dd}`;\n        const cell = document.createElement(\"div\");\n        cell.className = \"min-h-[90px] border-b border-r p-1 overflow-hidden bg-white\";\n        cell.dataset.date = key;\n        const dow = new Date(key + \"T00:00:00\").getDay();\n        const isSun = dow === 0;\n        const dayEl = document.createElement(\"div\");\n        dayEl.className = `text-[11px] font-bold mb-1 ${isSun ? \"text-rose-600\" : \"text-gray-900\"}`;\n        dayEl.textContent = String(d);\n        cell.appendChild(dayEl);\n        const items = eventMap.get(key) || [];\n        for (const it of items) {\n            const isHoliday = it.typeTxt.includes(\"공휴일\");\n            const badge = document.createElement(\"div\");\n            badge.className =\n                \"px-1.5 py-0.5 rounded text-[10px] font-semibold mb-1 \" +\n                    (isHoliday ? \"bg-rose-50 text-rose-700\" : \"bg-gray-100 text-gray-700\");\n            badge.textContent = it.typeTxt;\n            cell.appendChild(badge);\n            if (it.dutyTxt && it.dutyTxt !== \"-\") {\n                const duty = document.createElement(\"div\");\n                duty.className = \"px-1.5 py-0.5 rounded text-[10px] font-semibold bg-indigo-50 text-indigo-700\";\n                duty.textContent = `당직 ${it.dutyTxt}`;\n                cell.appendChild(duty);\n            }\n        }\n        grid.appendChild(cell);\n    }\n    // 뒤 빈칸(7배수 맞춤)\n    const totalCells = startDow + lastDay;\n    const remain = (7 - (totalCells % 7)) % 7;\n    for (let i = 0; i < remain; i++) {\n        const empty = document.createElement(\"div\");\n        empty.className = \"min-h-[90px] border-b border-r bg-gray-50/30\";\n        grid.appendChild(empty);\n    }\n}\n// ======================\n// 메인 진입 함수\n// ======================\nexport function initBusinessMasterPanel(API_BASE) {\n    console.log(\"[출장업무관리] initBusinessMasterPanel 시작\");\n    // DOM 수집\n    const panel = document.getElementById(\"panel-출장업무-관리\");\n    const distanceTbodyEl = document.getElementById(\"distanceTbody\");\n    // ✅✅✅ 유류/환율 통합 저장 버튼(신규)\n    const btnFuelFxSave = document.getElementById(\"btnFuelFxSave\");\n    const btnNoticeUpload = document.getElementById(\"btnNoticeUpload\");\n    const noticeUploadMsg = document.getElementById(\"noticeUploadMsg\");\n    const btnDistanceAddRow = document.getElementById(\"btnDistanceAddRow\");\n    const btnDistanceSave = document.getElementById(\"btnDistanceSave\");\n    const inputFuelGasoline = document.getElementById(\"cfgFuelGasoline\");\n    const inputFuelDiesel = document.getElementById(\"cfgFuelDiesel\");\n    const inputFuelGas = document.getElementById(\"cfgFuelGas\");\n    const inputUsd = document.getElementById(\"cfgUsd\");\n    const inputJpy = document.getElementById(\"cfgJpy\");\n    const inputCny = document.getElementById(\"cfgCny\");\n    const textareaNotice = document.getElementById(\"cfgNotice\");\n    const dutyTbody = document.getElementById(\"dutyTbody\");\n    const btnDutyGenerateThisMonth = document.getElementById(\"btnDutyGenerateThisMonth\") ||\n        document.getElementById(\"btnDutyGenThisMonth\");\n    const dutyResultBox = document.getElementById(\"dutyResultBox\");\n    // ✅ 휴가자 설정 DOM\n    const vacUserSelect = document.getElementById(\"vacUserSelect\");\n    const vacTypeSelect = document.getElementById(\"vacTypeSelect\");\n    const vacFrom = document.getElementById(\"vacFrom\");\n    const vacTo = document.getElementById(\"vacTo\");\n    const vacNote = document.getElementById(\"vacNote\");\n    const btnVacAdd = document.getElementById(\"btnVacAdd\");\n    const vacationAdminTbody = document.getElementById(\"vacationAdminTbody\");\n    const vacAdminMsg = document.getElementById(\"vacAdminMsg\");\n    // ✅ 요약 캘린더 DOM\n    const sumCalGrid = document.getElementById(\"sumCalGrid\");\n    const sumCalLabel = document.getElementById(\"sumCalLabel\");\n    const sumCalPrev = document.getElementById(\"sumCalPrev\");\n    const sumCalNext = document.getElementById(\"sumCalNext\");\n    // ✅✅✅ 일정 추가 DOM (캘린더 아래)\n    const calTodoDate = document.getElementById(\"calTodoDate\");\n    const calTodoText = document.getElementById(\"calTodoText\");\n    const btnCalTodoAdd = document.getElementById(\"btnCalTodoAdd\");\n    const calTodoMsg = document.getElementById(\"calTodoMsg\");\n    // ✅ 당직 후보 추가 UI\n    const dutyAddSelect = document.getElementById(\"dutyAddSelect\");\n    const btnDutyAddUser = document.getElementById(\"btnDutyAddUser\");\n    function setVacMsg(msg) {\n        if (vacAdminMsg)\n            vacAdminMsg.textContent = msg;\n    }\n    function setTodoMsg(msg) {\n        if (calTodoMsg)\n            calTodoMsg.textContent = msg;\n    }\n    function setNoticeMsg(msg) {\n        if (noticeUploadMsg)\n            noticeUploadMsg.textContent = msg;\n    }\n    if (!panel || !distanceTbodyEl) {\n        console.warn(\"[출장업무관리] 필수 DOM(panel-출장업무-관리, distanceTbody) 없음\");\n        return;\n    }\n    if (panel._bound) {\n        console.debug(\"[출장업무관리] 이미 초기화됨, 재바인딩 안함\");\n        return;\n    }\n    panel._bound = true;\n    const distanceTbody = distanceTbodyEl;\n    // ✅✅✅ 통합 저장 핸들러 (유류/환율/공지/당직 등 saveConfig에 들어있는 값 저장)\n    const onSave = async () => {\n        await saveConfig(); // ✅ 기존 설정 저장 함수 그대로 사용\n        window.dispatchEvent(new CustomEvent(\"business-config-changed\"));\n    };\n    let distanceRows = [];\n    let deletedIds = [];\n    // =====================================================\n    // ✅ 당직 후보/순번/마지막생성 저장 상태\n    // =====================================================\n    let dutyMembers = [];\n    let dutyStartIndex = 0;\n    // ✅ 사용자관리 전체 목록(삭제해도 남아있어서 다시 추가 가능)\n    let allUsers = [];\n    // ✅ F5 복원을 위해 \"마지막 생성 결과\"도 저장해둠\n    let dutyLastYm = \"\"; // \"2026-01\"\n    let dutyLastAssigns = [];\n    // =====================================================\n    // ✅ 요약 캘린더 상태\n    // =====================================================\n    let sumYear = new Date().getFullYear();\n    let sumMonth = new Date().getMonth(); // 0~11\n    let cachedVacations = [];\n    let cachedHolidays = [];\n    let cachedDutyPreviewYm = \"\";\n    let cachedDutyPreviewAssigns = [];\n    // ✅✅✅ 일정 캐시(현재 달)\n    let cachedCalendarEvents = [];\n    async function fetchVacationsAll() {\n        try {\n            const res = await fetch(`${API_BASE}/api/business-master/vacations`, { credentials: \"include\" });\n            const json = await res.json().catch(() => null);\n            if (!res.ok || json?.ok !== true)\n                return [];\n            return Array.isArray(json.items) ? json.items : [];\n        }\n        catch {\n            return [];\n        }\n    }\n    // ✅✅✅ 일정(현재 월) 가져오기\n    async function fetchCalendarEvents(ymStr) {\n        try {\n            const res = await fetch(`${API_BASE}/api/business-master/calendar-events?ym=${ymStr}`, {\n                credentials: \"include\",\n            });\n            const json = await res.json().catch(() => null);\n            if (!res.ok || json?.ok !== true)\n                return [];\n            return Array.isArray(json.items) ? json.items : [];\n        }\n        catch {\n            return [];\n        }\n    }\n    // ✅✅✅ 일정 추가(등록 버튼)\n    async function addCalendarTodo() {\n        if (!calTodoDate || !calTodoText)\n            return;\n        const date = String(calTodoDate.value || \"\");\n        const title = String(calTodoText.value || \"\").trim();\n        if (!date)\n            return setTodoMsg(\"날짜를 선택하세요.\");\n        if (!title)\n            return setTodoMsg(\"내용을 입력하세요.\");\n        setTodoMsg(\"등록 중...\");\n        try {\n            const res = await fetch(`${API_BASE}/api/business-master/calendar-events`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                credentials: \"include\",\n                body: JSON.stringify({ date, title }),\n            });\n            const json = await res.json().catch(() => null);\n            if (!res.ok || json?.ok !== true) {\n                setTodoMsg(json?.error || \"등록 실패\");\n                return;\n            }\n            // 입력 초기화\n            calTodoText.value = \"\";\n            setTodoMsg(\"등록 완료\");\n            // 현재 보고있는 달 다시 로드 → 캘린더 갱신\n            const base = new Date(sumYear, sumMonth, 1);\n            const viewingYm = ym(base);\n            cachedCalendarEvents = await fetchCalendarEvents(viewingYm);\n            renderSummaryCalendar();\n        }\n        catch (e) {\n            console.error(\"[calendar-events][add] err:\", e);\n            setTodoMsg(\"등록 중 오류\");\n        }\n    }\n    // ✅✅✅ 일정 삭제\n    async function deleteCalendarTodo(id) {\n        if (!Number.isFinite(id) || id <= 0)\n            return;\n        const ok = confirm(\"이 일정을 삭제할까요?\");\n        if (!ok)\n            return;\n        try {\n            const res = await fetch(`${API_BASE}/api/business-master/calendar-events/${id}`, {\n                method: \"DELETE\",\n                credentials: \"include\",\n            });\n            const json = await res.json().catch(() => null);\n            if (!res.ok || json?.ok !== true) {\n                setTodoMsg(json?.error || \"삭제 실패\");\n                return;\n            }\n            setTodoMsg(\"삭제 완료\");\n            // ✅ 현재 보고있는 달 다시 로드 → 캘린더 갱신\n            const base = new Date(sumYear, sumMonth, 1);\n            const viewingYm = ym(base);\n            cachedCalendarEvents = await fetchCalendarEvents(viewingYm);\n            renderSummaryCalendar();\n        }\n        catch (e) {\n            console.error(\"[calendar-events][delete] err:\", e);\n            setTodoMsg(\"삭제 중 오류\");\n        }\n    }\n    // =====================================================\n    // ✅ 공휴일 API + 주말 합쳐서 “휴일 리스트”\n    // =====================================================\n    async function fetchHolidayItemsForMonth(base) {\n        const year = String(base.getFullYear());\n        const month = pad2(base.getMonth() + 1);\n        const days = getAllDaysOfMonth(base);\n        const weekend = days\n            .map((d) => ymd(d))\n            .filter((ds) => isWeekend(ds))\n            .map((ds) => ({\n            date: ds,\n            dow: getDowKr(ds),\n            type: \"주말\",\n        }));\n        let apiHolidays = [];\n        try {\n            const res = await fetch(`${API_BASE}/api/business-master/holidays?year=${year}&month=${month}`, {\n                credentials: \"include\",\n            });\n            const json = await res.json().catch(() => null);\n            if (res.ok && json?.ok === true) {\n                const list = Array.isArray(json.holidays) ? json.holidays : [];\n                apiHolidays = list\n                    .filter((h) => h && h.date)\n                    .map((h) => {\n                    const ds = parseLocdateToYmd(String(h.date));\n                    if (!ds)\n                        return null;\n                    return {\n                        date: ds,\n                        dow: getDowKr(ds),\n                        type: \"공휴일\",\n                        holidayName: String(h.name ?? \"\").trim() || undefined,\n                    };\n                })\n                    .filter(Boolean);\n            }\n        }\n        catch (e) {\n            console.warn(\"[휴일] 공휴일 API 실패(주말만으로 진행):\", e);\n        }\n        const map = new Map();\n        weekend.forEach((w) => map.set(w.date, w));\n        apiHolidays.forEach((h) => map.set(h.date, h));\n        return Array.from(map.values()).sort((a, b) => a.date.localeCompare(b.date));\n    }\n    async function uploadNoticeOnly() {\n        const notice = String(textareaNotice?.value ?? \"\").trim();\n        setNoticeMsg(\"업로드 중...\");\n        try {\n            const res = await fetch(`${API_BASE}/api/business-master/notice`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                credentials: \"include\",\n                body: JSON.stringify({ notice }),\n            });\n            const json = await res.json().catch(() => null);\n            if (!res.ok || json?.ok !== true) {\n                const msg = String(json?.error || \"공지 업로드 실패\");\n                setNoticeMsg(msg);\n                alert(msg);\n                return;\n            }\n            const savedNotice = String(json.notice ?? notice);\n            // ✅ 화면 메시지\n            setNoticeMsg(\"✅ 공지 업로드 완료\");\n            // ✅✅✅ 완료 모달(초보용: alert이 가장 확실)\n            alert(\"공지 올리기 완료!\");\n            // ✅✅✅ 대시보드 즉시 갱신(너 대시보드가 듣는 이벤트로 통일)\n            // 공지/유류/환율 갱신\n            window.dispatchEvent(new CustomEvent(\"business-config-changed\"));\n            // (옵션) 혹시 다른 곳에서 notice-changed 쓰고 있으면 같이 쏴도 됨\n            window.dispatchEvent(new CustomEvent(\"notice-changed\", { detail: { notice: savedNotice } }));\n        }\n        catch (e) {\n            console.error(\"[notice][upload] err:\", e);\n            setNoticeMsg(\"업로드 중 오류\");\n            alert(\"업로드 중 오류\");\n        }\n    }\n    // ==========================\n    // ✅ 요약 캘린더 렌더 (교체본)\n    // ==========================\n    function renderSummaryCalendar() {\n        if (!sumCalGrid || !sumCalLabel)\n            return;\n        const base = new Date(sumYear, sumMonth, 1);\n        const y = base.getFullYear();\n        const m = base.getMonth();\n        const viewingYm = `${y}-${pad2(m + 1)}`;\n        sumCalLabel.textContent = viewingYm;\n        sumCalGrid.innerHTML = \"\";\n        const first = new Date(y, m, 1);\n        const lastDate = new Date(y, m + 1, 0).getDate();\n        const startWeekday = first.getDay(); // 0(일)~6(토)\n        const vacMap = buildVacationEvents(cachedVacations);\n        // ✅ 당직: 현재 보고있는 월 프리뷰(assigns)로 표시\n        let dutyMap = new Map();\n        if (cachedDutyPreviewYm === viewingYm && Array.isArray(cachedDutyPreviewAssigns)) {\n            dutyMap = buildDutyEvents(cachedDutyPreviewAssigns);\n        }\n        // ✅ 일정: 현재 달 캐시로 표시\n        const schMap = buildScheduleEvents(cachedCalendarEvents);\n        const holidayMap = new Map();\n        for (const h of cachedHolidays)\n            holidayMap.set(h.date, h);\n        // ✅ 표시 제한\n        const MAX_VAC_LINES = 1;\n        const MAX_DUTY_LINES = 1;\n        const MAX_SCH_LINES = 1;\n        // --------------------------\n        // 모달 열기 (휴가/당직/일정 상세)\n        // --------------------------\n        function openDayDetail(dateStr, vacs, duties, schs) {\n            const modal = document.getElementById(\"sumCalModal\");\n            const title = document.getElementById(\"sumCalModalTitle\");\n            const body = document.getElementById(\"sumCalModalBody\");\n            const btnClose = document.getElementById(\"sumCalModalClose\");\n            const btnOk = document.getElementById(\"sumCalModalOk\");\n            // ✅ 모달 DOM 없으면 alert fallback\n            if (!modal || !title || !body) {\n                const lines = [];\n                lines.push(`[${dateStr}]`);\n                if (vacs.length) {\n                    lines.push(\"\");\n                    lines.push(`휴가 (${vacs.length})`);\n                    for (const v of vacs)\n                        lines.push(`- ${v.text}`);\n                }\n                if (duties.length) {\n                    lines.push(\"\");\n                    lines.push(`당직 (${duties.length})`);\n                    for (const d of duties)\n                        lines.push(`- ${d.text}`);\n                }\n                if (schs.length) {\n                    lines.push(\"\");\n                    lines.push(`일정 (${schs.length})`);\n                    for (const s of schs)\n                        lines.push(`- ${s.text}`);\n                }\n                alert(lines.join(\"\\n\"));\n                return;\n            }\n            title.textContent = `${dateStr} 상세`;\n            const vacHtml = vacs.length\n                ? `\n          <div class=\"border rounded-xl overflow-hidden\">\n            <div class=\"px-3 py-2 bg-amber-50 text-amber-800 font-bold text-xs border-b\">휴가 (${vacs.length})</div>\n            <div class=\"p-3 space-y-2\">\n              ${vacs\n                    .map((v) => `\n                  <div class=\"px-2 py-1 rounded-lg bg-amber-50 text-amber-800 text-xs\">\n                    휴가 ${escapeHtml(v.text)}\n                  </div>\n                `)\n                    .join(\"\")}\n            </div>\n          </div>\n        `\n                : \"\";\n            const dutyHtml = duties.length\n                ? `\n          <div class=\"border rounded-xl overflow-hidden\">\n            <div class=\"px-3 py-2 bg-indigo-50 text-indigo-800 font-bold text-xs border-b\">당직 (${duties.length})</div>\n            <div class=\"p-3 space-y-2\">\n              ${duties\n                    .map((d) => `\n                  <div class=\"px-2 py-1 rounded-lg bg-indigo-50 text-indigo-800 text-xs\">\n                    당직 ${escapeHtml(d.text)}\n                  </div>\n                `)\n                    .join(\"\")}\n            </div>\n          </div>\n        `\n                : \"\";\n            // ✅✅✅ 일정: 삭제 버튼 포함 (id 있을 때만)\n            const schHtml = schs.length\n                ? `\n          <div class=\"border rounded-xl overflow-hidden\">\n            <div class=\"px-3 py-2 bg-slate-50 text-slate-800 font-bold text-xs border-b\">일정 (${schs.length})</div>\n            <div class=\"p-3 space-y-2\">\n              ${schs\n                    .map((s) => {\n                    const idAttr = Number.isFinite(Number(s.id)) ? `data-id=\"${Number(s.id)}\"` : \"\";\n                    const btn = idAttr\n                        ? `<button type=\"button\" ${idAttr}\n                           class=\"sumcal-sch-del ml-2 px-2 py-0.5 rounded-lg bg-red-100 text-red-700 text-[11px] hover:bg-red-200\">\n                           삭제\n                         </button>`\n                        : \"\";\n                    return `\n                    <div class=\"flex items-center justify-between gap-2 px-2 py-1 rounded-lg bg-slate-50 text-slate-800 text-xs\">\n                      <div class=\"min-w-0 whitespace-normal break-keep\">일정 ${escapeHtml(s.text)}</div>\n                      <div class=\"shrink-0\">${btn}</div>\n                    </div>\n                  `;\n                })\n                    .join(\"\")}\n            </div>\n          </div>\n        `\n                : \"\";\n            body.innerHTML =\n                (vacHtml || dutyHtml || schHtml)\n                    ? `<div class=\"space-y-3\">${vacHtml}${dutyHtml}${schHtml}</div>`\n                    : `<div class=\"text-xs text-gray-500 text-center py-6\">표시할 내용이 없습니다.</div>`;\n            // ✅✅✅ 모달 안 \"일정 삭제\" 이벤트(위임)\n            body.onclick = (e) => {\n                const t = e.target;\n                if (!t)\n                    return;\n                if (t.classList.contains(\"sumcal-sch-del\")) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    const id = Number(t.dataset.id);\n                    if (Number.isFinite(id) && id > 0) {\n                        deleteCalendarTodo(id); // ✅ 위에 정의된 함수 호출\n                    }\n                }\n            };\n            const close = () => modal.classList.add(\"hidden\");\n            if (btnClose)\n                btnClose.onclick = close;\n            if (btnOk)\n                btnOk.onclick = close;\n            modal.onclick = (e) => {\n                const t = e.target;\n                if (!t)\n                    return;\n                if (t === modal)\n                    close();\n                // 오버레이를 class로 닫고 싶으면(네 HTML에 맞춰 유지)\n                if (t.classList && t.classList.contains(\"bg-black/40\"))\n                    close();\n            };\n            modal.classList.remove(\"hidden\");\n        }\n        // --------------------------\n        // 셀 내부 라인\n        // --------------------------\n        function makeLine(kind, text) {\n            const div = document.createElement(\"div\");\n            if (kind === \"VACATION\") {\n                div.className =\n                    \"px-1.5 py-0.5 rounded bg-amber-50 text-amber-800 text-[10px] leading-tight whitespace-normal break-keep\";\n                div.textContent = \"휴가 \" + text;\n            }\n            else if (kind === \"DUTY\") {\n                div.className =\n                    \"px-1.5 py-0.5 rounded bg-indigo-50 text-indigo-800 text-[10px] leading-tight whitespace-normal break-keep\";\n                div.textContent = \"당직 \" + text;\n            }\n            else {\n                div.className =\n                    \"px-1.5 py-0.5 rounded bg-slate-50 text-slate-800 text-[10px] leading-tight whitespace-normal break-keep\";\n                div.textContent = \"일정 \" + text;\n            }\n            return div;\n        }\n        // --------------------------\n        // ✅ 더보기 (makeMore)\n        // --------------------------\n        function makeMore(kind, moreCount, onClick) {\n            const div = document.createElement(\"div\");\n            if (kind === \"VACATION\")\n                div.className = \"text-[10px] text-amber-700 underline cursor-pointer select-none\";\n            else if (kind === \"DUTY\")\n                div.className = \"text-[10px] text-indigo-700 underline cursor-pointer select-none\";\n            else\n                div.className = \"text-[10px] text-slate-700 underline cursor-pointer select-none\";\n            div.textContent = `+${moreCount}건 더보기`;\n            div.addEventListener(\"click\", (e) => {\n                e.stopPropagation();\n                onClick();\n            });\n            return div;\n        }\n        // ✅ 앞 빈칸\n        for (let i = 0; i < startWeekday; i++) {\n            const cell = document.createElement(\"div\");\n            cell.className = \"min-h-[90px] border-r border-b bg-gray-50/60\";\n            sumCalGrid.appendChild(cell);\n        }\n        // ✅ 날짜 셀\n        for (let day = 1; day <= lastDate; day++) {\n            const ds = `${y}-${pad2(m + 1)}-${pad2(day)}`;\n            const vacs = vacMap.get(ds) ?? [];\n            const duties = dutyMap.get(ds) ?? [];\n            const schs = schMap.get(ds) ?? [];\n            const cell = document.createElement(\"div\");\n            cell.className = \"min-h-[90px] border-r border-b p-1 overflow-hidden bg-white\";\n            cell.dataset.date = ds;\n            const h = holidayMap.get(ds);\n            const dow = new Date(ds + \"T00:00:00\").getDay();\n            const isRed = (h && h.type === \"공휴일\") || dow === 0;\n            const dateDiv = document.createElement(\"div\");\n            dateDiv.className = `text-[11px] font-bold mb-1 ${isRed ? \"text-rose-600\" : \"\"}`;\n            dateDiv.textContent = String(day);\n            const evBox = document.createElement(\"div\");\n            evBox.className = \"flex flex-col gap-1\";\n            if (vacs.length) {\n                const show = vacs.slice(0, MAX_VAC_LINES);\n                for (const v of show)\n                    evBox.appendChild(makeLine(\"VACATION\", v.text));\n                if (vacs.length > MAX_VAC_LINES) {\n                    evBox.appendChild(makeMore(\"VACATION\", vacs.length - MAX_VAC_LINES, () => openDayDetail(ds, vacs, duties, schs)));\n                }\n            }\n            if (duties.length) {\n                const show = duties.slice(0, MAX_DUTY_LINES);\n                for (const d of show)\n                    evBox.appendChild(makeLine(\"DUTY\", d.text));\n                if (duties.length > MAX_DUTY_LINES) {\n                    evBox.appendChild(makeMore(\"DUTY\", duties.length - MAX_DUTY_LINES, () => openDayDetail(ds, vacs, duties, schs)));\n                }\n            }\n            if (schs.length) {\n                const show = schs.slice(0, MAX_SCH_LINES);\n                for (const s of show)\n                    evBox.appendChild(makeLine(\"SCHEDULE\", s.text));\n                if (schs.length > MAX_SCH_LINES) {\n                    evBox.appendChild(makeMore(\"SCHEDULE\", schs.length - MAX_SCH_LINES, () => openDayDetail(ds, vacs, duties, schs)));\n                }\n            }\n            // ✅ 셀 클릭: 하나라도 있으면 상세\n            cell.addEventListener(\"click\", () => {\n                if (!vacs.length && !duties.length && !schs.length)\n                    return;\n                openDayDetail(ds, vacs, duties, schs);\n            });\n            cell.appendChild(dateDiv);\n            cell.appendChild(evBox);\n            sumCalGrid.appendChild(cell);\n        }\n        // ✅ 뒤 빈칸\n        const totalCells = startWeekday + lastDate;\n        const remain = (7 - (totalCells % 7)) % 7;\n        for (let i = 0; i < remain; i++) {\n            const cell = document.createElement(\"div\");\n            cell.className = \"min-h-[90px] border-r border-b bg-gray-50/30\";\n            sumCalGrid.appendChild(cell);\n        }\n    }\n    // ✅ 요약 캘린더 리프레시(휴가 + 휴일 + 당직 로테이션 프리뷰 + ✅ 일정)\n    async function refreshSummaryCalendar() {\n        if (!sumCalGrid || !sumCalLabel)\n            return;\n        const base = new Date(sumYear, sumMonth, 1);\n        const viewingYm = ym(base);\n        cachedVacations = await fetchVacationsAll();\n        cachedHolidays = await fetchHolidayItemsForMonth(base);\n        // ✅✅✅ 일정도 월 기준으로 로드\n        cachedCalendarEvents = await fetchCalendarEvents(viewingYm);\n        cachedDutyPreviewYm = viewingYm;\n        cachedDutyPreviewAssigns = [];\n        if (!dutyMembers.length || !cachedHolidays.length) {\n            renderSummaryCalendar();\n            return;\n        }\n        if (!/^\\d{4}-\\d{2}$/.test(dutyLastYm))\n            dutyLastYm = viewingYm;\n        const len = dutyMembers.length;\n        async function getHolidayCount(ymStr) {\n            const [yy, mm] = ymStr.split(\"-\").map(Number);\n            const monthBase = new Date(yy, mm - 1, 1);\n            const items = await fetchHolidayItemsForMonth(monthBase);\n            return items.length;\n        }\n        let startIdx = 0;\n        if (compareYm(viewingYm, dutyLastYm) === 0 && dutyLastAssigns.length) {\n            cachedDutyPreviewAssigns = dutyLastAssigns;\n            renderSummaryCalendar();\n            return;\n        }\n        if (compareYm(viewingYm, dutyLastYm) > 0) {\n            let idx = mod(dutyStartIndex, len);\n            for (let cur = addMonthsToYm(dutyLastYm, 1); compareYm(cur, viewingYm) < 0; cur = addMonthsToYm(cur, 1)) {\n                const cnt = await getHolidayCount(cur);\n                idx = mod(idx + cnt, len);\n            }\n            startIdx = idx;\n        }\n        else {\n            let idxAfter = mod(dutyStartIndex, len);\n            for (let cur = dutyLastYm; compareYm(cur, addMonthsToYm(viewingYm, 1)) >= 0; cur = addMonthsToYm(cur, -1)) {\n                const cnt = await getHolidayCount(cur);\n                idxAfter = mod(idxAfter - cnt, len);\n                if (compareYm(cur, addMonthsToYm(viewingYm, 1)) === 0)\n                    break;\n            }\n            const viewingCnt = cachedHolidays.length;\n            startIdx = mod(idxAfter - viewingCnt, len);\n        }\n        const assigns = [];\n        let idx = startIdx;\n        for (const h of cachedHolidays) {\n            const name = dutyMembers[idx]?.name;\n            if (name)\n                assigns.push({ date: h.date, name });\n            idx = (idx + 1) % len;\n        }\n        cachedDutyPreviewAssigns = assigns;\n        renderSummaryCalendar();\n    }\n    // =====================================================\n    // ✅ 당직 후보 추가 select 채우기(전체 사용자 - 현재 후보)\n    // =====================================================\n    function fillDutyAddSelect() {\n        if (!dutyAddSelect)\n            return;\n        const exists = new Set(dutyMembers.map((m) => m.no));\n        const candidates = allUsers.filter((u) => !exists.has(u.no));\n        dutyAddSelect.innerHTML =\n            `<option value=\"\">추가할 사용자 선택</option>` +\n                candidates.map((u) => `<option value=\"${u.no}\">${escapeHtml(u.name)}</option>`).join(\"\");\n    }\n    // =====================================================\n    // ✅ 당직 후보 표 렌더\n    // =====================================================\n    function renderDutyMembers() {\n        if (!dutyTbody)\n            return;\n        if (!dutyMembers.length) {\n            dutyTbody.innerHTML = `\n        <tr>\n          <td colspan=\"3\" class=\"border px-2 py-2 text-center text-gray-400\">\n            후보 인원이 없습니다. (사용자관리에 먼저 등록하세요)\n          </td>\n        </tr>\n      `;\n            // ✅ 후보가 없어도 select는 갱신\n            fillDutyAddSelect();\n            return;\n        }\n        dutyTbody.innerHTML = \"\";\n        dutyMembers.forEach((m, idx) => {\n            const tr = document.createElement(\"tr\");\n            tr.dataset.idx = String(idx);\n            tr.innerHTML = `\n        <td class=\"border-b px-2 py-2 text-center text-[11px]\">${idx + 1}</td>\n        <td class=\"border-b px-2 py-2 text-xs\">${m.name}</td>\n        <td class=\"border-b px-2 py-2 text-center\">\n          <button type=\"button\"\n            class=\"px-2 py-1 text-[11px] rounded-lg bg-red-100 text-red-700 hover:bg-red-200 btn-duty-delete\">\n            삭제\n          </button>\n        </td>\n      `;\n            dutyTbody.appendChild(tr);\n        });\n        // ✅ 렌더 후 select 갱신\n        fillDutyAddSelect();\n    }\n    async function loadDutyMembersFromUsers() {\n        if (!dutyTbody)\n            return;\n        dutyTbody.innerHTML = `\n      <tr>\n        <td colspan=\"3\" class=\"border px-2 py-2 text-center text-gray-400\">\n          사용자 목록 로딩 중...\n        </td>\n      </tr>\n    `;\n        try {\n            const res = await fetch(`${API_BASE}/api/users`, { credentials: \"include\" });\n            if (!res.ok) {\n                dutyTbody.innerHTML = `\n          <tr>\n            <td colspan=\"3\" class=\"border px-2 py-2 text-center text-red-500\">\n              사용자 목록 조회 실패 (status ${res.status})\n            </td>\n          </tr>\n        `;\n                return;\n            }\n            const rows = await res.json();\n            // ✅ 전체 사용자 목록(복구용)\n            allUsers = Array.isArray(rows)\n                ? rows\n                    .map((u) => ({\n                    no: Number(u.no ?? 0),\n                    name: String(u.name ?? u.Name ?? \"\").trim(),\n                }))\n                    .filter((u) => u.no > 0 && u.name)\n                    .sort((a, b) => a.no - b.no)\n                : [];\n            // ✅ 기존 기능 유지: 처음엔 전체 사용자를 당직 후보로 세팅\n            dutyMembers = allUsers.map((u) => ({ no: u.no, name: u.name }));\n            if (dutyMembers.length === 0)\n                dutyStartIndex = 0;\n            else\n                dutyStartIndex = dutyStartIndex % dutyMembers.length;\n            renderDutyMembers();\n            refreshSummaryCalendar();\n        }\n        catch (err) {\n            console.error(\"[출장업무관리] 사용자 목록 로딩 오류:\", err);\n            dutyTbody.innerHTML = `\n        <tr>\n          <td colspan=\"3\" class=\"border px-2 py-2 text-center text-red-500\">\n            사용자 목록 로딩 중 오류\n          </td>\n        </tr>\n      `;\n        }\n    }\n    // =====================================================\n    // ✅ 휴가자: 사용자 옵션 로딩\n    // =====================================================\n    async function loadVacUserOptions() {\n        if (!vacUserSelect)\n            return;\n        try {\n            const res = await fetch(`${API_BASE}/api/users`, { credentials: \"include\" });\n            const rows = await res.json().catch(() => []);\n            const list = Array.isArray(rows) ? rows : [];\n            const users = list\n                .map((u) => ({\n                no: Number(u.no ?? u.No ?? 0),\n                name: String(u.name ?? u.Name ?? \"\").trim(),\n            }))\n                .filter((u) => u.no > 0 && u.name)\n                .sort((a, b) => a.no - b.no);\n            vacUserSelect.innerHTML =\n                `<option value=\"\">선택</option>` +\n                    users\n                        .map((u) => `<option value=\"${u.no}\" data-name=\"${escapeHtml(u.name)}\">${escapeHtml(u.name)}</option>`)\n                        .join(\"\");\n        }\n        catch (e) {\n            console.error(\"[vac] load users err:\", e);\n            setVacMsg(\"사용자 목록 로딩 실패\");\n        }\n    }\n    // =====================================================\n    // ✅ 휴가자: 목록 렌더/로드\n    // =====================================================\n    async function loadVacationList() {\n        if (!vacationAdminTbody)\n            return;\n        vacationAdminTbody.innerHTML = `\n    <tr><td colspan=\"6\" class=\"border-b px-2 py-3 text-center text-gray-400\">로딩 중...</td></tr>\n  `;\n        try {\n            const res = await fetch(`${API_BASE}/api/business-master/vacations`, { credentials: \"include\" });\n            const json = await res.json().catch(() => null);\n            if (!res.ok || json?.ok !== true) {\n                vacationAdminTbody.innerHTML = `\n        <tr><td colspan=\"6\" class=\"border-b px-2 py-3 text-center text-red-500\">휴가 목록 조회 실패</td></tr>\n      `;\n                return;\n            }\n            const items = Array.isArray(json.items) ? json.items : [];\n            if (!items.length) {\n                vacationAdminTbody.innerHTML = `\n        <tr><td colspan=\"6\" class=\"border-b px-2 py-3 text-center text-gray-400\">등록된 휴가가 없습니다.</td></tr>\n      `;\n                return;\n            }\n            vacationAdminTbody.innerHTML = items\n                .map((it, idx) => {\n                const s = ymdText(it.start_date);\n                const e = ymdText(it.end_date);\n                const range = s && e && s === e ? s : `${s} ~ ${e}`;\n                const noteText = String(it.note ?? \"\").trim();\n                return `\n          <tr class=\"hover:bg-gray-50\">\n            <td class=\"border-b px-2 py-2 text-center\">${idx + 1}</td>\n            <td class=\"border-b px-2 py-2 text-center\">${escapeHtml(it.user_name)}</td>\n            <td class=\"border-b px-2 py-2 text-center\">${vacTypeLabel(it.vac_type)}</td>\n            <td class=\"border-b px-2 py-2 text-center\">${escapeHtml(range)}</td>\n\n            <td class=\"border-b px-2 py-2 text-center whitespace-nowrap\">\n              ${noteText\n                    ? `<button type=\"button\"\n                      class=\"vac-note-btn px-2 py-1 text-[11px] rounded-lg border bg-white hover:bg-gray-50\"\n                      data-name=\"${escapeHtml(it.user_name)}\"\n                      data-range=\"${escapeHtml(range)}\"\n                      data-note=\"${escapeHtml(noteText)}\">\n                      + 내용\n                    </button>`\n                    : `<span class=\"text-[11px] text-gray-400\">-</span>`}\n            </td>\n\n            <td class=\"border-b px-2 py-2 text-center\">\n              <button type=\"button\" data-id=\"${it.id}\"\n                class=\"px-2 py-1 text-[11px] rounded-lg bg-red-100 text-red-700 hover:bg-red-200 vac-del-btn\">\n                삭제\n              </button>\n            </td>\n          </tr>\n        `;\n            })\n                .join(\"\");\n        }\n        catch (e) {\n            console.error(\"[vac] load list err:\", e);\n            vacationAdminTbody.innerHTML = `\n      <tr><td colspan=\"6\" class=\"border-b px-2 py-3 text-center text-red-500\">휴가 목록 로딩 오류</td></tr>\n    `;\n        }\n    }\n    // =====================================================\n    // ✅ 휴가자: 등록\n    // =====================================================\n    async function addVacation() {\n        if (!vacUserSelect || !vacTypeSelect || !vacFrom || !vacTo)\n            return;\n        const user_no = vacUserSelect.value ? Number(vacUserSelect.value) : null;\n        const opt = vacUserSelect.options[vacUserSelect.selectedIndex];\n        const user_name = opt?.getAttribute(\"data-name\") || opt?.textContent || \"\";\n        const vac_type = String(vacTypeSelect.value || \"annual\");\n        const start_date = String(vacFrom.value || \"\");\n        const end_date = String(vacTo.value || \"\");\n        const note = String(vacNote?.value || \"\");\n        if (!user_no || !user_name)\n            return setVacMsg(\"대상을 선택하세요.\");\n        if (!start_date || !end_date)\n            return setVacMsg(\"시작일/종료일을 입력하세요.\");\n        if (start_date > end_date)\n            return setVacMsg(\"시작일이 종료일보다 클 수 없습니다.\");\n        try {\n            setVacMsg(\"등록 중...\");\n            const res = await fetch(`${API_BASE}/api/business-master/vacations`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                credentials: \"include\",\n                body: JSON.stringify({ user_no, user_name, vac_type, start_date, end_date, note }),\n            });\n            const json = await res.json().catch(() => null);\n            if (!res.ok || json?.ok !== true) {\n                setVacMsg(json?.error || \"휴가 등록 실패\");\n                return;\n            }\n            setVacMsg(\"등록 완료\");\n            if (vacNote)\n                vacNote.value = \"\";\n            // ✅ 테이블 갱신\n            await loadVacationList();\n            // ✅✅✅ 핵심: 요약캘린더 캐시를 '즉시' 최신화 후 렌더\n            cachedVacations = await fetchVacationsAll();\n            renderSummaryCalendar();\n            // (옵션) 다른 화면(대시보드)에서 듣고 있으면 유지\n            window.dispatchEvent(new CustomEvent(\"vacation-status-refresh\"));\n        }\n        catch (e) {\n            console.error(\"[vac] add err:\", e);\n            setVacMsg(\"휴가 등록 중 오류\");\n        }\n    }\n    // =====================================================\n    // ✅ “이번달” 당직 자동 생성 (휴일만)  + 저장\n    // =====================================================\n    async function generateDutyForCurrentMonth() {\n        if (!dutyMembers.length) {\n            alert(\"당직 후보가 없습니다. 사용자관리에서 먼저 등록하세요.\");\n            return;\n        }\n        ensureDutyCalLabel();\n        const base = new Date();\n        base.setDate(1);\n        const dutyLabel = document.getElementById(\"dutyCalLabel\");\n        if (dutyLabel)\n            dutyLabel.textContent = ym(base);\n        const holidays = await fetchHolidayItemsForMonth(base);\n        if (!holidays.length) {\n            alert(\"이번 달에 휴일(주말/공휴일)이 없습니다. (표시할 데이터 없음)\");\n            renderDutyTable([]);\n            renderDashboardHolidayDuty([], {});\n            return;\n        }\n        const assigns = [];\n        const assignsMap = {};\n        let idx = dutyStartIndex;\n        for (const h of holidays) {\n            const name = dutyMembers[idx].name;\n            assigns.push({ date: h.date, name });\n            assignsMap[h.date] = name;\n            idx = (idx + 1) % dutyMembers.length;\n        }\n        dutyStartIndex = idx;\n        dutyLastYm = ym(base);\n        dutyLastAssigns = assigns;\n        if (dutyResultBox) {\n            const firstA = assigns[0];\n            const lastA = assigns[assigns.length - 1];\n            dutyResultBox.innerHTML = `\n        - 생성 월: ${ym(base)}<br/>\n        - 휴일 수(주말+공휴일): ${assigns.length}일<br/>\n        - 시작: ${firstA.date} (${firstA.name})<br/>\n        - 마지막: ${lastA.date} (${lastA.name})<br/>\n        - 다음 시작번호(자동): ${dutyStartIndex + 1}번\n      `;\n        }\n        renderDutyTable(assigns);\n        renderDashboardHolidayDuty(holidays, assignsMap);\n        await saveConfig(true);\n        window.dispatchEvent(new CustomEvent(\"duty-config-changed\"));\n        refreshSummaryCalendar();\n        alert(\"이번달 휴일(주말+공휴일) 기준으로 당직이 생성되었습니다.\");\n    }\n    // =====================================================\n    // ✅ 설정 로딩/저장\n    // =====================================================\n    async function loadConfig() {\n        try {\n            const res = await fetch(`${API_BASE}/api/business-master/config`, { credentials: \"include\" });\n            if (!res.ok) {\n                console.error(\"[출장업무관리] 설정 조회 실패 status =\", res.status);\n                return;\n            }\n            const data = (await res.json());\n            const gasoline = data.fuel_price_gasoline ?? data.fuel_price_per_liter ?? null;\n            const diesel = data.fuel_price_diesel ?? null;\n            const lpg = data.fuel_price_lpg ?? null;\n            if (inputFuelGasoline)\n                inputFuelGasoline.value = gasoline?.toString() ?? \"\";\n            if (inputFuelDiesel)\n                inputFuelDiesel.value = diesel?.toString() ?? \"\";\n            if (inputFuelGas)\n                inputFuelGas.value = lpg?.toString() ?? \"\";\n            if (inputUsd)\n                inputUsd.value = data.exchange_rate_usd?.toString() ?? \"\";\n            if (inputJpy)\n                inputJpy.value = data.exchange_rate_jpy?.toString() ?? \"\";\n            if (inputCny)\n                inputCny.value = data.exchange_rate_cny?.toString() ?? \"\";\n            if (textareaNotice)\n                textareaNotice.value = data.notice ?? data.note ?? \"\";\n            const rawDutyText = String(data.duty_members_text ?? \"\");\n            if (rawDutyText) {\n                try {\n                    const parsed = JSON.parse(rawDutyText);\n                    if (typeof parsed?.startIndex === \"number\")\n                        dutyStartIndex = parsed.startIndex;\n                    if (typeof parsed?.lastYm === \"string\")\n                        dutyLastYm = parsed.lastYm;\n                    if (Array.isArray(parsed?.lastAssigns)) {\n                        dutyLastAssigns = parsed.lastAssigns\n                            .map((a) => ({\n                            date: String(a?.date ?? \"\"),\n                            name: String(a?.name ?? \"\"),\n                        }))\n                            .filter((a) => /^\\d{4}-\\d{2}-\\d{2}$/.test(a.date) && !!a.name);\n                    }\n                }\n                catch {\n                    // 무시\n                }\n            }\n            if (dutyResultBox) {\n                dutyResultBox.textContent = \"- '당직 자동 생성'을 누르면 이번달 휴일(주말+공휴일)에만 자동 배정됩니다.\";\n            }\n            if (dutyLastAssigns.length)\n                renderDutyTable(dutyLastAssigns);\n            else\n                renderDutyTable([]);\n            ensureDutyCalLabel();\n            const dutyLabel = document.getElementById(\"dutyCalLabel\");\n            if (dutyLabel) {\n                const fallback = /^\\d{4}-\\d{2}$/.test(dutyLastYm) ? dutyLastYm : ym(new Date());\n                dutyLabel.textContent = fallback;\n            }\n            refreshSummaryCalendar();\n            renderDashboardDutyCalendarFromTable();\n        }\n        catch (err) {\n            console.error(\"[출장업무관리] 설정 조회 중 오류:\", err);\n        }\n    }\n    async function saveConfig(forceSilent = false) {\n        const dutyStore = JSON.stringify({\n            startIndex: dutyStartIndex,\n            lastYm: dutyLastYm,\n            lastAssigns: dutyLastAssigns,\n            updatedAt: new Date().toISOString(),\n        });\n        const body = {\n            fuel_price_gasoline: parseNumberOrNull(inputFuelGasoline?.value ?? \"\"),\n            fuel_price_diesel: parseNumberOrNull(inputFuelDiesel?.value ?? \"\"),\n            fuel_price_lpg: parseNumberOrNull(inputFuelGas?.value ?? \"\"),\n            exchange_rate_usd: parseNumberOrNull(inputUsd?.value ?? \"\"),\n            exchange_rate_jpy: parseNumberOrNull(inputJpy?.value ?? \"\"),\n            exchange_rate_cny: parseNumberOrNull(inputCny?.value ?? \"\"),\n            duty_members_text: dutyStore,\n            notice: textareaNotice?.value ?? \"\",\n        };\n        try {\n            const res = await fetch(`${API_BASE}/api/business-master/config`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify(body),\n            });\n            const json = await res.json().catch(() => ({}));\n            if (!res.ok || json?.ok === false) {\n                loadVacationList;\n                console.error(\"[출장업무관리] 설정 저장 실패 status =\", res.status, json);\n                if (!forceSilent)\n                    alert(json?.error || \"설정 저장 중 오류가 발생했습니다.\");\n                return;\n            }\n            window.dispatchEvent(new CustomEvent(\"duty-config-changed\"));\n            if (!forceSilent)\n                alert(\"설정이 저장되었습니다.\");\n        }\n        catch (err) {\n            console.error(\"[출장업무관리] 설정 저장 중 오류:\", err);\n            if (!forceSilent)\n                alert(\"설정 저장 중 오류가 발생했습니다.\");\n        }\n    }\n    // =====================================================\n    // ✅ 거리 마스터 로딩/표시\n    // =====================================================\n    async function loadDistances() {\n        distanceTbody.innerHTML = `\n      <tr>\n        <td colspan=\"6\" class=\"border px-2 py-2 text-center text-xs text-gray-400\">\n          거리 목록 로딩 중...\n        </td>\n      </tr>\n    `;\n        try {\n            const res = await fetch(`${API_BASE}/api/business-master/distances`, { credentials: \"include\" });\n            if (!res.ok) {\n                console.error(\"[출장업무관리] 거리 목록 조회 실패 status =\", res.status);\n                return;\n            }\n            const rows = await res.json();\n            distanceRows = Array.isArray(rows) ? rows.map(mapRawDistance) : [];\n            deletedIds = [];\n            renderDistanceTable();\n        }\n        catch (err) {\n            console.error(\"[출장업무관리] 거리 목록 조회 중 오류:\", err);\n        }\n    }\n    function renderDistanceTable() {\n        distanceTbody.innerHTML = \"\";\n        if (!distanceRows.length) {\n            distanceTbody.innerHTML = `\n        <tr>\n          <td colspan=\"6\" class=\"border px-2 py-2 text-center text-xs text-gray-400\">\n            등록된 거리 정보가 없습니다. [+ 행 추가] 버튼으로 추가하세요.\n          </td>\n        </tr>\n      `;\n            return;\n        }\n        distanceRows.forEach((row, index) => {\n            const tr = document.createElement(\"tr\");\n            tr.dataset.index = String(index);\n            tr.innerHTML = `\n        <td class=\"border-b px-2 py-2 text-center text-[11px]\">${index + 1}</td>\n        <td class=\"border-b px-2 py-2\">\n          <input type=\"text\"\n            class=\"w-full border rounded-xl px-2 py-2 text-xs region-input bg-white\"\n            value=\"${escapeHtml(row.region ?? \"\")}\" />\n        </td>\n        <td class=\"border-b px-2 py-2\">\n          <input type=\"text\"\n            class=\"w-full border rounded-xl px-2 py-2 text-xs client-input bg-white\"\n            value=\"${escapeHtml(row.client_name ?? \"\")}\" />\n        </td>\n        <td class=\"border-b px-2 py-2\">\n          <input type=\"number\" step=\"0.1\"\n            class=\"w-full border rounded-xl px-2 py-2 text-right text-xs distance-km-input bg-white\"\n            placeholder=\"km\"\n            value=\"${row.distance_km ?? \"\"}\" />\n        </td>\n        <td class=\"border-b px-2 py-2 text-center\">\n          <button type=\"button\"\n            class=\"px-2 py-1 text-[11px] rounded-lg bg-red-100 text-red-700 hover:bg-red-200 btn-row-delete\">\n            삭제\n          </button>\n        </td>\n      `;\n            distanceTbody.appendChild(tr);\n        });\n    }\n    function syncDistanceFromTable() {\n        const rows = distanceTbody.querySelectorAll(\"tr\");\n        rows.forEach((tr) => {\n            const idxStr = tr.dataset.index;\n            if (idxStr == null)\n                return;\n            const idx = Number(idxStr);\n            const row = distanceRows[idx];\n            if (!row)\n                return;\n            const regionInput = tr.querySelector(\".region-input\");\n            const clientInput = tr.querySelector(\".client-input\");\n            const distanceInput = tr.querySelector(\".distance-km-input\");\n            row.region = regionInput?.value?.trim() ?? \"\";\n            row.client_name = clientInput?.value?.trim() ?? \"\";\n            row.distance_km = parseNumberOrNull(distanceInput?.value ?? \"\");\n        });\n    }\n    async function saveDistances() {\n        syncDistanceFromTable();\n        for (const row of distanceRows) {\n            if (!row.client_name || row.distance_km == null) {\n                alert(\"거래처와 거리(km)는 반드시 입력해야 합니다.\");\n                return;\n            }\n        }\n        try {\n            for (const id of deletedIds) {\n                if (!id)\n                    continue;\n                const res = await fetch(`${API_BASE}/api/business-master/distances/${id}`, {\n                    method: \"DELETE\",\n                    credentials: \"include\",\n                });\n                if (!res.ok) {\n                    console.error(\"[출장업무관리] 거리 삭제 실패 id=\", id, \"status=\", res.status);\n                }\n            }\n            deletedIds = [];\n            for (const row of distanceRows) {\n                const payload = {\n                    region: row.region,\n                    client_name: row.client_name,\n                    distance_km: row.distance_km,\n                };\n                if (row.id == null) {\n                    const res = await fetch(`${API_BASE}/api/business-master/distances`, {\n                        method: \"POST\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify(payload),\n                    });\n                    if (!res.ok)\n                        console.error(\"[출장업무관리] 거리 등록 실패 status=\", res.status);\n                }\n                else {\n                    const res = await fetch(`${API_BASE}/api/business-master/distances/${row.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify(payload),\n                    });\n                    if (!res.ok)\n                        console.error(\"[출장업무관리] 거리 수정 실패 id=\", row.id, \"status=\", res.status);\n                }\n            }\n            alert(\"거리 마스터가 저장되었습니다.\");\n            await loadDistances();\n        }\n        catch (err) {\n            console.error(\"[출장업무관리] 거리 저장 중 오류:\", err);\n            alert(\"거리 저장 중 오류가 발생했습니다.\");\n        }\n    }\n    function addEmptyRow() {\n        distanceRows.push({\n            id: null,\n            region: \"\",\n            client_name: \"\",\n            distance_km: null,\n        });\n        renderDistanceTable();\n    }\n    // =====================================================\n    // 이벤트 바인딩 (1회만)\n    // =====================================================\n    btnDistanceAddRow?.addEventListener(\"click\", () => addEmptyRow());\n    btnDistanceSave?.addEventListener(\"click\", () => saveDistances());\n    btnNoticeUpload?.addEventListener(\"click\", uploadNoticeOnly);\n    btnFuelFxSave?.addEventListener(\"click\", onSave);\n    btnVacAdd?.addEventListener(\"click\", () => addVacation());\n    // ✅✅✅ 일정 등록 버튼\n    btnCalTodoAdd?.addEventListener(\"click\", () => addCalendarTodo());\n    vacationAdminTbody?.addEventListener(\"click\", async (e) => {\n        const target = e.target;\n        if (!target)\n            return;\n        if (target.classList.contains(\"vac-note-btn\")) {\n            const btn = target;\n            const name = btn.dataset.name || \"\";\n            const range = btn.dataset.range || \"\";\n            const note = btn.dataset.note || \"\";\n            openVacNoteModal(name, range, note);\n            return;\n        }\n        if (!target.classList.contains(\"vac-del-btn\"))\n            return;\n        const id = Number(target.dataset.id);\n        if (!Number.isFinite(id))\n            return;\n        try {\n            const res = await fetch(`${API_BASE}/api/business-master/vacations/${id}`, {\n                method: \"DELETE\",\n                credentials: \"include\",\n            });\n            const json = await res.json().catch(() => null);\n            if (!res.ok || json?.ok !== true) {\n                setVacMsg(json?.error || \"삭제 실패\");\n                return;\n            }\n            setVacMsg(\"삭제 완료\");\n            await loadVacationList();\n            window.dispatchEvent(new CustomEvent(\"vacation-status-refresh\"));\n            refreshSummaryCalendar();\n        }\n        catch (err) {\n            console.error(\"[vac] delete err:\", err);\n            setVacMsg(\"삭제 중 오류\");\n        }\n    });\n    distanceTbody.addEventListener(\"click\", (e) => {\n        const target = e.target;\n        if (!target?.classList.contains(\"btn-row-delete\"))\n            return;\n        const tr = target.closest(\"tr\");\n        if (!tr)\n            return;\n        const idxStr = tr.dataset.index;\n        if (idxStr == null)\n            return;\n        const idx = Number(idxStr);\n        const row = distanceRows[idx];\n        if (!row)\n            return;\n        if (row.id != null)\n            deletedIds.push(row.id);\n        distanceRows.splice(idx, 1);\n        renderDistanceTable();\n    });\n    dutyTbody?.addEventListener(\"click\", (e) => {\n        const target = e.target;\n        if (!target?.classList.contains(\"btn-duty-delete\"))\n            return;\n        const tr = target.closest(\"tr\");\n        if (!tr)\n            return;\n        const idx = Number(tr.dataset.idx);\n        if (!Number.isFinite(idx))\n            return;\n        dutyMembers.splice(idx, 1);\n        if (dutyMembers.length === 0)\n            dutyStartIndex = 0;\n        else\n            dutyStartIndex = dutyStartIndex % dutyMembers.length;\n        renderDutyMembers();\n        refreshSummaryCalendar();\n    });\n    // ✅ 삭제한 사용자 다시 넣기 (select -> 추가)\n    btnDutyAddUser?.addEventListener(\"click\", () => {\n        if (!dutyAddSelect)\n            return;\n        const no = Number(dutyAddSelect.value);\n        if (!Number.isFinite(no) || no <= 0)\n            return;\n        const user = allUsers.find((u) => u.no === no);\n        if (!user)\n            return;\n        if (dutyMembers.some((m) => m.no === user.no))\n            return;\n        dutyMembers.push({ no: user.no, name: user.name });\n        if (dutyMembers.length === 0)\n            dutyStartIndex = 0;\n        else\n            dutyStartIndex = dutyStartIndex % dutyMembers.length;\n        renderDutyMembers();\n        refreshSummaryCalendar();\n    });\n    btnDutyGenerateThisMonth?.addEventListener(\"click\", () => {\n        generateDutyForCurrentMonth();\n    });\n    sumCalPrev?.addEventListener(\"click\", () => {\n        sumMonth--;\n        if (sumMonth < 0) {\n            sumMonth = 11;\n            sumYear--;\n        }\n        refreshSummaryCalendar();\n    });\n    sumCalNext?.addEventListener(\"click\", () => {\n        sumMonth++;\n        if (sumMonth > 11) {\n            sumMonth = 0;\n            sumYear++;\n        }\n        refreshSummaryCalendar();\n    });\n    // =====================================================\n    // ✅✅✅ 핵심: \"패널이 다시 보일 때마다\" 리셋 + 서버 재조회\n    // =====================================================\n    // 1) 리셋(화면+메모리 캐시)\n    function resetBusinessMasterState() {\n        // 화면 입력값/표 먼저 비우기\n        if (textareaNotice)\n            textareaNotice.value = \"\";\n        if (distanceTbody) {\n            distanceTbody.innerHTML = `\n        <tr>\n          <td colspan=\"6\" class=\"border px-2 py-2 text-center text-xs text-gray-400\">\n            로딩 중...\n          </td>\n        </tr>\n      `;\n        }\n        if (vacationAdminTbody) {\n            vacationAdminTbody.innerHTML = `\n        <tr><td colspan=\"6\" class=\"border-b px-2 py-3 text-center text-gray-400\">로딩 중...</td></tr>\n      `;\n        }\n        if (sumCalGrid)\n            sumCalGrid.innerHTML = \"\";\n        if (sumCalLabel)\n            sumCalLabel.textContent = \"\";\n        // 메모리 캐시도 비우기(이게 핵심)\n        distanceRows = [];\n        deletedIds = [];\n        cachedVacations = [];\n        cachedHolidays = [];\n        cachedDutyPreviewYm = \"\";\n        cachedDutyPreviewAssigns = [];\n        cachedCalendarEvents = [];\n        // 당직/유저 캐시도 초기화 (다시 로드)\n        dutyMembers = [];\n        allUsers = [];\n    }\n    // 2) 서버에서 다시 가져와서 렌더\n    let _reloadInFlight = false;\n    async function reloadBusinessMasterFromServer(reason = \"\") {\n        if (_reloadInFlight)\n            return;\n        _reloadInFlight = true;\n        console.log(\"[출장업무관리] ✅ 리로드 시작:\", reason);\n        try {\n            resetBusinessMasterState();\n            // ✅ 순서 중요: 설정 -> 사용자(당직후보) -> 거리 -> 휴가옵션/목록 -> 캘린더\n            await loadConfig();\n            await loadDutyMembersFromUsers();\n            await loadDistances();\n            await loadVacUserOptions();\n            await loadVacationList();\n            await refreshSummaryCalendar();\n            renderSummaryCalendar(); // 혹시라도 비어있을 때 한 번 더\n        }\n        catch (e) {\n            console.error(\"[출장업무관리] reloadBusinessMasterFromServer error:\", e);\n        }\n        finally {\n            _reloadInFlight = false;\n        }\n    }\n    // 3) 패널이 \"숨김 -> 표시\" 될 때 자동 감지 (showPanel 수정 안 해도 됨)\n    //    hidden 클래스가 빠지는 순간마다 reload 실행\n    if (!panel._bmObserver) {\n        const obs = new MutationObserver(() => {\n            // panel이 보이는 상태인지 체크\n            const isHidden = panel.classList.contains(\"hidden\");\n            if (isHidden)\n                return;\n            // 화면에 실제로 표시되는 상태(대충 체크)\n            const isVisible = panel.offsetParent !== null;\n            if (!isVisible)\n                return;\n            // ✅ 다시 보이면 무조건 서버 재조회\n            reloadBusinessMasterFromServer(\"panel-visible\");\n        });\n        obs.observe(panel, { attributes: true, attributeFilter: [\"class\"] });\n        panel._bmObserver = obs;\n    }\n    // 4) 최초 진입 1회 로드\n    reloadBusinessMasterFromServer(\"first-load\");\n}\n","// TypeScript/workspace/08_domestic-trip-register.ts\nimport { ModalUtil } from \"./utils/ModalUtil\";\n// ✅ 모듈(탭) 메모리 유지용: 새로고침/로그아웃/브라우저 종료 시 자동 초기화\nlet ACTIVE = null;\nfunction getEl(id) {\n    const el = document.getElementById(id);\n    if (!el)\n        throw new Error(`❌ element not found: #${id}`);\n    return el;\n}\nfunction textOrEmpty(v) {\n    return String(v ?? \"\").trim();\n}\n/** ✅ 서버 응답에서 trip_id 최대한 찾아내기(서버 구조 달라도 대응) */\nfunction pickTripIdFromResponse(data) {\n    const cand = data?.trip_id ??\n        data?.tripId ??\n        data?.id ??\n        data?.data?.trip_id ??\n        data?.data?.tripId ??\n        data?.data?.id ??\n        data?.result?.trip_id ??\n        data?.result?.id;\n    const s = textOrEmpty(cand);\n    return s ? s : undefined;\n}\n/**\n * ✅ URL 파라미터 읽기 (search + hash 둘 다 대응)\n * - 일반 URL:    /workspace?req_name=...&trip_date=...\n * - 해시 라우팅: /workspace#something?req_name=...&trip_date=...\n */\nfunction getQueryParam(name) {\n    try {\n        const url = new URL(window.location.href);\n        const fromSearch = url.searchParams.get(name);\n        if (fromSearch)\n            return fromSearch;\n        const hash = String(url.hash ?? \"\");\n        const qIdx = hash.indexOf(\"?\");\n        if (qIdx >= 0) {\n            const hashQuery = hash.slice(qIdx + 1);\n            const sp = new URLSearchParams(hashQuery);\n            return sp.get(name) ?? \"\";\n        }\n        return \"\";\n    }\n    catch {\n        return \"\";\n    }\n}\n/** ✅ URL 파라미터 세팅/삭제 (현재 라우팅 방식과 무관하게 최대한 안전하게 처리) */\nfunction setQueryParams(params) {\n    try {\n        const url = new URL(window.location.href);\n        // 기본: search에 넣기\n        Object.entries(params).forEach(([k, v]) => url.searchParams.set(k, v));\n        // hash 라우팅이면 hash의 query도 맞춰주기(있을 때만)\n        const hash = String(url.hash ?? \"\");\n        const qIdx = hash.indexOf(\"?\");\n        if (qIdx >= 0) {\n            const base = hash.slice(0, qIdx);\n            const sp = new URLSearchParams(hash.slice(qIdx + 1));\n            Object.entries(params).forEach(([k, v]) => sp.set(k, v));\n            url.hash = `${base}?${sp.toString()}`;\n        }\n        window.history.replaceState(null, \"\", url.toString());\n    }\n    catch {\n        // ignore\n    }\n}\nfunction clearQueryParams(keys) {\n    try {\n        const url = new URL(window.location.href);\n        keys.forEach((k) => url.searchParams.delete(k));\n        const hash = String(url.hash ?? \"\");\n        const qIdx = hash.indexOf(\"?\");\n        if (qIdx >= 0) {\n            const base = hash.slice(0, qIdx);\n            const sp = new URLSearchParams(hash.slice(qIdx + 1));\n            keys.forEach((k) => sp.delete(k));\n            const qs = sp.toString();\n            url.hash = qs ? `${base}?${qs}` : base;\n        }\n        window.history.replaceState(null, \"\", url.toString());\n    }\n    catch {\n        // ignore\n    }\n}\nexport function initDomesticTripRegisterPanel(API_BASE) {\n    const panel = document.getElementById(\"panel-국내출장-출장등록\");\n    if (!panel)\n        return;\n    const saveBtn = getEl(\"reg_save\");\n    if (saveBtn._bound)\n        return;\n    saveBtn._bound = true;\n    const resetBtn = getEl(\"reg_reset\");\n    const resultBox = getEl(\"reg_result\");\n    const continueBtn = document.getElementById(\"reg_continue\");\n    const settlementSection = document.getElementById(\"bt_settlement_section\");\n    const userNameEl = document.getElementById(\"userName\");\n    const reqNameInput = getEl(\"bt_req_name\");\n    // ✅ 출발지 select (value: company/home/other)\n    const departPlaceSelect = getEl(\"bt_place\");\n    const departPlaceOther = document.getElementById(\"bt_place_other\");\n    // ✅ 출장지 select (clients API)\n    const destinationSelect = getEl(\"bt_destination\");\n    const startInput = getEl(\"bt_start\");\n    const departTimeInput = getEl(\"bt_depart_time\");\n    const arriveTimeInput = getEl(\"bt_arrive_time\");\n    const purposeInput = getEl(\"bt_purpose\");\n    function currentUserName() {\n        return (userNameEl?.textContent ?? \"\").trim();\n    }\n    /** ✅ 입력값 싹 비우기 */\n    function clearFormUI() {\n        reqNameInput.value = currentUserName() || \"사용자\";\n        departPlaceSelect.value = \"\";\n        if (departPlaceOther) {\n            departPlaceOther.value = \"\";\n            departPlaceOther.classList.add(\"hidden\");\n        }\n        destinationSelect.value = \"\";\n        startInput.value = \"\";\n        departTimeInput.value = \"\";\n        arriveTimeInput.value = \"\";\n        purposeInput.value = \"\";\n        resultBox.textContent = \"\";\n        if (continueBtn)\n            continueBtn.classList.add(\"hidden\");\n        if (settlementSection)\n            settlementSection.classList.add(\"hidden\");\n    }\n    /** ✅ 메모리 ACTIVE로 UI 복원(탭 유지용) */\n    function restoreFromActive(active) {\n        const p = active.payload;\n        reqNameInput.value = p.req_name || (currentUserName() || \"사용자\");\n        if (p.depart_place === \"company\" || p.depart_place === \"home\") {\n            departPlaceSelect.value = p.depart_place;\n            if (departPlaceOther) {\n                departPlaceOther.value = \"\";\n                departPlaceOther.classList.add(\"hidden\");\n            }\n        }\n        else {\n            departPlaceSelect.value = \"other\";\n            if (departPlaceOther) {\n                departPlaceOther.classList.remove(\"hidden\");\n                departPlaceOther.value = p.depart_place;\n            }\n        }\n        destinationSelect.value = p.destination || \"\";\n        startInput.value = p.start_date || \"\";\n        departTimeInput.value = p.depart_time || \"\";\n        arriveTimeInput.value = p.arrive_time || \"\";\n        purposeInput.value = p.purpose || \"\";\n        resultBox.textContent = \"✅ 등록된 출장건(정산 전)입니다. 계속 정산을 진행할 수 있습니다.\";\n        if (continueBtn)\n            continueBtn.classList.remove(\"hidden\");\n        if (settlementSection)\n            settlementSection.classList.add(\"hidden\");\n    }\n    /** ✅ 거래처 목록 로딩 */\n    async function loadClients() {\n        try {\n            destinationSelect.innerHTML = `<option value=\"\">거래처(출장지) 선택</option>`;\n            const res = await fetch(`${API_BASE}/api/business-trip/clients`);\n            if (!res.ok) {\n                console.error(\"[REGISTER] clients API HTTP error:\", res.status);\n                return;\n            }\n            const json = await res.json().catch(() => null);\n            const raw = Array.isArray(json?.data) ? json.data :\n                Array.isArray(json?.rows) ? json.rows :\n                    Array.isArray(json?.clients) ? json.clients :\n                        Array.isArray(json) ? json :\n                            [];\n            for (const item of raw) {\n                const name = typeof item === \"string\"\n                    ? item\n                    : (item?.client_name ?? item?.name ?? item?.destination);\n                const clean = textOrEmpty(name);\n                if (!clean)\n                    continue;\n                const opt = document.createElement(\"option\");\n                opt.value = clean;\n                opt.textContent = clean;\n                destinationSelect.appendChild(opt);\n            }\n            // ✅ 목록 로드 후: ACTIVE가 있으면 destination 값 재적용\n            if (ACTIVE?.payload?.destination) {\n                destinationSelect.value = ACTIVE.payload.destination;\n            }\n        }\n        catch (err) {\n            console.warn(\"[REGISTER] 거래처 목록 로딩 실패:\", err);\n        }\n    }\n    /**\n     * ✅✅✅ 핵심: 로그아웃/재로그인 복원\n     * - end_data가 비어있는(정산 미완료) 최신 1건의 start_data를 불러와 폼에 채움\n     * - API: GET /api/business-trip/domestic/incomplete?req_name=...\n     */\n    async function restoreIncompleteFromServer() {\n        const me = currentUserName();\n        if (!me)\n            return;\n        try {\n            const url = `${API_BASE}/api/business-trip/domestic/incomplete?req_name=${encodeURIComponent(me)}`;\n            const res = await fetch(url);\n            if (!res.ok)\n                return;\n            const j = await res.json().catch(() => null);\n            const data = j?.data;\n            if (!data?.start_data)\n                return;\n            const p = data.start_data;\n            // 요청자\n            reqNameInput.value = p.req_name ?? me;\n            // 출발지(company/home/기타텍스트)\n            const dp = String(p.depart_place ?? \"\");\n            if (dp === \"company\" || dp === \"home\") {\n                departPlaceSelect.value = dp;\n                if (departPlaceOther) {\n                    departPlaceOther.value = \"\";\n                    departPlaceOther.classList.add(\"hidden\");\n                }\n            }\n            else if (dp) {\n                departPlaceSelect.value = \"other\";\n                if (departPlaceOther) {\n                    departPlaceOther.classList.remove(\"hidden\");\n                    departPlaceOther.value = dp;\n                }\n            }\n            // 출장지/일자/시간/목적\n            destinationSelect.value = String(p.destination ?? \"\");\n            startInput.value = String(p.start_date ?? p.trip_date ?? \"\");\n            departTimeInput.value = String(p.depart_time ?? \"\");\n            arriveTimeInput.value = String(p.arrive_time ?? \"\");\n            purposeInput.value = String(p.purpose ?? \"\");\n            // URL 파라미터도 맞춰줌(09가 이걸 쓰는 구조라서)\n            const tripDate = String(p.start_date ?? p.trip_date ?? \"\");\n            if (tripDate) {\n                setQueryParams({ req_name: me, trip_date: tripDate });\n            }\n            // UI: 이어서 정산 버튼은 보여주되, 정산 섹션은 버튼 누를 때만 열림\n            if (continueBtn)\n                continueBtn.classList.remove(\"hidden\");\n            if (settlementSection)\n                settlementSection.classList.add(\"hidden\");\n            resultBox.textContent = \"✅ 정산 미완료 출장건을 불러왔습니다. [이어서 정산]을 눌러 진행하세요.\";\n        }\n        catch (e) {\n            console.warn(\"[REGISTER] restoreIncompleteFromServer error:\", e);\n        }\n    }\n    /** ✅ 패널 열릴 때 규칙: ACTIVE 있으면 복원 / 없으면 리셋 */\n    async function applyOpenRule() {\n        if (ACTIVE)\n            restoreFromActive(ACTIVE);\n        else\n            clearFormUI();\n        await loadClients();\n        // ✅ URL 파라미터가 현재 유저와 동일하면 날짜/이름 정도는 채움\n        const qpName = getQueryParam(\"req_name\");\n        const qpDate = getQueryParam(\"trip_date\");\n        const me = currentUserName();\n        if (qpName && qpDate && me && qpName === me) {\n            reqNameInput.value = qpName;\n            startInput.value = qpDate;\n        }\n        else if (qpName || qpDate) {\n            clearQueryParams([\"req_name\", \"trip_date\"]);\n        }\n        // ✅✅✅ 마지막: 서버에서 \"정산 미완료 start_data\" 자동 복원\n        await restoreIncompleteFromServer();\n    }\n    // ✅ 최초 1회 적용\n    applyOpenRule();\n    // 초기 숨김(복원 로직에서 필요하면 풀림)\n    if (continueBtn)\n        continueBtn.classList.add(\"hidden\");\n    if (settlementSection)\n        settlementSection.classList.add(\"hidden\");\n    // ✅ 출발지 기타 토글\n    departPlaceSelect.addEventListener(\"change\", () => {\n        if (!departPlaceOther)\n            return;\n        const isOther = departPlaceSelect.value === \"other\";\n        departPlaceOther.classList.toggle(\"hidden\", !isOther);\n        if (!isOther)\n            departPlaceOther.value = \"\";\n    });\n    // ✅ 패널 이동 감지(hidden 토글)\n    const mo = new MutationObserver(() => {\n        const isHidden = panel.classList.contains(\"hidden\");\n        if (isHidden) {\n            if (!ACTIVE)\n                clearFormUI();\n        }\n        else {\n            applyOpenRule();\n        }\n    });\n    mo.observe(panel, { attributes: true, attributeFilter: [\"class\"] });\n    // 🔹 리셋 버튼: UI 초기화 + ACTIVE 제거 + URL 파라미터 제거\n    resetBtn.addEventListener(\"click\", async () => {\n        if (ACTIVE) {\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"초기화\",\n                message: \"등록된 출장건(정산 전)이 남아있습니다.\\n\" +\n                    \"초기화하면 해당 내용은 더 이상 유지되지 않습니다.\",\n                showOk: true,\n                showCancel: false,\n            });\n        }\n        ACTIVE = null;\n        clearQueryParams([\"req_name\", \"trip_date\"]);\n        clearFormUI();\n        loadClients();\n    });\n    // 🔹 저장(출장등록)\n    saveBtn.addEventListener(\"click\", async () => {\n        const depart_place = departPlaceSelect.value === \"other\"\n            ? textOrEmpty(departPlaceOther?.value)\n            : textOrEmpty(departPlaceSelect.value); // company | home\n        const payload = {\n            trip_type: \"domestic\",\n            req_name: reqNameInput.value.trim(),\n            depart_place,\n            destination: textOrEmpty(destinationSelect.value),\n            start_date: startInput.value,\n            depart_time: departTimeInput.value,\n            arrive_time: arriveTimeInput.value,\n            purpose: purposeInput.value.trim(),\n        };\n        // 필수 체크\n        if (!payload.req_name ||\n            !payload.depart_place ||\n            !payload.destination ||\n            !payload.start_date ||\n            !payload.depart_time ||\n            !payload.arrive_time ||\n            !payload.purpose) {\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"입력 확인\",\n                message: \"모든 항목은 필수입니다.\",\n                showOk: true,\n                showCancel: false,\n            });\n            return;\n        }\n        if (departPlaceSelect.value === \"other\" && !payload.depart_place) {\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"입력 확인\",\n                message: \"기타 출발지를 입력해주세요.\",\n                showOk: true,\n                showCancel: false,\n            });\n            return;\n        }\n        try {\n            saveBtn.disabled = true;\n            resultBox.textContent = \"서버에 저장 중...\";\n            const res = await fetch(`${API_BASE}/api/business-trip/domestic`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify(payload),\n            });\n            if (!res.ok) {\n                const text = await res.text();\n                console.error(\"출장등록 실패 응답:\", res.status, text);\n                resultBox.textContent = `❌ 서버 저장 실패: HTTP ${res.status}`;\n                await ModalUtil.show({\n                    type: \"alert\",\n                    title: \"저장 실패\",\n                    message: `서버 저장에 실패했습니다.\\n(HTTP ${res.status})`,\n                    showOk: true,\n                    showCancel: false,\n                });\n                if (continueBtn)\n                    continueBtn.classList.add(\"hidden\");\n                if (settlementSection)\n                    settlementSection.classList.add(\"hidden\");\n                return;\n            }\n            const data = await res.json().catch(() => null);\n            // ✅ 탭 메모리(ACTIVE)만 세팅\n            const trip_id = pickTripIdFromResponse(data);\n            ACTIVE = { savedAt: Date.now(), trip_id, payload };\n            // ✅ 09 정산이 req_name/trip_date를 쓰는 구조라 URL도 맞춰줌\n            setQueryParams({\n                req_name: payload.req_name,\n                trip_date: payload.start_date,\n            });\n            resultBox.textContent = \"✅ 출장 등록 완료 (정산 전까지 탭에서만 유지됩니다.)\";\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"저장 완료\",\n                message: \"출장 등록 내용이 서버에 저장되었습니다.\\n[이어서 정산] 버튼을 눌러 정산을 작성하세요.\",\n                showOk: true,\n                showCancel: false,\n            });\n            if (continueBtn)\n                continueBtn.classList.remove(\"hidden\");\n            if (settlementSection)\n                settlementSection.classList.add(\"hidden\");\n            window.dispatchEvent(new Event(\"trip-status-refresh\"));\n        }\n        catch (err) {\n            console.error(\"출장등록 중 오류:\", err);\n            resultBox.textContent = `❌ 저장 실패: ${err?.message ?? \"알 수 없는 오류\"}`;\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"저장 실패\",\n                message: resultBox.textContent,\n                showOk: true,\n                showCancel: false,\n            });\n            ACTIVE = null;\n            clearQueryParams([\"req_name\", \"trip_date\"]);\n            window.dispatchEvent(new Event(\"trip-status-refresh\"));\n            if (continueBtn)\n                continueBtn.classList.add(\"hidden\");\n            if (settlementSection)\n                settlementSection.classList.add(\"hidden\");\n        }\n        finally {\n            saveBtn.disabled = false;\n        }\n    });\n    /**\n     * 🔹 이어서 정산\n     * ✅ in-progress 플래그/백엔드 호출 없음\n     * - 그냥 정산 섹션을 열고 URL 파라미터만 맞춰준다.\n     */\n    continueBtn?.addEventListener(\"click\", async () => {\n        try {\n            const me = currentUserName();\n            const date = startInput.value;\n            const name = reqNameInput.value.trim();\n            if (!date || !name) {\n                resultBox.textContent = \"❌ 정산 대상(요청자/날짜)이 없습니다.\";\n                return;\n            }\n            // ✅ 현재 로그인 유저와 다르면 막기(다른 계정 잔존 문제 방지)\n            if (me && name !== me) {\n                await ModalUtil.show({\n                    type: \"alert\",\n                    title: \"정산 대상 불일치\",\n                    message: \"현재 로그인 사용자와 정산 대상 요청자명이 다릅니다.\\n다시 확인해주세요.\",\n                    showOk: true,\n                    showCancel: false,\n                });\n                clearQueryParams([\"req_name\", \"trip_date\"]);\n                return;\n            }\n            setQueryParams({ req_name: name, trip_date: date });\n            if (settlementSection) {\n                settlementSection.classList.remove(\"hidden\");\n                settlementSection.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n            }\n            resultBox.textContent = \"✏️ 이 출장건에 대한 정산 정보를 아래에서 이어서 작성하세요.\";\n        }\n        catch (err) {\n            console.error(\"continue settlement error:\", err);\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"오류\",\n                message: `정산 열기 중 오류가 발생했습니다.\\n${err?.message ?? \"\"}`,\n                showOk: true,\n                showCancel: false,\n            });\n        }\n    });\n    // ✅ 정산 완료 이벤트(09에서 발사)\n    window.addEventListener(\"domestic-trip-settled\", () => {\n        ACTIVE = null;\n        clearQueryParams([\"req_name\", \"trip_date\"]);\n        clearFormUI();\n    });\n    window.addEventListener(\"trip-settled\", () => {\n        ACTIVE = null;\n        clearQueryParams([\"req_name\", \"trip_date\"]);\n        clearFormUI();\n    });\n}\n","// TypeScript/workspace/09_domestic-trip-settlement.ts\nimport { ModalUtil } from \"./utils/ModalUtil\";\nfunction getEl(id) {\n    const el = document.getElementById(id);\n    if (!el)\n        throw new Error(`❌ element not found: #${id}`);\n    return el;\n}\nfunction getCheckedRadioValue(name) {\n    const checked = document.querySelector(`input[name=\"${name}\"]:checked`);\n    return checked?.value ?? \"\";\n}\n/** ✅ 차량 라디오 value가 뭐로 오든, 서버/계산용 표준 코드로 변환 */\nfunction toVehicleCode(v) {\n    const s = String(v ?? \"\").trim();\n    if (s === \"corp\" || s === \"corporate\")\n        return \"corp\";\n    if (s === \"personal\")\n        return \"personal\";\n    if (s === \"other\" || s === \"other_personal\")\n        return \"other\";\n    if (s === \"public\")\n        return \"public\";\n    return \"other\";\n}\nfunction textOrEmpty(v) {\n    return String(v ?? \"\").trim();\n}\n/**\n * ✅ URL 파라미터 읽기 (search + hash 둘 다 대응)\n */\nfunction getQueryParam(name) {\n    try {\n        const url = new URL(window.location.href);\n        const fromSearch = url.searchParams.get(name);\n        if (fromSearch)\n            return fromSearch;\n        const hash = String(url.hash ?? \"\");\n        const qIdx = hash.indexOf(\"?\");\n        if (qIdx >= 0) {\n            const hashQuery = hash.slice(qIdx + 1);\n            const sp = new URLSearchParams(hashQuery);\n            return sp.get(name) ?? \"\";\n        }\n        return \"\";\n    }\n    catch {\n        return \"\";\n    }\n}\n/** ✅ (추가) URL 파라미터 세팅 (08과 동일하게 방어적으로) */\nfunction setQueryParams(params) {\n    try {\n        const url = new URL(window.location.href);\n        Object.entries(params).forEach(([k, v]) => url.searchParams.set(k, v));\n        const hash = String(url.hash ?? \"\");\n        const qIdx = hash.indexOf(\"?\");\n        if (qIdx >= 0) {\n            const base = hash.slice(0, qIdx);\n            const sp = new URLSearchParams(hash.slice(qIdx + 1));\n            Object.entries(params).forEach(([k, v]) => sp.set(k, v));\n            url.hash = `${base}?${sp.toString()}`;\n        }\n        window.history.replaceState(null, \"\", url.toString());\n    }\n    catch {\n        // ignore\n    }\n}\nfunction clearQueryParams(keys) {\n    try {\n        const url = new URL(window.location.href);\n        keys.forEach((k) => url.searchParams.delete(k));\n        const hash = String(url.hash ?? \"\");\n        const qIdx = hash.indexOf(\"?\");\n        if (qIdx >= 0) {\n            const base = hash.slice(0, qIdx);\n            const sp = new URLSearchParams(hash.slice(qIdx + 1));\n            keys.forEach((k) => sp.delete(k));\n            const qs = sp.toString();\n            url.hash = qs ? `${base}?${qs}` : base;\n        }\n        window.history.replaceState(null, \"\", url.toString());\n    }\n    catch {\n        // ignore\n    }\n}\nexport function initDomesticTripSettlementPanel(API_BASE) {\n    console.log(\"[정산] initDomesticTripSettlementPanel 호출\");\n    const section = document.getElementById(\"bt_settlement_section\");\n    if (!section) {\n        console.warn(\"[정산] #bt_settlement_section 요소를 찾을 수 없습니다. HTML 구조를 확인하세요.\");\n        return;\n    }\n    const saveBtn = getEl(\"bt_save\");\n    if (saveBtn._bound)\n        return;\n    saveBtn._bound = true;\n    const resetBtn = getEl(\"bt_reset\");\n    const resultBox = getEl(\"bt_result\");\n    const workEndInput = getEl(\"bt_work_end_time\");\n    const returnTimeInput = getEl(\"bt_return_time\");\n    // ✅ 복귀지 select (value: company/home/other)\n    const returnPlaceSelect = getEl(\"bt_return_place\");\n    const returnPlaceOther = document.getElementById(\"bt_return_place_other\");\n    const mealBreakfastCheck = getEl(\"bt_meal_breakfast\");\n    const mealLunchCheck = getEl(\"bt_meal_lunch\");\n    const mealDinnerCheck = getEl(\"bt_meal_dinner\");\n    const mealBreakfastOwner = getEl(\"bt_meal_breakfast_owner\");\n    const mealLunchOwner = getEl(\"bt_meal_lunch_owner\");\n    const mealDinnerOwner = getEl(\"bt_meal_dinner_owner\");\n    // (있으면) 현재 로그인 사용자명 검사에 사용\n    const userNameEl = document.getElementById(\"userName\");\n    function currentUserName() {\n        return (userNameEl?.textContent ?? \"\").trim();\n    }\n    // ✅ 복귀지 기타 토글\n    returnPlaceSelect.addEventListener(\"change\", () => {\n        if (!returnPlaceOther)\n            return;\n        const isOther = returnPlaceSelect.value === \"other\";\n        returnPlaceOther.classList.toggle(\"hidden\", !isOther);\n        if (!isOther)\n            returnPlaceOther.value = \"\";\n    });\n    // ✅ 체크 안 한 식사는 owner=\"none\"\n    const normalizeMeal = (checked, owner) => {\n        if (!checked)\n            return { checked: false, owner: \"none\" };\n        return { checked: true, owner: owner || \"personal\" };\n    };\n    // ✅ 정산 대상(요청자/날짜) 읽기: URL 파라미터에서만\n    function readSettleTarget() {\n        const req_name = textOrEmpty(getQueryParam(\"req_name\"));\n        const trip_date = textOrEmpty(getQueryParam(\"trip_date\"));\n        return { req_name, trip_date };\n    }\n    // ✅ 다른 계정 로그인 상태에서 URL 파라미터가 남아있으면 즉시 제거(정보 잔존 방지)\n    function validateTargetOrClear() {\n        const { req_name, trip_date } = readSettleTarget();\n        const me = currentUserName();\n        if (!req_name || !trip_date)\n            return { ok: false, req_name, trip_date };\n        if (me && req_name !== me) {\n            clearQueryParams([\"req_name\", \"trip_date\"]);\n            return { ok: false, req_name: \"\", trip_date: \"\" };\n        }\n        return { ok: true, req_name, trip_date };\n    }\n    /**\n     * ✅✅✅ (추가) URL 파라미터가 없을 때 \"진행중 정산\" 1건을 서버에서 다시 찾아 자동 세팅\n     * - 08에서 이미 해주지만, 09에서 한번 더 안전장치로 보강\n     * - 조건: settlement_in_progress=true 인 건만 복원됨\n     */\n    async function restoreTargetIfMissing() {\n        const me = currentUserName();\n        if (!me)\n            return;\n        const now = readSettleTarget();\n        if (now.req_name && now.trip_date)\n            return; // 이미 있으면 끝\n        try {\n            const r = await fetch(`${API_BASE}/api/business-trip/settlement/in-progress?req_name=${encodeURIComponent(me)}`);\n            if (!r.ok)\n                return;\n            const j = await r.json().catch(() => null);\n            const data = j?.data;\n            if (!data?.trip_date)\n                return;\n            if (String(data.req_name ?? \"\") !== me)\n                return;\n            setQueryParams({ req_name: me, trip_date: data.trip_date });\n            resultBox.textContent = \"✅ 진행중 정산 건을 자동으로 불러왔습니다. 이어서 작성하세요.\";\n        }\n        catch {\n            // ignore\n        }\n    }\n    // ✅ 초기 1회: 혹시 URL이 비어있으면 진행중 복원 시도\n    restoreTargetIfMissing().then(() => {\n        // 복원 이후에도 계정 불일치면 바로 제거\n        validateTargetOrClear();\n    });\n    resetBtn.addEventListener(\"click\", () => {\n        workEndInput.value = \"\";\n        returnTimeInput.value = \"\";\n        returnPlaceSelect.value = \"\";\n        if (returnPlaceOther) {\n            returnPlaceOther.value = \"\";\n            returnPlaceOther.classList.add(\"hidden\");\n        }\n        document.querySelectorAll(`input[name=\"bt_vehicle\"]`).forEach((r) => (r.checked = false));\n        mealBreakfastCheck.checked = false;\n        mealLunchCheck.checked = false;\n        mealDinnerCheck.checked = false;\n        mealBreakfastOwner.value = \"\";\n        mealLunchOwner.value = \"\";\n        mealDinnerOwner.value = \"\";\n        resultBox.textContent = \"정산 입력값이 초기화되었습니다.\";\n    });\n    saveBtn.addEventListener(\"click\", async () => {\n        const vehicleValueRaw = getCheckedRadioValue(\"bt_vehicle\");\n        const vehicleValue = toVehicleCode(vehicleValueRaw);\n        // ✅ 혹시 저장 순간에도 URL이 비어있으면 한번 더 복원 시도 후 검증\n        await restoreTargetIfMissing();\n        const t = validateTargetOrClear();\n        const trip_date = t.trip_date;\n        const req_name = t.req_name;\n        if (!trip_date || !req_name) {\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"정산 대상 없음\",\n                message: \"먼저 [출장등록] 저장 후 [이어서 정산]으로 들어와 주세요.\",\n                showOk: true,\n                showCancel: false,\n            });\n            return;\n        }\n        if (!workEndInput.value) {\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"입력 확인\",\n                message: \"업무 종료시간을 입력해주세요.\",\n                showOk: true,\n                showCancel: false,\n            });\n            return;\n        }\n        if (!returnTimeInput.value) {\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"입력 확인\",\n                message: \"복귀시간을 입력해주세요.\",\n                showOk: true,\n                showCancel: false,\n            });\n            return;\n        }\n        // ✅ 회사/자택은 company/home 그대로 보내고, 기타만 텍스트로 보냄\n        const return_place = returnPlaceSelect.value === \"other\"\n            ? (returnPlaceOther?.value ?? \"\").trim()\n            : returnPlaceSelect.value; // company | home\n        if (!return_place) {\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"입력 확인\",\n                message: \"복귀지(회사/자택/기타)를 선택해주세요.\",\n                showOk: true,\n                showCancel: false,\n            });\n            return;\n        }\n        if (returnPlaceSelect.value === \"other\" && !returnPlaceOther?.value.trim()) {\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"입력 확인\",\n                message: \"기타 복귀지를 입력해주세요.\",\n                showOk: true,\n                showCancel: false,\n            });\n            return;\n        }\n        if (!vehicleValueRaw) {\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"입력 확인\",\n                message: \"차량(정산용)을 선택해주세요.\",\n                showOk: true,\n                showCancel: false,\n            });\n            return;\n        }\n        const b = normalizeMeal(mealBreakfastCheck.checked, mealBreakfastOwner.value);\n        const l = normalizeMeal(mealLunchCheck.checked, mealLunchOwner.value);\n        const d = normalizeMeal(mealDinnerCheck.checked, mealDinnerOwner.value);\n        const settlement = {\n            work_end_time: workEndInput.value,\n            return_time: returnTimeInput.value,\n            return_place,\n            vehicle: vehicleValue,\n            meals: { breakfast: b, lunch: l, dinner: d },\n        };\n        const detail_json = { settlement };\n        try {\n            saveBtn.disabled = true;\n            resultBox.textContent = \"정산 내용 저장 중...\";\n            // ✅ 정산 저장(서버 계산/검증은 여기서 1회 더 수행됨)\n            const res = await fetch(`${API_BASE}/api/business-trip/settlement`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ req_name, trip_date, detail_json }),\n            });\n            if (!res.ok) {\n                const text = await res.text();\n                resultBox.textContent = `❌ 정산 저장 실패: HTTP ${res.status} ${text}`;\n                await ModalUtil.show({\n                    type: \"alert\",\n                    title: \"정산 저장 실패\",\n                    message: resultBox.textContent,\n                    showOk: true,\n                    showCancel: false,\n                });\n                return;\n            }\n            const data = await res.json().catch(() => null);\n            console.log(\"[정산] 응답 data =\", data);\n            // (선택) 개인차량인데 km=0이면 안내\n            const fuelKm = data?.data?.calc?.fuel_distance_km ?? 0;\n            if (vehicleValue === \"personal\" && Number(fuelKm) === 0) {\n                await ModalUtil.show({\n                    type: \"alert\",\n                    title: \"유류비 0원 안내\",\n                    message: \"개인차량으로 선택했지만 거리(km)가 0으로 계산되었습니다.\\n거리 마스터(trip_distance_master)에\\n[직원명 + 거래처명] 거리 등록이 있는지 확인해주세요.\",\n                    showOk: true,\n                    showCancel: false,\n                });\n            }\n            resultBox.textContent = \"✅ 정산 정보가 저장되었습니다.\";\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"정산 완료\",\n                message: \"정산 정보가 성공적으로 저장되었습니다.\",\n                showOk: true,\n                showCancel: false,\n            });\n            // ✅✅✅ 정산 완료 후: URL 파라미터 제거 + 등록 화면에 '정산완료' 신호\n            clearQueryParams([\"req_name\", \"trip_date\"]);\n            window.dispatchEvent(new Event(\"domestic-trip-settled\"));\n            // 대시보드 갱신\n            window.dispatchEvent(new Event(\"trip-status-refresh\"));\n        }\n        catch (err) {\n            console.error(\"[정산] 저장 중 오류:\", err);\n            resultBox.textContent = `❌ 정산 저장 중 오류: ${err?.message ?? \"알 수 없는 오류\"}`;\n            await ModalUtil.show({\n                type: \"alert\",\n                title: \"정산 저장 오류\",\n                message: resultBox.textContent,\n                showOk: true,\n                showCancel: false,\n            });\n        }\n        finally {\n            saveBtn.disabled = false;\n        }\n    });\n    // ✅ 섹션이 열려있는 상태에서 다른 계정으로 로그인하거나 URL 파라미터가 꼬이면 즉시 제거\n    validateTargetOrClear();\n}\n","// TypeScript/workspace/10_domestic-trip-history.ts\nfunction getEl(id) {\n    const el = document.getElementById(id);\n    if (!el)\n        throw new Error(`element not found: #${id}`);\n    return el;\n}\nconst DOW_KR = [\"일\", \"월\", \"화\", \"수\", \"목\", \"금\", \"토\"];\n// ✅ ISO/Date/DB-date 어떤 값이 와도 \"YYYY-MM-DD\" 로 안전하게\nfunction ymdSafe(v) {\n    const s = String(v ?? \"\").trim();\n    if (!s)\n        return \"-\";\n    // \"2026-01-16T00:00:00.000Z\" 같은 경우 → 앞 10자리만\n    if (s.length >= 10 && /^\\d{4}-\\d{2}-\\d{2}/.test(s))\n        return s.slice(0, 10);\n    const d = new Date(s);\n    if (Number.isNaN(d.getTime()))\n        return s;\n    const yy = d.getFullYear();\n    const mm = String(d.getMonth() + 1).padStart(2, \"0\");\n    const dd = String(d.getDate()).padStart(2, \"0\");\n    return `${yy}-${mm}-${dd}`;\n}\nfunction formatYmdWithDow(v) {\n    const ymd = ymdSafe(v);\n    if (ymd === \"-\")\n        return \"-\";\n    const d = new Date(ymd); // \"YYYY-MM-DD\"는 로컬 기준으로 잘 계산됨\n    if (Number.isNaN(d.getTime()))\n        return ymd;\n    return `${ymd} (${DOW_KR[d.getDay()]})`;\n}\nfunction toYMD(d) {\n    return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, \"0\")}-${String(d.getDate()).padStart(2, \"0\")}`;\n}\nfunction startOfWeekMon(d) {\n    const x = new Date(d);\n    const day = x.getDay();\n    const diff = day === 0 ? -6 : 1 - day; // 월요일=1\n    x.setDate(x.getDate() + diff);\n    x.setHours(0, 0, 0, 0);\n    return x;\n}\nfunction endOfWeekSun(d) {\n    const mon = startOfWeekMon(d);\n    const sun = new Date(mon);\n    sun.setDate(mon.getDate() + 6);\n    sun.setHours(0, 0, 0, 0);\n    return sun;\n}\nfunction isMonToSunRange(from, to) {\n    const s = new Date(from);\n    const e = new Date(to);\n    if (Number.isNaN(s.getTime()) || Number.isNaN(e.getTime()))\n        return false;\n    const diff = Math.round((e.getTime() - s.getTime()) / (1000 * 60 * 60 * 24));\n    return s.getDay() === 1 && e.getDay() === 0 && diff === 6;\n}\n/** ✅ 근무시간 차액 계산 */\nfunction calcHourDiff(start, end) {\n    const toMin = (t) => {\n        const [h, m] = String(t ?? \"\").split(\":\").map(Number);\n        if (!Number.isFinite(h) || !Number.isFinite(m))\n            return null;\n        return h * 60 + m;\n    };\n    const s = toMin(start);\n    const e = toMin(end);\n    if (s == null || e == null)\n        return \"-\";\n    let diff = e - s;\n    if (diff < 0)\n        diff += 24 * 60;\n    const h = Math.floor(diff / 60);\n    const m = diff % 60;\n    return m === 0 ? `${h}시간` : `${h}시간 ${m}분`;\n}\n// 🌟 패널 초기화\nexport function initDomesticTripHistoryPanel(API_BASE) {\n    const panel = document.getElementById(\"panel-국내출장-정산서등록\");\n    if (!panel)\n        return;\n    const searchBtn = getEl(\"settle_search\");\n    const submitBtn = getEl(\"settle_submit\");\n    // 중복 바인딩 방지\n    if (searchBtn._bound)\n        return;\n    searchBtn._bound = true;\n    const fromInput = getEl(\"settle_from\");\n    const toInput = getEl(\"settle_to\");\n    const resultMsg = getEl(\"settle_result_msg\");\n    const tbody = getEl(\"settle_result_tbody\");\n    let lastRows = [];\n    function getLoginUserName() {\n        try {\n            return JSON.parse(localStorage.getItem(\"user\") || \"{}\")?.name ?? null;\n        }\n        catch {\n            return null;\n        }\n    }\n    // ✅ (1) 기본값: 오늘 기준 이번주 월~일 자동 세팅\n    function setThisWeekRange() {\n        const mon = startOfWeekMon(new Date());\n        const sun = endOfWeekSun(new Date());\n        fromInput.value = toYMD(mon);\n        toInput.value = toYMD(sun);\n    }\n    function setLastWeekRange() {\n        const mon = startOfWeekMon(new Date());\n        mon.setDate(mon.getDate() - 7);\n        const sun = new Date(mon);\n        sun.setDate(mon.getDate() + 6);\n        fromInput.value = toYMD(mon);\n        toInput.value = toYMD(sun);\n    }\n    // 입력값이 비었으면 자동으로 이번주 세팅\n    if (!fromInput.value || !toInput.value)\n        setThisWeekRange();\n    // =========================\n    // ✅ 제출 이벤트: 관리자(02) 자동 갱신용\n    // =========================\n    function notifyTripSubmitted(payload) {\n        window.dispatchEvent(new CustomEvent(\"trip:submitted\", { detail: payload ?? {} }));\n        try {\n            const bc = new BroadcastChannel(\"trip-events\");\n            bc.postMessage({ type: \"trip:submitted\", payload: payload ?? {}, ts: Date.now() });\n            bc.close();\n        }\n        catch { }\n        try {\n            localStorage.setItem(\"trip:submitted\", JSON.stringify({ payload: payload ?? {}, ts: Date.now() }));\n        }\n        catch { }\n    }\n    // =========================\n    // ✅ 제출 가능/불가 안내 + 버튼 활성화\n    // =========================\n    function updateSubmitEnabled() {\n        const okWeek = isMonToSunRange(fromInput.value, toInput.value);\n        const hasRows = lastRows.length > 0;\n        const allSettled = lastRows.every((r) => {\n            const s = r.detail_json?.settlement ?? r.end_data ?? {};\n            return s && Object.keys(s).length > 0;\n        });\n        const anySubmitted = lastRows.some((r) => !!r.submitted_at);\n        const canSubmit = okWeek && hasRows && allSettled && !anySubmitted;\n        submitBtn.disabled = !canSubmit;\n        // ✅ 유저가 실수 안 하게 이유를 resultMsg에 같이 보여줌\n        const reasons = [];\n        if (!okWeek)\n            reasons.push(\"제출은 월~일(1주일) 기간만 가능\");\n        if (!hasRows)\n            reasons.push(\"조회된 내역 없음\");\n        if (hasRows && !allSettled)\n            reasons.push(\"정산 저장이 안 된 날짜가 있음\");\n        if (anySubmitted)\n            reasons.push(\"이미 제출된 내역이 포함됨\");\n        if (canSubmit) {\n            resultMsg.textContent = `총 ${lastRows.length}건 조회 / ✅ 제출 가능합니다.`;\n        }\n        else {\n            // 기존에 “총 n건 조회”가 보이던 UX는 유지하면서, 제출 이유도 같이\n            const base = `총 ${lastRows.length}건 조회`;\n            const why = reasons.length ? ` / ⛔ ${reasons.join(\" · \")}` : \"\";\n            resultMsg.textContent = base + why;\n        }\n    }\n    function statusText(r) {\n        if (!r.submitted_at)\n            return \"미제출\";\n        if (r.approve_status === \"approved\")\n            return \"승인(O)\";\n        if (r.approve_status === \"rejected\")\n            return \"반려(X)\";\n        return \"제출\";\n    }\n    function renderRows(rows) {\n        lastRows = rows;\n        updateSubmitEnabled();\n        if (!rows.length) {\n            tbody.innerHTML = `\n        <tr>\n          <td colspan=\"8\" class=\"border px-2 py-3 text-center text-gray-400\">\n            조회된 정산 내역이 없습니다.\n          </td>\n        </tr>\n      `;\n            return;\n        }\n        tbody.innerHTML = \"\";\n        rows.forEach((row) => {\n            const r = row.detail_json?.register ?? row.start_data ?? {};\n            const s = row.detail_json?.settlement ?? row.end_data ?? {};\n            // ✅ 근무시간 3줄 표시 (항상 이 형식으로 고정)\n            const departStart = r.depart_time || \"-\";\n            const arriveTime = r.arrive_time || \"-\";\n            const returnStart = s.work_end_time || \"-\";\n            const returnArrive = s.return_time || \"-\";\n            const workStart = r.work_start_time || arriveTime || \"-\";\n            const workEnd = s.work_end_time || \"-\";\n            const departLine = (departStart !== \"-\" && arriveTime !== \"-\")\n                ? `출발 (출발시간 ${departStart} ~ 도착시간 ${arriveTime})`\n                : \"출발 (-)\";\n            const returnLine = (returnStart !== \"-\" && returnArrive !== \"-\")\n                ? `복귀 (출발시간 ${returnStart} ~ 도착시간 ${returnArrive})`\n                : \"복귀 (-)\";\n            const workDiff = (workStart !== \"-\" && workEnd !== \"-\")\n                ? calcHourDiff(workStart, workEnd)\n                : \"-\";\n            const workLine = (workDiff !== \"-\")\n                ? `업무시간 ${workStart} ~ ${workEnd} (총 ${workDiff})`\n                : \"업무시간 -\";\n            // 차량 표기\n            const vehicleRaw = String(s.vehicle ?? \"\").trim();\n            const vehicleText = vehicleRaw === \"personal\" ? \"개인차\" :\n                vehicleRaw === \"corp\" ? \"법인차\" :\n                    vehicleRaw === \"public\" ? \"대중교통\" :\n                        vehicleRaw === \"other\" ? \"기타\" :\n                            (vehicleRaw || \"-\");\n            // 식사 표기\n            const meals = s.meals || {};\n            const mealStrs = [];\n            if (meals.breakfast?.checked)\n                mealStrs.push(`조식(${meals.breakfast.owner === \"corp\" ? \"법인\" : \"개인\"})`);\n            if (meals.lunch?.checked)\n                mealStrs.push(`중식(${meals.lunch.owner === \"corp\" ? \"법인\" : \"개인\"})`);\n            if (meals.dinner?.checked)\n                mealStrs.push(`석식(${meals.dinner.owner === \"corp\" ? \"법인\" : \"개인\"})`);\n            const mealsText = mealStrs.length ? mealStrs.join(\", \") : \"-\";\n            // 이동경로 표기\n            const departPlace = r.depart_place || \"\";\n            const dest = r.destination || \"\";\n            const returnPlace = s.return_place || \"\";\n            const routeText = [departPlace, dest, returnPlace].filter(Boolean).join(\" → \") || \"-\";\n            const mainTask = r.purpose || \"-\";\n            const st = statusText(row);\n            const rejectReason = row.approve_status === \"rejected\" ? (row.approve_comment ?? \"\") : \"\";\n            const tr = document.createElement(\"tr\");\n            tr.innerHTML = `\n        <td class=\"border px-2 py-1 text-center whitespace-nowrap\">\n          ${formatYmdWithDow(row.trip_date)}\n        </td>\n\n        <td class=\"border px-2 py-2 text-left whitespace-normal leading-snug\">\n          <div class=\"text-gray-700\">${departLine}</div>\n          <div class=\"text-gray-700\">${returnLine}</div>\n          <div class=\"font-bold text-indigo-600 mt-1\">${workLine}</div>\n        </td>\n\n        <td class=\"border px-2 py-1 text-center whitespace-nowrap\">\n          ${vehicleText}\n        </td>\n\n        <td class=\"border px-2 py-1 text-center whitespace-nowrap\">\n          ${mealsText}\n        </td>\n\n        <td class=\"border px-2 py-1 truncate\">\n          ${routeText}\n        </td>\n\n        <td class=\"border px-2 py-1 whitespace-normal\">\n          ${mainTask}\n        </td>\n\n        <td class=\"border px-2 py-1 text-center font-semibold whitespace-nowrap\">\n          ${st}\n        </td>\n\n        <td class=\"border px-2 py-1 text-rose-600 whitespace-normal\">\n          ${rejectReason}\n        </td>\n      `;\n            tbody.appendChild(tr);\n        });\n    }\n    async function fetchHistory() {\n        const name = getLoginUserName();\n        if (!name)\n            return;\n        // 조회중 표시\n        resultMsg.textContent = \"조회 중...\";\n        tbody.innerHTML = `\n      <tr>\n        <td colspan=\"8\" class=\"border px-2 py-3 text-center text-gray-400\">\n          조회 중...\n        </td>\n      </tr>\n    `;\n        const qs = new URLSearchParams({\n            from: fromInput.value,\n            to: toInput.value,\n            req_name: name,\n        });\n        const res = await fetch(`${API_BASE}/api/business-trip/settlements-range?${qs}`);\n        const json = await res.json();\n        const rows = (json.data ?? []);\n        renderRows(rows);\n    }\n    // ✅ 조회\n    searchBtn.onclick = fetchHistory;\n    // ✅ (3) 입력 바뀌면 제출 가능 여부 즉시 반영 (유저 실수 방지)\n    fromInput.addEventListener(\"change\", updateSubmitEnabled);\n    toInput.addEventListener(\"change\", updateSubmitEnabled);\n    // ✅ (3-추가) \"이번주/지난주\" 버튼이 HTML에 있으면 자동 연결(있어도 되고 없어도 됨)\n    // - 버튼 id를 아래처럼 쓰면 자동으로 먹음:\n    //   thisweek: settle_btn_thisweek\n    //   lastweek: settle_btn_lastweek\n    const btnThisWeek = document.getElementById(\"settle_btn_thisweek\");\n    const btnLastWeek = document.getElementById(\"settle_btn_lastweek\");\n    if (btnThisWeek) {\n        btnThisWeek.addEventListener(\"click\", async () => {\n            setThisWeekRange();\n            await fetchHistory();\n        });\n    }\n    if (btnLastWeek) {\n        btnLastWeek.addEventListener(\"click\", async () => {\n            setLastWeekRange();\n            await fetchHistory();\n        });\n    }\n    // =========================\n    // ✅ 제출하기\n    // =========================\n    submitBtn.onclick = async () => {\n        try {\n            if (submitBtn.disabled) {\n                // disabled인데 누르려는 경우: 왜 안되는지 한번 더 알림(실수 방지)\n                const okWeek = isMonToSunRange(fromInput.value, toInput.value);\n                if (!okWeek) {\n                    alert(\"제출은 월~일(1주일) 기간만 가능합니다.\\n'이번주(월~일)' 버튼을 눌러주세요.\");\n                }\n                return;\n            }\n            const name = getLoginUserName();\n            if (!name) {\n                alert(\"로그인 정보를 찾을 수 없습니다.\");\n                return;\n            }\n            if (!confirm(\"이 기간(주간)의 정산서를 제출하시겠습니까?\"))\n                return;\n            const res = await fetch(`${API_BASE}/api/business-trip/settlements-submit-week`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                credentials: \"include\",\n                body: JSON.stringify({\n                    from: fromInput.value,\n                    to: toInput.value,\n                    req_name: name,\n                }),\n            });\n            const json = await res.json();\n            if (!json.ok) {\n                alert(json.message ?? \"제출 실패\");\n                return;\n            }\n            alert(\"제출 완료\");\n            // ✅ 관리자(02) 자동갱신 트리거\n            notifyTripSubmitted({ from: fromInput.value, to: toInput.value, req_name: name });\n            // ✅ 직원 화면도 최신화\n            await fetchHistory();\n        }\n        catch (e) {\n            console.error(e);\n            alert(\"서버 오류로 제출에 실패했습니다.\");\n        }\n    };\n    // 초기엔 “이번주 기준”으로 보이게 + 제출버튼 조건 반영\n    updateSubmitEnabled();\n}\n","// TypeScript/workspace/utils/DistanceCalc.ts\n// ✅ 교체본: 유류비 = (총km / 연비(km/L)) * 유종단가(원/L)\n// - 디버그 로그 포함(원인 추적용)\n// - 기존 거리 계산(calcFuelKmByCase)은 유지\n// - 기존 calcFuelAmount(totalKm, pricePerKm) 호출도 안깨지게 호환 유지(구식 방식은 그대로 동작)\n// ✅ (구식) km당 단가 방식 호환용 (예전 코드 깨지지 않게 유지)\nexport const DEFAULT_FUEL_PRICE_PER_KM = 200;\nfunction norm(v) {\n    return String(v ?? \"\").trim().toLowerCase();\n}\nfunction toNum(v) {\n    const n = Number(v);\n    return Number.isFinite(n) ? n : 0;\n}\n/** ✅ \"회사/자택/company/home\" 혼용값을 계산용 표준값으로 정리 */\nexport function normalizePlace(v) {\n    const s = norm(v);\n    if (!s)\n        return null;\n    if (s === \"company\" || s === \"회사\")\n        return \"company\";\n    if (s === \"home\" || s === \"자택\")\n        return \"home\";\n    return null;\n}\n/** ✅ 화면 표시용 */\nexport function placeLabel(v) {\n    const p = normalizePlace(v);\n    if (p === \"company\")\n        return \"회사\";\n    if (p === \"home\")\n        return \"자택\";\n    return String(v ?? \"\").trim();\n}\n/** ✅ 거래처명으로 row 찾기 (대소문자/공백 무시) */\nfunction findRow(list, clientName) {\n    const key = norm(clientName);\n    return list.find((x) => norm(x.client_name) === key);\n}\n/** ✅ 사용자(자택) 거리 읽기: home_distance_km 우선 */\nexport function findKmHome(list, clientName) {\n    const row = findRow(list, clientName);\n    return toNum(row?.home_distance_km ?? row?.distance_km ?? row?.km);\n}\n/** ✅ 회사 거리 읽기: distance_km 우선 */\nexport function findKmCompany(list, clientName) {\n    const row = findRow(list, clientName);\n    return toNum(row?.distance_km ?? row?.home_distance_km ?? row?.km);\n}\n/**\n * ✅ 개인차량일 때만 유류비 거리(km) 계산\n * - 출발/복귀가 회사/자택이면 케이스별 합산\n * - 기타 텍스트 출발지/복귀지는 계산 불가 -> 0\n */\nexport function calcFuelKmByCase(opts) {\n    const { depart_place, return_place, destination, vehicle, companyDistances, userDistances } = opts;\n    if (vehicle !== \"personal\")\n        return 0;\n    const depart = normalizePlace(depart_place);\n    const ret = normalizePlace(return_place);\n    if (!depart || !ret)\n        return 0;\n    const companyKm = findKmCompany(companyDistances, destination);\n    const homeKm = findKmHome(userDistances, destination);\n    if (depart === \"home\" && ret === \"home\")\n        return homeKm * 2;\n    if (depart === \"company\" && ret === \"company\")\n        return companyKm * 2;\n    if (depart === \"company\" && ret === \"home\")\n        return companyKm + homeKm;\n    if (depart === \"home\" && ret === \"company\")\n        return homeKm + companyKm;\n    return 0;\n}\n/** ✅ 숫자 방어 (0/NaN 방지) */\nfunction safePositive(v, fallback) {\n    const n = Number(v);\n    if (!Number.isFinite(n) || n <= 0)\n        return fallback;\n    return n;\n}\n/**\n * ✅ 너 공식대로 계산\n * @param totalKm 총 주행거리(km)\n * @param kmPerLiter 연비(km/L) - 예: 7\n * @param pricePerLiter 유종단가(원/L) - 예: 1000\n */\nexport function calcFuelAmountByLiter(totalKm, kmPerLiter, pricePerLiter) {\n    const km = safePositive(totalKm, 0);\n    const eff = safePositive(kmPerLiter, 7); // 기본 7\n    const ppl = safePositive(pricePerLiter, 0);\n    if (km <= 0 || ppl <= 0)\n        return 0;\n    const liters = km / eff;\n    const amount = Math.round(liters * ppl);\n    console.log(\"[FUEL DEBUG][LITER]\", {\n        totalKm: km,\n        kmPerLiter: eff,\n        pricePerLiter: ppl,\n        liters,\n        amount,\n    });\n    return amount;\n}\n/**\n * ✅ 설정(유종별 단가)에서 유저 유종(fuel_type)으로 가격 선택\n * - cfgFuel: { gasoline, diesel, lpg } 형태면 그대로 넣으면 됨\n */\nexport function pickFuelPricePerLiterByType(fuelTypeRaw, cfgFuel) {\n    const t = String(fuelTypeRaw ?? \"\").trim().toLowerCase();\n    // 한글/영문 혼용 방어\n    const isGasoline = t === \"휘발유\" || t === \"gasoline\" || t === \"gas\" || t === \"petrol\";\n    const isDiesel = t === \"경유\" || t === \"diesel\";\n    const isLpg = t === \"lpg\" || t === \"가스\" || t === \"엘피지\" || t === \"lpg(가스)\";\n    const g = cfgFuel.gasoline ?? null;\n    const d = cfgFuel.diesel ?? null;\n    const l = cfgFuel.lpg ?? null;\n    let picked = null;\n    if (isGasoline)\n        picked = g;\n    else if (isDiesel)\n        picked = d;\n    else if (isLpg)\n        picked = l;\n    else\n        picked = g ?? d ?? l ?? null; // 모르겠으면 있는 값 중 하나\n    const price = Number(picked);\n    const out = Number.isFinite(price) && price > 0 ? price : 0;\n    console.log(\"[FUEL DEBUG][PICK]\", { fuelTypeRaw, picked: out, cfgFuel });\n    return out;\n}\n/**\n * ✅ NEW: (거리계산 + 너 공식)까지 한번에\n * - totalKm은 calcFuelKmByCase로 먼저 구하고,\n * - fuel_type + 설정단가 + 연비로 유류비를 계산한다.\n */\nexport function calcFuelAmountByCaseWithLiter(opts) {\n    const totalKm = calcFuelKmByCase({\n        depart_place: opts.depart_place,\n        return_place: opts.return_place,\n        destination: opts.destination,\n        vehicle: opts.vehicle,\n        companyDistances: opts.companyDistances,\n        userDistances: opts.userDistances,\n    });\n    const pricePerLiter = pickFuelPricePerLiterByType(opts.fuel_type, {\n        gasoline: opts.fuel_price_gasoline,\n        diesel: opts.fuel_price_diesel,\n        lpg: opts.fuel_price_lpg,\n    });\n    const amount = calcFuelAmountByLiter(totalKm, opts.km_per_liter, pricePerLiter);\n    console.log(\"[FUEL DEBUG][CASE+LITER]\", {\n        destination: opts.destination,\n        depart_place: opts.depart_place,\n        return_place: opts.return_place,\n        vehicle: opts.vehicle,\n        fuel_type: opts.fuel_type,\n        totalKm,\n        km_per_liter: opts.km_per_liter,\n        pricePerLiter,\n        amount,\n    });\n    return { totalKm, amount, pricePerLiter };\n}\n// =====================================================\n// ✅ 호환 유지: 예전 코드가 calcFuelAmount(km, pricePerKm) 쓰면 그대로 동작\n// =====================================================\nexport function calcFuelAmount(totalKm, pricePerKm = DEFAULT_FUEL_PRICE_PER_KM) {\n    console.log(\"[FUEL DEBUG][PER_KM]\", { totalKm, pricePerKm });\n    return Math.round(safePositive(totalKm, 0) * safePositive(pricePerKm, DEFAULT_FUEL_PRICE_PER_KM));\n}\n","export const ModalUtil = {\n    el: null,\n    ensureElement() {\n        if (this.el)\n            return this.el;\n        const div = document.createElement(\"div\");\n        div.id = \"globalSimpleModal\";\n        div.className =\n            \"hidden fixed inset-0 z-[9999] flex items-center justify-center bg-black/50\";\n        div.innerHTML = `\n      <div id=\"modalBox\" class=\"bg-white w-[360px] rounded-2xl p-6 shadow-xl text-center\">\n        <div id=\"modalIcon\" class=\"text-5xl mb-4 select-none\"></div>\n        <h2 id=\"modalTitle\" class=\"text-xl font-bold mb-2\"></h2>\n        <p id=\"modalMessage\" class=\"text-sm text-gray-700 mb-6\"></p>\n        <div id=\"modalBtns\" class=\"flex justify-center gap-2\">\n          <button id=\"modalCancelBtn\"\n            class=\"px-4 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 hidden\">취소</button>\n          <button id=\"modalOkBtn\"\n            class=\"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 hidden\">확인</button>\n        </div>\n      </div>\n    `;\n        document.body.appendChild(div);\n        this.el = div;\n        return div;\n    },\n    setStyle(type) {\n        const el = this.ensureElement();\n        const iconEl = el.querySelector(\"#modalIcon\");\n        const titleEl = el.querySelector(\"#modalTitle\");\n        if (type === \"alert\") {\n            iconEl.textContent = \"ℹ️\";\n            iconEl.className = \"text-5xl text-blue-600 mb-4\";\n            titleEl.className = \"text-xl font-bold mb-2 text-blue-700\";\n        }\n        else {\n            iconEl.textContent = \"⚠️\";\n            iconEl.className = \"text-5xl text-yellow-500 mb-4\";\n            titleEl.className = \"text-xl font-bold mb-2 text-yellow-700\";\n        }\n    },\n    /**\n     * ✨ 단일 모달 호출\n     * - alert → 아무 값 없음\n     * - warn → boolean 반환\n     */\n    async show({ type = \"alert\", title = \"알림\", message = \"\", showOk = true, showCancel = false, }) {\n        const el = this.ensureElement();\n        const titleEl = el.querySelector(\"#modalTitle\");\n        const msgEl = el.querySelector(\"#modalMessage\");\n        const okBtn = el.querySelector(\"#modalOkBtn\");\n        const cancelBtn = el.querySelector(\"#modalCancelBtn\");\n        // 스타일\n        this.setStyle(type);\n        // 내용\n        titleEl.textContent = title;\n        msgEl.textContent = message;\n        // 버튼 표시 여부\n        okBtn.classList.toggle(\"hidden\", !showOk);\n        cancelBtn.classList.toggle(\"hidden\", !showCancel);\n        // 표시\n        el.classList.remove(\"hidden\");\n        // -----------------------\n        // alert 모달은 확인만 필요\n        // -----------------------\n        if (type === \"alert\") {\n            return new Promise((resolve) => {\n                const close = () => {\n                    this.hide();\n                    okBtn.removeEventListener(\"click\", close);\n                    resolve();\n                };\n                okBtn.addEventListener(\"click\", close);\n            });\n        }\n        // -----------------------\n        // warn 모달은 확인/취소 필요\n        // -----------------------\n        return new Promise((resolve) => {\n            const onOk = () => {\n                cleanup();\n                this.hide();\n                resolve(true);\n            };\n            const onCancel = () => {\n                cleanup();\n                this.hide();\n                resolve(false);\n            };\n            const cleanup = () => {\n                okBtn.removeEventListener(\"click\", onOk);\n                cancelBtn.removeEventListener(\"click\", onCancel);\n            };\n            okBtn.addEventListener(\"click\", onOk);\n            cancelBtn.addEventListener(\"click\", onCancel);\n        });\n    },\n    hide() {\n        const el = this.ensureElement();\n        el.classList.add(\"hidden\");\n    },\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// TypeScript/workspace/00_workspace.ts\nimport { initDashboardTripStatus } from \"./01_dashboard-trip-status\";\nimport { initTripApprovalPanel } from \"./02_trip-approval\";\nimport { initUserManagePanel } from \"./04_user-manage\";\nimport { initBusinessMasterPanel } from \"./05_business-master\";\nimport { initDomesticTripRegisterPanel } from \"./08_domestic-trip-register\";\nimport { initDomesticTripSettlementPanel } from \"./09_domestic-trip-settlement\";\nimport { initDomesticTripHistoryPanel } from \"./10_domestic-trip-history\";\nconst API_BASE = location.hostname === \"gwoun01.github.io\"\n    ? \"https://outwork.sel3.cloudtype.app\"\n    : \"http://127.0.0.1:5050\";\n// ✅ 로그인할 때 login.ts에서 넣어둔 값 사용\n//   localStorage.setItem(\"loginUserId\", data.id);\nfunction getLoginUserId() {\n    const id = localStorage.getItem(\"loginUserId\");\n    return id || \"사용자\"; // 없으면 기본 텍스트\n}\n/** localStorage.user 에서 전체 로그인 유저 정보 가져오기 */\nfunction getLoginUser() {\n    const raw = localStorage.getItem(\"user\");\n    if (!raw)\n        return null;\n    try {\n        const obj = JSON.parse(raw);\n        return {\n            id: obj.id ?? \"\",\n            name: obj.name ?? \"\",\n            permissions: obj.permissions ?? null,\n        };\n    }\n    catch {\n        return null;\n    }\n}\n/** permissions 객체에서 해당 키의 권한값 가져오기 (없으면 \"NoAccess\") */\nfunction getPermValue(perms, key) {\n    if (!perms)\n        return \"NoAccess\";\n    const v = perms[key];\n    if (!v)\n        return \"NoAccess\";\n    return v;\n}\n/**\n * 패널 전환(사이드 메뉴 → 메인 패널, 제목 바꾸기)\n */\nfunction initLocalTabNavigation() {\n    const navButtons = document.querySelectorAll(\".nav-btn\");\n    const panels = document.querySelectorAll('[id^=\"panel-\"]');\n    const titleEl = document.getElementById(\"wsTitle\");\n    function showPanel(id) {\n        // 모든 패널 숨기고\n        panels.forEach((p) => p.classList.add(\"hidden\"));\n        // 대상 패널만 보이기\n        const target = document.getElementById(id);\n        if (target)\n            target.classList.remove(\"hidden\");\n        // 사이드 버튼 스타일 토글\n        navButtons.forEach((btn) => {\n            const active = btn.dataset.panel === id;\n            btn.classList.toggle(\"bg-[#7ce92f]\", active);\n            btn.classList.toggle(\"text-[#000000]\", active);\n            btn.classList.toggle(\"font-bold\", active);\n        });\n        // 상단 제목 변경\n        const curBtn = document.querySelector(`.nav-btn[data-panel=\"${id}\"]`);\n        if (curBtn && titleEl) {\n            titleEl.textContent = curBtn.textContent?.trim() ?? \"\";\n        }\n    }\n    // 기본은 대시보드\n    showPanel(\"panel-dashboard\");\n    return showPanel;\n}\n// ==============================================================\n// 🔵 메인 초기화\n// ==============================================================\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\n    console.debug(\"[INIT] workspace DOMContentLoaded\");\n    // 0) 로그인 유저 / 권한 정보 가져오기\n    const loginUser = getLoginUser();\n    const perms = loginUser?.permissions ?? null;\n    const hasPermInfo = !!perms && Object.keys(perms).length > 0;\n    // 기본값: 권한 정보가 아예 없으면(옛날 데이터) 일단 전부 허용\n    let canAdmin = true;\n    let canTripRegister = true;\n    let canTripHistory = true;\n    if (hasPermInfo) {\n        const tripApprove = getPermValue(perms, \"출장승인\");\n        const tripManage = getPermValue(perms, \"출장내역관리\");\n        const tripRegister = getPermValue(perms, \"출장등록\");\n        const tripHistory = getPermValue(perms, \"출장내역\");\n        const userManage = getPermValue(perms, \"사용자관리\");\n        // ✅ 관리자 전용: 출장승인 또는 출장내역관리 중 하나라도 NoAccess 가 아니면 관리자\n        canAdmin =\n            tripApprove !== \"NoAccess\" || tripManage !== \"NoAccess\";\n        // ✅ 국내출장 → 출장등록\n        canTripRegister = tripRegister !== \"NoAccess\";\n        // ✅ 국내출장 → 출장내역\n        canTripHistory = tripHistory !== \"NoAccess\";\n    }\n    // 1) 로그인한 아이디 헤더에 표시 + 아바타 텍스트\n    const userId = getLoginUserId(); // 예) \"권택선\"\n    const userNameEl = document.getElementById(\"userName\");\n    const avatarEl = document.getElementById(\"avatar\");\n    const logoutBtn = document.getElementById(\"logoutBtn\");\n    if (userNameEl) {\n        // 이름이 따로 있으면 이름, 없으면 아이디\n        const displayName = loginUser?.name || userId;\n        userNameEl.textContent = displayName;\n    }\n    if (avatarEl) {\n        const base = loginUser?.name || userId;\n        avatarEl.textContent = base.slice(0, 2); // 앞 2글자 정도만 동그라미 안에\n    }\n    // 2) 로그아웃 버튼\n    logoutBtn?.addEventListener(\"click\", async () => {\n        try {\n            // 세션 쿠키 정리용 (백엔드에 /api/logout 있으면 사용, 없으면 그냥 넘어감)\n            await fetch(`${API_BASE}/api/logout`, {\n                method: \"POST\",\n                credentials: \"include\",\n            }).catch(() => { });\n        }\n        finally {\n            // 로컬 저장된 로그인 정보 삭제\n            localStorage.removeItem(\"loginUserId\");\n            localStorage.removeItem(\"loginUserName\");\n            localStorage.removeItem(\"user\");\n            sessionStorage.clear();\n            // 로그인 페이지로 이동 (파일 이름에 맞게 수정)\n            window.location.href = \"index.html\";\n        }\n    });\n    // 3) 패널 네비게이션 세팅\n    const showPanel = initLocalTabNavigation();\n    // 4) 대시보드(출장자 현황 + KPI) 초기화 → 서버와 연결\n    initDashboardTripStatus(API_BASE);\n    // 5) 사이드바에서 패널 이동\n    const sidebarButtons = document.querySelectorAll(\"#sidebar [data-panel]\");\n    // 🔒 관리자 전용 그룹 자체를 숨기기 (버튼/내용 둘 다)\n    if (!canAdmin && hasPermInfo) {\n        const adminBtn = document.getElementById(\"btnAdminGroup\");\n        const adminContent = document.getElementById(\"adminGroupContent\");\n        adminBtn?.classList.add(\"hidden\");\n        adminContent?.classList.add(\"hidden\");\n    }\n    sidebarButtons.forEach((btn) => {\n        btn.addEventListener(\"click\", async () => {\n            const id = btn.dataset.panel;\n            if (!id)\n                return;\n            // ==========================\n            // 🔒 권한 체크\n            // ==========================\n            if (hasPermInfo) {\n                // 1) 관리자 전용 패널들\n                if (id === \"panel-출장승인\" ||\n                    id === \"panel-출장내역-관리\" ||\n                    id === \"panel-사용자-관리\") {\n                    if (!canAdmin) {\n                        alert(\"관리자 권한이 필요합니다.\");\n                        return;\n                    }\n                }\n                // 2) 국내출장 - 출장등록\n                if (id === \"panel-국내출장-출장등록\" && !canTripRegister) {\n                    alert(\"출장등록 권한이 없습니다.\");\n                    return;\n                }\n                // 3) 국내출장 - 출장내역(정산 내역)\n                if (id === \"panel-국내출장-정산서등록\" && !canTripHistory) {\n                    alert(\"출장내역 조회 권한이 없습니다.\");\n                    return;\n                }\n            }\n            // ==========================\n            // 🔁 패널 전환 + 초기화\n            // ==========================\n            showPanel(id);\n            // 대시보드 탭 클릭 → 항상 최신 데이터로 새로고침\n            if (id === \"panel-dashboard\") {\n                window.dispatchEvent(new Event(\"trip-status-refresh\"));\n            }\n            // 사용자 관리 탭 (관리자 전용)\n            if (id === \"panel-사용자-관리\") {\n                await initUserManagePanel(API_BASE);\n                console.log(\"[INIT] 사용자-관리 init 완료\");\n            }\n            // 관리자 전용 - 출장 승인\n            if (id === \"panel-출장승인\") {\n                await initTripApprovalPanel(API_BASE);\n                console.log(\"[INIT] 출장승인 패널 init 완료\");\n            }\n            // 관리자 전용 - 출장업무 관리\n            if (id === \"panel-출장업무-관리\") {\n                await initBusinessMasterPanel(API_BASE);\n                console.log(\"[INIT] 출장업무관리 패널 init 완료\");\n            }\n            // 국내출장 - 출장등록 패널 → 등록 + 정산 패널 초기화\n            if (id === \"panel-국내출장-출장등록\") {\n                await initDomesticTripRegisterPanel(API_BASE);\n                await initDomesticTripSettlementPanel(API_BASE);\n                console.log(\"[INIT] 국내출장-출장등록 & 정산 패널 init 완료\");\n            }\n            // 국내출장 - 출장내역(정산 내역 조회)\n            if (id === \"panel-국내출장-정산서등록\") {\n                await initDomesticTripHistoryPanel(API_BASE);\n                console.log(\"[INIT] 국내출장-정산 내역 조회 패널 init 완료\");\n            }\n            if (id === \"panel-dashboard\") {\n                window.dispatchEvent(new Event(\"trip-status-refresh\"));\n                window.dispatchEvent(new Event(\"vacation-status-refresh\")); // ✅ 추가\n            }\n        });\n    });\n    // 6) 처음 진입: 대시보드 패널 + 오늘 데이터 로딩\n    showPanel(\"panel-dashboard\");\n    window.dispatchEvent(new Event(\"trip-status-refresh\"));\n    console.debug(\"[INIT] workspace 초기화 완료\");\n});\n"],"names":[],"ignoreList":[],"sourceRoot":""}