{"version":3,"file":"index.bundle.js","mappings":";;;;;AAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,yBAAyB;AACzB,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,SAAS,gBAAgB,eAAe;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,SAAS;AAC9B;AACA,2BAA2B,oCAAoC;AAC/D;AACA,uCAAuC,oBAAoB;AAC3D,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC","sources":["webpack://innomax/./TypeScript/login/index.ts"],"sourcesContent":["\"use strict\";\n// ======================================================\n// ì •í˜¸ê°œë°œ ë¡œê·¸ì¸ ìŠ¤í¬ë¦½íŠ¸ + í™˜ê²½ ì„ íƒ + ì„œë²„ ìƒíƒœ í‘œì‹œ\n// ======================================================\nconst loginForm = document.getElementById(\"loginForm\");\nconst emailInput = document.getElementById(\"emailInput\");\nconst passwordInput = document.getElementById(\"passwordInput\");\nconst loadingPopup = document.getElementById(\"globalLoadingPopup\");\nconst failModal = document.getElementById(\"loginFailModal\");\nconst closeFailModalBtn = document.getElementById(\"closeFailModal\");\nconst serverStatus = document.getElementById(\"serverStatus\");\nconst deviceStatus = document.getElementById(\"deviceStatus\");\nconst deviceSelect = document.getElementById(\"deviceModeSelect\");\n// âœ… ì„œë²„ ì£¼ì†Œ\nconst isLocal = location.hostname === \"localhost\" ||\n    location.hostname === \"127.0.0.1\" ||\n    location.hostname.includes(\"app.github.dev\");\nconst API_BASE = isLocal\n    ? \"http://127.0.0.1:5050\"\n    : \"https://port-0-innomax-mghorm7bef413a34.sel3.cloudtype.app\";\n// âœ… ëª¨ë‹¬ ë‹«ê¸°\ncloseFailModalBtn.addEventListener(\"click\", () => {\n    failModal.classList.add(\"hidden\");\n});\n// âœ… ë¡œë”© ì œì–´\nfunction showLoading() { loadingPopup.classList.remove(\"hidden\"); }\nfunction hideLoading() { loadingPopup.classList.add(\"hidden\"); }\n// âœ… ì‹¤íŒ¨ ëª¨ë‹¬\nfunction showFailModal(message) {\n    const msgEl = document.getElementById(\"loginFailMessage\");\n    if (msgEl)\n        msgEl.textContent = message;\n    failModal.classList.remove(\"hidden\");\n}\n// âœ… ì„œë²„ ì—°ê²° í™•ì¸\nasync function checkServerConnection() {\n    try {\n        const res = await fetch(`${API_BASE}/api/health`, { method: \"GET\" });\n        if (res.ok) {\n            serverStatus.textContent = \"ì„œë²„ ì—°ê²° ì •ìƒ\";\n            serverStatus.className = \"online\";\n        }\n        else {\n            throw new Error(\"ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜\");\n        }\n    }\n    catch {\n        serverStatus.textContent = \"ì„œë²„ ì—°ê²° ì‹¤íŒ¨\";\n        serverStatus.className = \"offline\";\n    }\n}\n// ======================================================\n// ðŸŒ í™˜ê²½ ì„ íƒ (PC / ëª¨ë°”ì¼)\n// ======================================================\nfunction applyDeviceMode(mode) {\n    if (mode === \"mobile\") {\n        deviceStatus.textContent = \"ëª¨ë°”ì¼ ëª¨ë“œ\";\n        deviceStatus.className = \"mobile\";\n        deviceSelect.value = \"mobile\";\n    }\n    else {\n        deviceStatus.textContent = \"PC ëª¨ë“œ\";\n        deviceStatus.className = \"pc\";\n        deviceSelect.value = \"pc\";\n    }\n    localStorage.setItem(\"deviceMode\", mode);\n}\n// âœ… ë“œë¡­ë‹¤ìš´ ë³€ê²½ ì´ë²¤íŠ¸\ndeviceSelect.addEventListener(\"change\", (e) => {\n    const mode = e.target.value;\n    applyDeviceMode(mode);\n});\n// âœ… íŽ˜ì´ì§€ ì§„ìž… ì‹œ ì €ìž¥ëœ í™˜ê²½ ì ìš©\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    const saved = localStorage.getItem(\"deviceMode\") || \"pc\";\n    applyDeviceMode(saved);\n    checkServerConnection();\n});\n// ======================================================\n// ðŸ” ë¡œê·¸ì¸ ì²˜ë¦¬\n// ======================================================\nloginForm?.addEventListener(\"submit\", async (e) => {\n    e.preventDefault();\n    const username = emailInput.value.trim();\n    const password = passwordInput.value.trim();\n    const mode = localStorage.getItem(\"deviceMode\") || \"pc\";\n    if (!username || !password) {\n        showFailModal(\"ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì„¸ìš”.\");\n        return;\n    }\n    try {\n        showLoading();\n        const MIN_DELAY = 800;\n        const [res] = await Promise.all([\n            fetch(`${API_BASE}/api/login`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                credentials: \"include\",\n                body: JSON.stringify({ username, password }),\n            }),\n            new Promise((r) => setTimeout(r, MIN_DELAY)),\n        ]);\n        hideLoading();\n        if (!res.ok) {\n            showFailModal(\"ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\");\n            return;\n        }\n        const data = await res.json();\n        // ë°±ì—”ë“œ ì‘ë‹µ: { id, name, permissions }\n        const id = data.id;\n        const name = data.name ?? \"ì‚¬ìš©ìž\";\n        const permissions = data.permissions ?? {};\n        // ì „ì²´ ìœ ì € ì •ë³´ ì €ìž¥ (workspaceì—ì„œ ì‚¬ìš©)\n        localStorage.setItem(\"user\", JSON.stringify({\n            id,\n            name,\n            permissions, // â¬…â¬…â¬… ê¶Œí•œ ì¶”ê°€\n            loginTime: Date.now(),\n        }));\n        // ì˜ˆì „ ì½”ë“œ í˜¸í™˜ìš© (í—¤ë”/ì•„ë°”íƒ€ í‘œì‹œ)\n        localStorage.setItem(\"loginUserId\", data.id);\n        localStorage.setItem(\"loginUserName\", data.name);\n        // âœ… ì„ íƒëœ ëª¨ë“œì— ë”°ë¼ íŽ˜ì´ì§€ ë¶„ê¸°\n        const nextUrl = mode === \"mobile\" ? \"mobileindex.html\" : \"workspace.html\";\n        console.log(\"[LOGIN SUCCESS]\", nextUrl);\n        window.location.href = nextUrl;\n    }\n    catch (err) {\n        console.error(err);\n        hideLoading();\n        showFailModal(\"ì„œë²„ ì—°ê²° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ìž ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\");\n    }\n});\n// âœ… ìºì‹œ ì´ˆê¸°í™”\nwindow.addEventListener(\"load\", () => {\n    localStorage.removeItem(\"user\");\n    sessionStorage.clear();\n});\n"],"names":[],"ignoreList":[],"sourceRoot":""}